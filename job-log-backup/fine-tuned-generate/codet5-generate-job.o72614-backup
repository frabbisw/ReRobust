######## start ##############
11/13/2022 00:18:50 - INFO - __main__ -   Namespace(adam_epsilon=1e-08, add_lang_ids=False, add_task_prefix=False, always_save_model=True, beam_size=10, cache_path='saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data', config_name='', data_dir='/home/y_shi202/related-project/CodeT5/data', data_num=-1, dev_filename=None, do_eval=False, do_eval_bleu=False, do_lower_case=False, do_test=True, do_train=False, eval_batch_size=64, eval_steps=-1, eval_task='', gradient_accumulation_steps=1, lang='java', learning_rate=5e-05, load_model_path=None, local_rank=-1, log_steps=-1, max_grad_norm=1.0, max_source_length=130, max_steps=-1, max_target_length=120, model_name_or_path='Salesforce/codet5-small', model_type='codet5', no_cuda=False, num_train_epochs=50, output_dir='saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50', patience=5, res_dir='saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/prediction', res_fn='results/refine_codet5_small.txt', save_last_checkpoints=True, save_steps=-1, seed=1234, start_epoch=0, sub_task='small', summary_dir='tensorboard', task='refine', test_filename=None, tokenizer_name='Salesforce/codet5-small', train_batch_size=64, train_filename=None, train_steps=-1, warmup_steps=1000, weight_decay=0.0)
11/13/2022 00:18:52 - WARNING - configs -   Process rank: -1, device: cuda, n_gpu: 1, distributed training: False, cpu count: 80
11/13/2022 00:18:54 - INFO - models -   Finish loading model [60M] from Salesforce/codet5-small
11/13/2022 00:18:54 - INFO - __main__ -   test by self config: 
11/13/2022 00:18:54 - INFO - __main__ -   test by self model: Salesforce/codet5-small
11/13/2022 00:19:06 - INFO - __main__ -   自己设定的cpu数量为 1
11/13/2022 00:19:06 - INFO - __main__ -     ***** Testing *****
11/13/2022 00:19:06 - INFO - __main__ -     Batch size = 64
11/13/2022 00:19:06 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 00:19:06 - INFO - __main__ -   test11111111111
11/13/2022 00:19:06 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 00:19:06 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/local_variable_renaming/before_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/local_variable_renaming/before_refactoring/small/test.buggy-fixed.fixed
11/13/2022 00:19:06 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 00:19:06 - INFO - utils -   Read 251 examples, avg src len: 39, avg trg len: 35, max src len: 93, max trg len: 74
11/13/2022 00:19:06 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/test_src_all.pt
11/13/2022 00:19:06 - INFO - utils -   加载前test666666666666666
  0%|          | 0/251 [00:00<?, ?it/s] 50%|█████     | 126/251 [00:00<00:00, 463.79it/s] 75%|███████▌  | 189/251 [00:00<00:00, 496.69it/s]100%|██████████| 251/251 [00:00<00:00, 649.44it/s]
11/13/2022 00:19:07 - INFO - utils -   加载后test77777777777777
11/13/2022 00:19:07 - INFO - __main__ -   加载成功test2222222222
11/13/2022 00:19:07 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 00:19:07 - INFO - __main__ -     Num examples = 251
11/13/2022 00:19:07 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/4 [00:00<?, ?it/s]Eval bleu for test set:  25%|██▌       | 1/4 [00:16<00:48, 16.13s/it]Eval bleu for test set:  50%|█████     | 2/4 [00:25<00:23, 11.96s/it]Eval bleu for test set:  75%|███████▌  | 3/4 [00:34<00:10, 10.58s/it]Eval bleu for test set: 100%|██████████| 4/4 [00:42<00:00,  9.73s/it]Eval bleu for test set: 100%|██████████| 4/4 [00:42<00:00, 10.65s/it]
11/13/2022 00:20:00 - INFO - __main__ -   ***** Eval results *****
11/13/2022 00:20:00 - INFO - __main__ -     bleu = 78.96
11/13/2022 00:20:00 - INFO - __main__ -     codebleu = 80.697
11/13/2022 00:20:00 - INFO - __main__ -     em = 17.9283
11/13/2022 00:20:00 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typelocal_variable_renaming + whether_refactoringbefore_refactoring :
11/13/2022 00:20:00 - INFO - __main__ -   [best-bleu] bleu-4: 78.96, em: 17.9283, codebleu: 80.6970

11/13/2022 00:20:00 - INFO - __main__ -   Finish and take 1m
11/13/2022 00:20:00 - INFO - __main__ -     ***** Testing *****
11/13/2022 00:20:00 - INFO - __main__ -     Batch size = 64
11/13/2022 00:20:00 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 00:20:00 - INFO - __main__ -   test11111111111
11/13/2022 00:20:00 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 00:20:00 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/local_variable_renaming/after_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/local_variable_renaming/after_refactoring/small/test.buggy-fixed.fixed
11/13/2022 00:20:00 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 00:20:00 - INFO - utils -   Read 251 examples, avg src len: 39, avg trg len: 35, max src len: 93, max trg len: 74
11/13/2022 00:20:00 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/test_src_all.pt
11/13/2022 00:20:00 - INFO - utils -   加载前test666666666666666
ngram match: 0.789547805464687, weighted ngram match: 0.8142336109898561, syntax_match: 0.812220566318927, dataflow_match: 0.8118770764119602
  0%|          | 0/251 [00:00<?, ?it/s] 50%|█████     | 126/251 [00:00<00:00, 762.19it/s]100%|██████████| 251/251 [00:00<00:00, 952.60it/s]
11/13/2022 00:20:01 - INFO - utils -   加载后test77777777777777
11/13/2022 00:20:01 - INFO - __main__ -   加载成功test2222222222
11/13/2022 00:20:01 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 00:20:01 - INFO - __main__ -     Num examples = 251
11/13/2022 00:20:01 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/4 [00:00<?, ?it/s]Eval bleu for test set:  25%|██▌       | 1/4 [00:08<00:26,  8.96s/it]Eval bleu for test set:  50%|█████     | 2/4 [00:17<00:17,  8.92s/it]Eval bleu for test set:  75%|███████▌  | 3/4 [00:27<00:09,  9.34s/it]Eval bleu for test set: 100%|██████████| 4/4 [00:35<00:00,  8.82s/it]Eval bleu for test set: 100%|██████████| 4/4 [00:35<00:00,  8.95s/it]
11/13/2022 00:20:48 - INFO - __main__ -   ***** Eval results *****
11/13/2022 00:20:48 - INFO - __main__ -     bleu = 78.73
11/13/2022 00:20:48 - INFO - __main__ -     codebleu = 80.3818
11/13/2022 00:20:48 - INFO - __main__ -     em = 13.1474
11/13/2022 00:20:48 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typelocal_variable_renaming + whether_refactoringafter_refactoring :
11/13/2022 00:20:48 - INFO - __main__ -   [best-bleu] bleu-4: 78.73, em: 13.1474, codebleu: 80.3818

11/13/2022 00:20:48 - INFO - __main__ -   Finish and take 1m
11/13/2022 00:20:48 - INFO - __main__ -     ***** Testing *****
11/13/2022 00:20:48 - INFO - __main__ -     Batch size = 64
11/13/2022 00:20:48 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 00:20:48 - INFO - __main__ -   test11111111111
11/13/2022 00:20:48 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 00:20:48 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/method_renaming/before_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/method_renaming/before_refactoring/small/test.buggy-fixed.fixed
11/13/2022 00:20:48 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 00:20:48 - INFO - utils -   Read 5674 examples, avg src len: 32, avg trg len: 29, max src len: 93, max trg len: 129
11/13/2022 00:20:48 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/test_src_all.pt
11/13/2022 00:20:48 - INFO - utils -   加载前test666666666666666
ngram match: 0.7873202033328472, weighted ngram match: 0.8151419745072692, syntax_match: 0.8092399403874814, dataflow_match: 0.8035714285714286
  0%|          | 0/5674 [00:00<?, ?it/s] 50%|█████     | 2838/5674 [00:01<00:01, 1698.45it/s] 75%|███████▌  | 4257/5674 [00:03<00:01, 1257.46it/s]100%|██████████| 5674/5674 [00:03<00:00, 1766.80it/s]
11/13/2022 00:20:54 - INFO - utils -   加载后test77777777777777
11/13/2022 00:20:54 - INFO - __main__ -   加载成功test2222222222
11/13/2022 00:20:54 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 00:20:54 - INFO - __main__ -     Num examples = 5674
11/13/2022 00:20:54 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/89 [00:00<?, ?it/s]Eval bleu for test set:   1%|          | 1/89 [00:09<13:12,  9.01s/it]Eval bleu for test set:   2%|▏         | 2/89 [00:18<13:05,  9.03s/it]Eval bleu for test set:   3%|▎         | 3/89 [00:26<12:38,  8.82s/it]Eval bleu for test set:   4%|▍         | 4/89 [00:35<12:38,  8.92s/it]Eval bleu for test set:   6%|▌         | 5/89 [00:44<12:15,  8.75s/it]Eval bleu for test set:   7%|▋         | 6/89 [00:53<12:10,  8.80s/it]Eval bleu for test set:   8%|▊         | 7/89 [01:01<11:59,  8.78s/it]Eval bleu for test set:   9%|▉         | 8/89 [01:10<11:45,  8.71s/it]Eval bleu for test set:  10%|█         | 9/89 [01:19<11:42,  8.78s/it]Eval bleu for test set:  11%|█         | 10/89 [01:27<11:26,  8.70s/it]Eval bleu for test set:  12%|█▏        | 11/89 [01:36<11:09,  8.59s/it]Eval bleu for test set:  13%|█▎        | 12/89 [01:44<11:05,  8.65s/it]Eval bleu for test set:  15%|█▍        | 13/89 [01:53<11:01,  8.71s/it]Eval bleu for test set:  16%|█▌        | 14/89 [02:02<10:44,  8.59s/it]Eval bleu for test set:  17%|█▋        | 15/89 [02:10<10:41,  8.67s/it]Eval bleu for test set:  18%|█▊        | 16/89 [02:19<10:34,  8.70s/it]Eval bleu for test set:  19%|█▉        | 17/89 [02:28<10:31,  8.76s/it]Eval bleu for test set:  20%|██        | 18/89 [02:37<10:34,  8.93s/it]Eval bleu for test set:  21%|██▏       | 19/89 [02:47<10:45,  9.23s/it]Eval bleu for test set:  22%|██▏       | 20/89 [02:57<10:47,  9.38s/it]Eval bleu for test set:  24%|██▎       | 21/89 [03:07<10:53,  9.60s/it]Eval bleu for test set:  25%|██▍       | 22/89 [03:17<10:55,  9.78s/it]Eval bleu for test set:  26%|██▌       | 23/89 [03:27<10:48,  9.82s/it]Eval bleu for test set:  27%|██▋       | 24/89 [03:38<10:45,  9.94s/it]Eval bleu for test set:  28%|██▊       | 25/89 [03:47<10:33,  9.90s/it]Eval bleu for test set:  29%|██▉       | 26/89 [03:57<10:22,  9.88s/it]Eval bleu for test set:  30%|███       | 27/89 [04:07<10:11,  9.87s/it]Eval bleu for test set:  31%|███▏      | 28/89 [04:16<09:52,  9.72s/it]Eval bleu for test set:  33%|███▎      | 29/89 [04:25<09:30,  9.51s/it]Eval bleu for test set:  34%|███▎      | 30/89 [04:35<09:22,  9.54s/it]Eval bleu for test set:  35%|███▍      | 31/89 [04:45<09:19,  9.64s/it]Eval bleu for test set:  36%|███▌      | 32/89 [04:55<09:12,  9.69s/it]Eval bleu for test set:  37%|███▋      | 33/89 [05:03<08:46,  9.39s/it]Eval bleu for test set:  38%|███▊      | 34/89 [05:12<08:30,  9.27s/it]Eval bleu for test set:  39%|███▉      | 35/89 [05:21<08:09,  9.06s/it]Eval bleu for test set:  40%|████      | 36/89 [05:30<08:00,  9.07s/it]Eval bleu for test set:  42%|████▏     | 37/89 [05:39<07:44,  8.93s/it]Eval bleu for test set:  43%|████▎     | 38/89 [05:47<07:31,  8.85s/it]Eval bleu for test set:  44%|████▍     | 39/89 [05:56<07:17,  8.76s/it]Eval bleu for test set:  45%|████▍     | 40/89 [06:05<07:12,  8.83s/it]Eval bleu for test set:  46%|████▌     | 41/89 [06:14<07:06,  8.88s/it]Eval bleu for test set:  47%|████▋     | 42/89 [06:22<06:53,  8.80s/it]Eval bleu for test set:  48%|████▊     | 43/89 [06:31<06:41,  8.74s/it]Eval bleu for test set:  49%|████▉     | 44/89 [06:40<06:35,  8.79s/it]Eval bleu for test set:  51%|█████     | 45/89 [06:49<06:27,  8.81s/it]Eval bleu for test set:  52%|█████▏    | 46/89 [06:58<06:18,  8.79s/it]Eval bleu for test set:  53%|█████▎    | 47/89 [07:06<06:07,  8.74s/it]Eval bleu for test set:  54%|█████▍    | 48/89 [07:15<05:58,  8.75s/it]Eval bleu for test set:  55%|█████▌    | 49/89 [07:24<05:51,  8.78s/it]Eval bleu for test set:  56%|█████▌    | 50/89 [07:33<05:45,  8.85s/it]Eval bleu for test set:  57%|█████▋    | 51/89 [07:42<05:39,  8.93s/it]Eval bleu for test set:  58%|█████▊    | 52/89 [07:51<05:29,  8.92s/it]Eval bleu for test set:  60%|█████▉    | 53/89 [08:00<05:20,  8.91s/it]Eval bleu for test set:  61%|██████    | 54/89 [08:08<05:09,  8.86s/it]Eval bleu for test set:  62%|██████▏   | 55/89 [08:17<05:00,  8.83s/it]Eval bleu for test set:  63%|██████▎   | 56/89 [08:26<04:50,  8.79s/it]Eval bleu for test set:  64%|██████▍   | 57/89 [08:35<04:41,  8.80s/it]Eval bleu for test set:  65%|██████▌   | 58/89 [08:43<04:30,  8.72s/it]Eval bleu for test set:  66%|██████▋   | 59/89 [08:53<04:27,  8.91s/it]Eval bleu for test set:  67%|██████▋   | 60/89 [09:02<04:20,  8.99s/it]Eval bleu for test set:  69%|██████▊   | 61/89 [09:10<04:08,  8.87s/it]Eval bleu for test set:  70%|██████▉   | 62/89 [09:20<04:03,  9.03s/it]Eval bleu for test set:  71%|███████   | 63/89 [09:29<03:53,  8.99s/it]Eval bleu for test set:  72%|███████▏  | 64/89 [09:37<03:41,  8.87s/it]Eval bleu for test set:  73%|███████▎  | 65/89 [09:46<03:30,  8.76s/it]Eval bleu for test set:  74%|███████▍  | 66/89 [09:54<03:19,  8.69s/it]Eval bleu for test set:  75%|███████▌  | 67/89 [10:03<03:11,  8.71s/it]Eval bleu for test set:  76%|███████▋  | 68/89 [10:12<03:04,  8.79s/it]Eval bleu for test set:  78%|███████▊  | 69/89 [10:21<02:54,  8.73s/it]Eval bleu for test set:  79%|███████▊  | 70/89 [10:30<02:47,  8.82s/it]Eval bleu for test set:  80%|███████▉  | 71/89 [10:39<02:38,  8.83s/it]Eval bleu for test set:  81%|████████  | 72/89 [10:48<02:31,  8.89s/it]Eval bleu for test set:  82%|████████▏ | 73/89 [10:57<02:22,  8.92s/it]Eval bleu for test set:  83%|████████▎ | 74/89 [11:05<02:13,  8.90s/it]Eval bleu for test set:  84%|████████▍ | 75/89 [11:14<02:04,  8.92s/it]Eval bleu for test set:  85%|████████▌ | 76/89 [11:24<01:57,  9.05s/it]Eval bleu for test set:  87%|████████▋ | 77/89 [11:32<01:46,  8.90s/it]Eval bleu for test set:  88%|████████▊ | 78/89 [11:42<01:40,  9.18s/it]Eval bleu for test set:  89%|████████▉ | 79/89 [11:51<01:31,  9.11s/it]Eval bleu for test set:  90%|████████▉ | 80/89 [12:01<01:22,  9.22s/it]Eval bleu for test set:  91%|█████████ | 81/89 [12:10<01:13,  9.19s/it]Eval bleu for test set:  92%|█████████▏| 82/89 [12:19<01:03,  9.11s/it]Eval bleu for test set:  93%|█████████▎| 83/89 [12:27<00:54,  9.00s/it]Eval bleu for test set:  94%|█████████▍| 84/89 [12:36<00:44,  8.91s/it]Eval bleu for test set:  96%|█████████▌| 85/89 [12:45<00:35,  8.89s/it]Eval bleu for test set:  97%|█████████▋| 86/89 [12:54<00:26,  8.91s/it]Eval bleu for test set:  98%|█████████▊| 87/89 [13:02<00:17,  8.82s/it]Eval bleu for test set:  99%|█████████▉| 88/89 [13:11<00:08,  8.77s/it]Eval bleu for test set: 100%|██████████| 89/89 [13:17<00:00,  7.96s/it]Eval bleu for test set: 100%|██████████| 89/89 [13:17<00:00,  8.96s/it]
11/13/2022 00:38:07 - INFO - __main__ -   ***** Eval results *****
11/13/2022 00:38:07 - INFO - __main__ -     bleu = 78.31
11/13/2022 00:38:07 - INFO - __main__ -     codebleu = 79.2768
11/13/2022 00:38:07 - INFO - __main__ -     em = 21.8012
11/13/2022 00:38:07 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typemethod_renaming + whether_refactoringbefore_refactoring :
11/13/2022 00:38:07 - INFO - __main__ -   [best-bleu] bleu-4: 78.31, em: 21.8012, codebleu: 79.2768

11/13/2022 00:38:07 - INFO - __main__ -   Finish and take 19m
11/13/2022 00:38:07 - INFO - __main__ -     ***** Testing *****
11/13/2022 00:38:07 - INFO - __main__ -     Batch size = 64
11/13/2022 00:38:07 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 00:38:07 - INFO - __main__ -   test11111111111
11/13/2022 00:38:07 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 00:38:07 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/method_renaming/after_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/method_renaming/after_refactoring/small/test.buggy-fixed.fixed
11/13/2022 00:38:07 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 00:38:07 - INFO - utils -   Read 5674 examples, avg src len: 32, avg trg len: 29, max src len: 93, max trg len: 129
11/13/2022 00:38:07 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/test_src_all.pt
11/13/2022 00:38:07 - INFO - utils -   加载前test666666666666666
ngram match: 0.7830668812520044, weighted ngram match: 0.790707082492059, syntax_match: 0.8096477322147557, dataflow_match: 0.7876509159034139
  0%|          | 0/5674 [00:00<?, ?it/s] 50%|█████     | 2838/5674 [00:01<00:01, 1710.54it/s] 75%|███████▌  | 4257/5674 [00:03<00:01, 1302.99it/s]100%|██████████| 5674/5674 [00:03<00:00, 1822.51it/s]
11/13/2022 00:38:13 - INFO - utils -   加载后test77777777777777
11/13/2022 00:38:13 - INFO - __main__ -   加载成功test2222222222
11/13/2022 00:38:13 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 00:38:13 - INFO - __main__ -     Num examples = 5674
11/13/2022 00:38:13 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/89 [00:00<?, ?it/s]Eval bleu for test set:   1%|          | 1/89 [00:08<13:08,  8.96s/it]Eval bleu for test set:   2%|▏         | 2/89 [00:18<13:16,  9.16s/it]Eval bleu for test set:   3%|▎         | 3/89 [00:28<13:32,  9.45s/it]Eval bleu for test set:   4%|▍         | 4/89 [00:37<13:22,  9.45s/it]Eval bleu for test set:   6%|▌         | 5/89 [00:46<12:49,  9.16s/it]Eval bleu for test set:   7%|▋         | 6/89 [00:54<12:27,  9.00s/it]Eval bleu for test set:   8%|▊         | 7/89 [01:03<12:12,  8.93s/it]Eval bleu for test set:   9%|▉         | 8/89 [01:12<12:09,  9.00s/it]Eval bleu for test set:  10%|█         | 9/89 [01:21<12:01,  9.01s/it]Eval bleu for test set:  11%|█         | 10/89 [01:30<11:45,  8.93s/it]Eval bleu for test set:  12%|█▏        | 11/89 [01:39<11:26,  8.80s/it]Eval bleu for test set:  13%|█▎        | 12/89 [01:48<11:21,  8.85s/it]Eval bleu for test set:  15%|█▍        | 13/89 [01:57<11:16,  8.90s/it]Eval bleu for test set:  16%|█▌        | 14/89 [02:05<10:55,  8.74s/it]Eval bleu for test set:  17%|█▋        | 15/89 [02:14<10:53,  8.84s/it]Eval bleu for test set:  18%|█▊        | 16/89 [02:24<11:01,  9.06s/it]Eval bleu for test set:  19%|█▉        | 17/89 [02:32<10:40,  8.89s/it]Eval bleu for test set:  20%|██        | 18/89 [02:41<10:30,  8.87s/it]Eval bleu for test set:  21%|██▏       | 19/89 [02:50<10:16,  8.80s/it]Eval bleu for test set:  22%|██▏       | 20/89 [02:58<10:01,  8.72s/it]Eval bleu for test set:  24%|██▎       | 21/89 [03:07<09:53,  8.73s/it]Eval bleu for test set:  25%|██▍       | 22/89 [03:16<09:52,  8.85s/it]Eval bleu for test set:  26%|██▌       | 23/89 [03:25<09:57,  9.06s/it]Eval bleu for test set:  27%|██▋       | 24/89 [03:34<09:46,  9.03s/it]Eval bleu for test set:  28%|██▊       | 25/89 [03:43<09:28,  8.89s/it]Eval bleu for test set:  29%|██▉       | 26/89 [03:52<09:15,  8.82s/it]Eval bleu for test set:  30%|███       | 27/89 [04:01<09:15,  8.97s/it]Eval bleu for test set:  31%|███▏      | 28/89 [04:10<09:05,  8.94s/it]Eval bleu for test set:  33%|███▎      | 29/89 [04:20<09:18,  9.31s/it]Eval bleu for test set:  34%|███▎      | 30/89 [04:30<09:29,  9.64s/it]Eval bleu for test set:  35%|███▍      | 31/89 [04:40<09:24,  9.73s/it]Eval bleu for test set:  36%|███▌      | 32/89 [04:49<08:58,  9.45s/it]Eval bleu for test set:  37%|███▋      | 33/89 [04:58<08:42,  9.33s/it]Eval bleu for test set:  38%|███▊      | 34/89 [05:07<08:28,  9.25s/it]Eval bleu for test set:  39%|███▉      | 35/89 [05:16<08:07,  9.03s/it]Eval bleu for test set:  40%|████      | 36/89 [05:25<07:55,  8.97s/it]Eval bleu for test set:  42%|████▏     | 37/89 [05:33<07:41,  8.87s/it]Eval bleu for test set:  43%|████▎     | 38/89 [05:42<07:29,  8.80s/it]Eval bleu for test set:  44%|████▍     | 39/89 [05:51<07:17,  8.76s/it]Eval bleu for test set:  45%|████▍     | 40/89 [05:59<07:10,  8.79s/it]Eval bleu for test set:  46%|████▌     | 41/89 [06:08<07:05,  8.86s/it]Eval bleu for test set:  47%|████▋     | 42/89 [06:17<06:52,  8.77s/it]Eval bleu for test set:  48%|████▊     | 43/89 [06:26<06:41,  8.73s/it]Eval bleu for test set:  49%|████▉     | 44/89 [06:34<06:34,  8.76s/it]Eval bleu for test set:  51%|█████     | 45/89 [06:43<06:25,  8.76s/it]Eval bleu for test set:  52%|█████▏    | 46/89 [06:52<06:16,  8.75s/it]Eval bleu for test set:  53%|█████▎    | 47/89 [07:01<06:07,  8.74s/it]Eval bleu for test set:  54%|█████▍    | 48/89 [07:09<05:58,  8.74s/it]Eval bleu for test set:  55%|█████▌    | 49/89 [07:18<05:52,  8.81s/it]Eval bleu for test set:  56%|█████▌    | 50/89 [07:27<05:46,  8.89s/it]Eval bleu for test set:  57%|█████▋    | 51/89 [07:37<05:39,  8.94s/it]Eval bleu for test set:  58%|█████▊    | 52/89 [07:45<05:29,  8.90s/it]Eval bleu for test set:  60%|█████▉    | 53/89 [07:54<05:21,  8.93s/it]Eval bleu for test set:  61%|██████    | 54/89 [08:03<05:12,  8.92s/it]Eval bleu for test set:  62%|██████▏   | 55/89 [08:12<05:02,  8.91s/it]Eval bleu for test set:  63%|██████▎   | 56/89 [08:21<04:51,  8.83s/it]Eval bleu for test set:  64%|██████▍   | 57/89 [08:29<04:40,  8.77s/it]Eval bleu for test set:  65%|██████▌   | 58/89 [08:38<04:29,  8.69s/it]Eval bleu for test set:  66%|██████▋   | 59/89 [08:48<04:31,  9.05s/it]Eval bleu for test set:  67%|██████▋   | 60/89 [08:57<04:23,  9.08s/it]Eval bleu for test set:  69%|██████▊   | 61/89 [09:07<04:18,  9.23s/it]Eval bleu for test set:  70%|██████▉   | 62/89 [09:17<04:18,  9.57s/it]Eval bleu for test set:  71%|███████   | 63/89 [09:27<04:12,  9.71s/it]Eval bleu for test set:  72%|███████▏  | 64/89 [09:37<04:03,  9.74s/it]Eval bleu for test set:  73%|███████▎  | 65/89 [09:45<03:46,  9.42s/it]Eval bleu for test set:  74%|███████▍  | 66/89 [09:54<03:31,  9.18s/it]Eval bleu for test set:  75%|███████▌  | 67/89 [10:03<03:20,  9.10s/it]Eval bleu for test set:  76%|███████▋  | 68/89 [10:12<03:09,  9.01s/it]Eval bleu for test set:  78%|███████▊  | 69/89 [10:20<02:57,  8.86s/it]Eval bleu for test set:  79%|███████▊  | 70/89 [10:29<02:47,  8.81s/it]Eval bleu for test set:  80%|███████▉  | 71/89 [10:38<02:39,  8.85s/it]Eval bleu for test set:  81%|████████  | 72/89 [10:46<02:29,  8.77s/it]Eval bleu for test set:  82%|████████▏ | 73/89 [10:55<02:19,  8.74s/it]Eval bleu for test set:  83%|████████▎ | 74/89 [11:04<02:12,  8.81s/it]Eval bleu for test set:  84%|████████▍ | 75/89 [11:13<02:02,  8.74s/it]Eval bleu for test set:  85%|████████▌ | 76/89 [11:22<01:54,  8.83s/it]Eval bleu for test set:  87%|████████▋ | 77/89 [11:30<01:45,  8.80s/it]Eval bleu for test set:  88%|████████▊ | 78/89 [11:40<01:37,  8.89s/it]Eval bleu for test set:  89%|████████▉ | 79/89 [11:49<01:29,  8.93s/it]Eval bleu for test set:  90%|████████▉ | 80/89 [11:57<01:20,  8.89s/it]Eval bleu for test set:  91%|█████████ | 81/89 [12:06<01:11,  8.92s/it]Eval bleu for test set:  92%|█████████▏| 82/89 [12:15<01:02,  8.90s/it]Eval bleu for test set:  93%|█████████▎| 83/89 [12:24<00:53,  8.90s/it]Eval bleu for test set:  94%|█████████▍| 84/89 [12:33<00:44,  8.86s/it]Eval bleu for test set:  96%|█████████▌| 85/89 [12:42<00:35,  8.86s/it]Eval bleu for test set:  97%|█████████▋| 86/89 [12:51<00:26,  8.91s/it]Eval bleu for test set:  98%|█████████▊| 87/89 [13:00<00:17,  8.88s/it]Eval bleu for test set:  99%|█████████▉| 88/89 [13:08<00:08,  8.81s/it]Eval bleu for test set: 100%|██████████| 89/89 [13:14<00:00,  8.03s/it]Eval bleu for test set: 100%|██████████| 89/89 [13:15<00:00,  8.93s/it]
11/13/2022 00:55:28 - INFO - __main__ -   ***** Eval results *****
11/13/2022 00:55:28 - INFO - __main__ -     bleu = 78.29
11/13/2022 00:55:28 - INFO - __main__ -     codebleu = 79.1516
11/13/2022 00:55:28 - INFO - __main__ -     em = 16.9545
11/13/2022 00:55:28 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typemethod_renaming + whether_refactoringafter_refactoring :
11/13/2022 00:55:28 - INFO - __main__ -   [best-bleu] bleu-4: 78.29, em: 16.9545, codebleu: 79.1516

11/13/2022 00:55:28 - INFO - __main__ -   Finish and take 36m
11/13/2022 00:55:28 - INFO - __main__ -     ***** Testing *****
11/13/2022 00:55:28 - INFO - __main__ -     Batch size = 64
11/13/2022 00:55:28 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 00:55:28 - INFO - __main__ -   test11111111111
11/13/2022 00:55:28 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 00:55:28 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/parameter_renaming/before_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/parameter_renaming/before_refactoring/small/test.buggy-fixed.fixed
11/13/2022 00:55:28 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 00:55:28 - INFO - utils -   Read 3444 examples, avg src len: 33, avg trg len: 31, max src len: 93, max trg len: 93
11/13/2022 00:55:28 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/test_src_all.pt
11/13/2022 00:55:28 - INFO - utils -   加载前test666666666666666
ngram match: 0.7829335333508698, weighted ngram match: 0.7897812013295543, syntax_match: 0.80788574715385, dataflow_match: 0.785463528799896
  0%|          | 0/3444 [00:00<?, ?it/s] 50%|█████     | 1722/3444 [00:01<00:01, 1449.86it/s] 75%|███████▌  | 2583/3444 [00:02<00:00, 1166.44it/s]100%|██████████| 3444/3444 [00:03<00:00, 1038.08it/s]100%|██████████| 3444/3444 [00:03<00:00, 1106.96it/s]
11/13/2022 00:55:32 - INFO - utils -   加载后test77777777777777
11/13/2022 00:55:32 - INFO - __main__ -   加载成功test2222222222
11/13/2022 00:55:32 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 00:55:32 - INFO - __main__ -     Num examples = 3444
11/13/2022 00:55:32 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/54 [00:00<?, ?it/s]Eval bleu for test set:   2%|▏         | 1/54 [00:09<08:16,  9.38s/it]Eval bleu for test set:   4%|▎         | 2/54 [00:19<08:21,  9.65s/it]Eval bleu for test set:   6%|▌         | 3/54 [00:28<07:58,  9.38s/it]Eval bleu for test set:   7%|▋         | 4/54 [00:37<07:40,  9.20s/it]Eval bleu for test set:   9%|▉         | 5/54 [00:46<07:32,  9.22s/it]Eval bleu for test set:  11%|█         | 6/54 [00:55<07:15,  9.08s/it]Eval bleu for test set:  13%|█▎        | 7/54 [01:03<06:57,  8.88s/it]Eval bleu for test set:  15%|█▍        | 8/54 [01:12<06:53,  8.99s/it]Eval bleu for test set:  17%|█▋        | 9/54 [01:22<06:50,  9.13s/it]Eval bleu for test set:  19%|█▊        | 10/54 [01:31<06:37,  9.04s/it]Eval bleu for test set:  20%|██        | 11/54 [01:40<06:29,  9.05s/it]Eval bleu for test set:  22%|██▏       | 12/54 [01:49<06:20,  9.07s/it]Eval bleu for test set:  24%|██▍       | 13/54 [01:59<06:19,  9.27s/it]Eval bleu for test set:  26%|██▌       | 14/54 [02:08<06:05,  9.15s/it]Eval bleu for test set:  28%|██▊       | 15/54 [02:16<05:53,  9.08s/it]Eval bleu for test set:  30%|██▉       | 16/54 [02:25<05:40,  8.97s/it]Eval bleu for test set:  31%|███▏      | 17/54 [02:34<05:35,  9.07s/it]Eval bleu for test set:  33%|███▎      | 18/54 [02:44<05:28,  9.12s/it]Eval bleu for test set:  35%|███▌      | 19/54 [02:53<05:21,  9.18s/it]Eval bleu for test set:  37%|███▋      | 20/54 [03:02<05:14,  9.24s/it]Eval bleu for test set:  39%|███▉      | 21/54 [03:11<05:02,  9.16s/it]Eval bleu for test set:  41%|████      | 22/54 [03:20<04:49,  9.05s/it]Eval bleu for test set:  43%|████▎     | 23/54 [03:29<04:39,  9.01s/it]Eval bleu for test set:  44%|████▍     | 24/54 [03:38<04:28,  8.96s/it]Eval bleu for test set:  46%|████▋     | 25/54 [03:47<04:21,  9.01s/it]Eval bleu for test set:  48%|████▊     | 26/54 [03:56<04:10,  8.94s/it]Eval bleu for test set:  50%|█████     | 27/54 [04:05<04:02,  8.97s/it]Eval bleu for test set:  52%|█████▏    | 28/54 [04:14<03:52,  8.96s/it]Eval bleu for test set:  54%|█████▎    | 29/54 [04:23<03:42,  8.89s/it]Eval bleu for test set:  56%|█████▌    | 30/54 [04:32<03:35,  8.99s/it]Eval bleu for test set:  57%|█████▋    | 31/54 [04:41<03:28,  9.08s/it]Eval bleu for test set:  59%|█████▉    | 32/54 [04:50<03:19,  9.06s/it]Eval bleu for test set:  61%|██████    | 33/54 [04:59<03:10,  9.09s/it]Eval bleu for test set:  63%|██████▎   | 34/54 [05:08<03:00,  9.05s/it]Eval bleu for test set:  65%|██████▍   | 35/54 [05:17<02:48,  8.86s/it]Eval bleu for test set:  67%|██████▋   | 36/54 [05:26<02:39,  8.88s/it]Eval bleu for test set:  69%|██████▊   | 37/54 [05:35<02:34,  9.08s/it]Eval bleu for test set:  70%|███████   | 38/54 [05:44<02:26,  9.17s/it]Eval bleu for test set:  72%|███████▏  | 39/54 [05:53<02:16,  9.08s/it]Eval bleu for test set:  74%|███████▍  | 40/54 [06:02<02:06,  9.02s/it]Eval bleu for test set:  76%|███████▌  | 41/54 [06:11<01:56,  8.94s/it]Eval bleu for test set:  78%|███████▊  | 42/54 [06:20<01:47,  8.94s/it]Eval bleu for test set:  80%|███████▉  | 43/54 [06:29<01:37,  8.87s/it]Eval bleu for test set:  81%|████████▏ | 44/54 [06:38<01:29,  8.91s/it]Eval bleu for test set:  83%|████████▎ | 45/54 [06:46<01:19,  8.87s/it]Eval bleu for test set:  85%|████████▌ | 46/54 [06:55<01:11,  8.95s/it]Eval bleu for test set:  87%|████████▋ | 47/54 [07:04<01:02,  8.93s/it]Eval bleu for test set:  89%|████████▉ | 48/54 [07:13<00:53,  8.96s/it]Eval bleu for test set:  91%|█████████ | 49/54 [07:22<00:44,  8.93s/it]Eval bleu for test set:  93%|█████████▎| 50/54 [07:32<00:36,  9.10s/it]Eval bleu for test set:  94%|█████████▍| 51/54 [07:41<00:27,  9.02s/it]Eval bleu for test set:  96%|█████████▋| 52/54 [07:49<00:17,  8.98s/it]Eval bleu for test set:  98%|█████████▊| 53/54 [07:58<00:08,  8.90s/it]Eval bleu for test set: 100%|██████████| 54/54 [08:06<00:00,  8.46s/it]Eval bleu for test set: 100%|██████████| 54/54 [08:06<00:00,  9.00s/it]
11/13/2022 01:06:03 - INFO - __main__ -   ***** Eval results *****
11/13/2022 01:06:03 - INFO - __main__ -     bleu = 79.27
11/13/2022 01:06:03 - INFO - __main__ -     codebleu = 80.2168
11/13/2022 01:06:03 - INFO - __main__ -     em = 22.4448
11/13/2022 01:06:03 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typeparameter_renaming + whether_refactoringbefore_refactoring :
11/13/2022 01:06:03 - INFO - __main__ -   [best-bleu] bleu-4: 79.27, em: 22.4448, codebleu: 80.2168

11/13/2022 01:06:03 - INFO - __main__ -   Finish and take 47m
11/13/2022 01:06:03 - INFO - __main__ -     ***** Testing *****
11/13/2022 01:06:03 - INFO - __main__ -     Batch size = 64
11/13/2022 01:06:03 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 01:06:03 - INFO - __main__ -   test11111111111
11/13/2022 01:06:03 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 01:06:03 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/parameter_renaming/after_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/parameter_renaming/after_refactoring/small/test.buggy-fixed.fixed
11/13/2022 01:06:03 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 01:06:03 - INFO - utils -   Read 3444 examples, avg src len: 33, avg trg len: 31, max src len: 93, max trg len: 93
11/13/2022 01:06:03 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/test_src_all.pt
11/13/2022 01:06:03 - INFO - utils -   加载前test666666666666666
ngram match: 0.7926981381321918, weighted ngram match: 0.7954083779341077, syntax_match: 0.8169297363473395, dataflow_match: 0.8036340949855728
  0%|          | 0/3444 [00:00<?, ?it/s] 50%|█████     | 1722/3444 [00:01<00:01, 1492.77it/s] 75%|███████▌  | 2583/3444 [00:02<00:00, 1178.53it/s]100%|██████████| 3444/3444 [00:03<00:00, 1055.19it/s]100%|██████████| 3444/3444 [00:03<00:00, 1125.69it/s]
11/13/2022 01:06:07 - INFO - utils -   加载后test77777777777777
11/13/2022 01:06:07 - INFO - __main__ -   加载成功test2222222222
11/13/2022 01:06:07 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 01:06:07 - INFO - __main__ -     Num examples = 3444
11/13/2022 01:06:07 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/54 [00:00<?, ?it/s]Eval bleu for test set:   2%|▏         | 1/54 [00:09<08:29,  9.61s/it]Eval bleu for test set:   4%|▎         | 2/54 [00:19<08:15,  9.53s/it]Eval bleu for test set:   6%|▌         | 3/54 [00:27<07:48,  9.20s/it]Eval bleu for test set:   7%|▋         | 4/54 [00:36<07:34,  9.09s/it]Eval bleu for test set:   9%|▉         | 5/54 [00:45<07:20,  8.99s/it]Eval bleu for test set:  11%|█         | 6/54 [00:54<07:10,  8.97s/it]Eval bleu for test set:  13%|█▎        | 7/54 [01:03<06:56,  8.87s/it]Eval bleu for test set:  15%|█▍        | 8/54 [01:12<06:52,  8.97s/it]Eval bleu for test set:  17%|█▋        | 9/54 [01:21<06:43,  8.96s/it]Eval bleu for test set:  19%|█▊        | 10/54 [01:30<06:36,  9.01s/it]Eval bleu for test set:  20%|██        | 11/54 [01:39<06:30,  9.07s/it]Eval bleu for test set:  22%|██▏       | 12/54 [01:48<06:20,  9.06s/it]Eval bleu for test set:  24%|██▍       | 13/54 [01:57<06:12,  9.09s/it]Eval bleu for test set:  26%|██▌       | 14/54 [02:06<06:02,  9.06s/it]Eval bleu for test set:  28%|██▊       | 15/54 [02:16<05:55,  9.13s/it]Eval bleu for test set:  30%|██▉       | 16/54 [02:25<05:46,  9.11s/it]Eval bleu for test set:  31%|███▏      | 17/54 [02:34<05:34,  9.03s/it]Eval bleu for test set:  33%|███▎      | 18/54 [02:43<05:28,  9.13s/it]Eval bleu for test set:  35%|███▌      | 19/54 [02:52<05:20,  9.16s/it]Eval bleu for test set:  37%|███▋      | 20/54 [03:01<05:11,  9.16s/it]Eval bleu for test set:  39%|███▉      | 21/54 [03:11<05:04,  9.22s/it]Eval bleu for test set:  41%|████      | 22/54 [03:20<04:52,  9.14s/it]Eval bleu for test set:  43%|████▎     | 23/54 [03:28<04:40,  9.06s/it]Eval bleu for test set:  44%|████▍     | 24/54 [03:37<04:30,  9.02s/it]Eval bleu for test set:  46%|████▋     | 25/54 [03:47<04:23,  9.10s/it]Eval bleu for test set:  48%|████▊     | 26/54 [03:56<04:14,  9.10s/it]Eval bleu for test set:  50%|█████     | 27/54 [04:05<04:04,  9.04s/it]Eval bleu for test set:  52%|█████▏    | 28/54 [04:14<03:56,  9.11s/it]Eval bleu for test set:  54%|█████▎    | 29/54 [04:23<03:46,  9.05s/it]Eval bleu for test set:  56%|█████▌    | 30/54 [04:32<03:39,  9.13s/it]Eval bleu for test set:  57%|█████▋    | 31/54 [04:42<03:34,  9.32s/it]Eval bleu for test set:  59%|█████▉    | 32/54 [04:51<03:25,  9.32s/it]Eval bleu for test set:  61%|██████    | 33/54 [05:01<03:17,  9.40s/it]Eval bleu for test set:  63%|██████▎   | 34/54 [05:11<03:11,  9.56s/it]Eval bleu for test set:  65%|██████▍   | 35/54 [05:20<02:56,  9.31s/it]Eval bleu for test set:  67%|██████▋   | 36/54 [05:29<02:46,  9.23s/it]Eval bleu for test set:  69%|██████▊   | 37/54 [05:38<02:37,  9.27s/it]Eval bleu for test set:  70%|███████   | 38/54 [05:47<02:26,  9.18s/it]Eval bleu for test set:  72%|███████▏  | 39/54 [05:56<02:16,  9.10s/it]Eval bleu for test set:  74%|███████▍  | 40/54 [06:05<02:06,  9.03s/it]Eval bleu for test set:  76%|███████▌  | 41/54 [06:14<01:56,  8.99s/it]Eval bleu for test set:  78%|███████▊  | 42/54 [06:23<01:47,  9.00s/it]Eval bleu for test set:  80%|███████▉  | 43/54 [06:32<01:38,  8.97s/it]Eval bleu for test set:  81%|████████▏ | 44/54 [06:41<01:30,  9.00s/it]Eval bleu for test set:  83%|████████▎ | 45/54 [06:50<01:21,  9.02s/it]Eval bleu for test set:  85%|████████▌ | 46/54 [06:59<01:11,  8.97s/it]Eval bleu for test set:  87%|████████▋ | 47/54 [07:07<01:02,  8.92s/it]Eval bleu for test set:  89%|████████▉ | 48/54 [07:16<00:53,  8.97s/it]Eval bleu for test set:  91%|█████████ | 49/54 [07:25<00:44,  8.98s/it]Eval bleu for test set:  93%|█████████▎| 50/54 [07:34<00:35,  8.94s/it]Eval bleu for test set:  94%|█████████▍| 51/54 [07:43<00:26,  8.93s/it]Eval bleu for test set:  96%|█████████▋| 52/54 [07:52<00:17,  8.93s/it]Eval bleu for test set:  98%|█████████▊| 53/54 [08:01<00:08,  8.91s/it]Eval bleu for test set: 100%|██████████| 54/54 [08:08<00:00,  8.46s/it]Eval bleu for test set: 100%|██████████| 54/54 [08:08<00:00,  9.06s/it]
11/13/2022 01:16:47 - INFO - __main__ -   ***** Eval results *****
11/13/2022 01:16:47 - INFO - __main__ -     bleu = 78.76
11/13/2022 01:16:47 - INFO - __main__ -     codebleu = 79.7135
11/13/2022 01:16:47 - INFO - __main__ -     em = 17.0732
11/13/2022 01:16:47 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typeparameter_renaming + whether_refactoringafter_refactoring :
11/13/2022 01:16:47 - INFO - __main__ -   [best-bleu] bleu-4: 78.76, em: 17.0732, codebleu: 79.7135

11/13/2022 01:16:47 - INFO - __main__ -   Finish and take 57m
11/13/2022 01:16:47 - INFO - __main__ -     ***** Testing *****
11/13/2022 01:16:47 - INFO - __main__ -     Batch size = 64
11/13/2022 01:16:47 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 01:16:47 - INFO - __main__ -   test11111111111
11/13/2022 01:16:47 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 01:16:47 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/boolean_exchange/before_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/boolean_exchange/before_refactoring/small/test.buggy-fixed.fixed
11/13/2022 01:16:47 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 01:16:47 - INFO - utils -   Read 32 examples, avg src len: 38, avg trg len: 38, max src len: 52, max trg len: 51
11/13/2022 01:16:47 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/test_src_all.pt
11/13/2022 01:16:47 - INFO - utils -   加载前test666666666666666
ngram match: 0.7876115642558716, weighted ngram match: 0.7903101440951121, syntax_match: 0.8106500480223522, dataflow_match: 0.7999693086779713
  0%|          | 0/32 [00:00<?, ?it/s] 50%|█████     | 16/32 [00:00<00:00, 99.96it/s]100%|██████████| 32/32 [00:00<00:00, 123.73it/s]100%|██████████| 32/32 [00:00<00:00, 119.33it/s]
11/13/2022 01:16:47 - INFO - utils -   加载后test77777777777777
11/13/2022 01:16:47 - INFO - __main__ -   加载成功test2222222222
11/13/2022 01:16:47 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 01:16:47 - INFO - __main__ -     Num examples = 32
11/13/2022 01:16:47 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/1 [00:00<?, ?it/s]Eval bleu for test set: 100%|██████████| 1/1 [00:05<00:00,  5.23s/it]Eval bleu for test set: 100%|██████████| 1/1 [00:05<00:00,  5.32s/it]
11/13/2022 01:16:54 - INFO - __main__ -   ***** Eval results *****
11/13/2022 01:16:54 - INFO - __main__ -     bleu = 78.53
11/13/2022 01:16:54 - INFO - __main__ -     codebleu = 80.5149
11/13/2022 01:16:54 - INFO - __main__ -     em = 15.625
11/13/2022 01:16:54 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typeboolean_exchange + whether_refactoringbefore_refactoring :
11/13/2022 01:16:54 - INFO - __main__ -   [best-bleu] bleu-4: 78.53, em: 15.6250, codebleu: 80.5149

11/13/2022 01:16:54 - INFO - __main__ -   Finish and take 58m
11/13/2022 01:16:54 - INFO - __main__ -     ***** Testing *****
11/13/2022 01:16:54 - INFO - __main__ -     Batch size = 64
11/13/2022 01:16:54 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 01:16:54 - INFO - __main__ -   test11111111111
11/13/2022 01:16:54 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 01:16:54 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/boolean_exchange/after_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/boolean_exchange/after_refactoring/small/test.buggy-fixed.fixed
11/13/2022 01:16:54 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 01:16:54 - INFO - utils -   Read 32 examples, avg src len: 38, avg trg len: 37, max src len: 53, max trg len: 49
11/13/2022 01:16:54 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/test_src_all.pt
11/13/2022 01:16:54 - INFO - utils -   加载前test666666666666666
ngram match: 0.7851972644337929, weighted ngram match: 0.7860627444801445, syntax_match: 0.796875, dataflow_match: 0.8524590163934426
  0%|          | 0/32 [00:00<?, ?it/s] 50%|█████     | 16/32 [00:00<00:00, 97.63it/s]100%|██████████| 32/32 [00:00<00:00, 121.23it/s]100%|██████████| 32/32 [00:00<00:00, 116.85it/s]
11/13/2022 01:16:54 - INFO - utils -   加载后test77777777777777
11/13/2022 01:16:55 - INFO - __main__ -   加载成功test2222222222
11/13/2022 01:16:55 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 01:16:55 - INFO - __main__ -     Num examples = 32
11/13/2022 01:16:55 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/1 [00:00<?, ?it/s]Eval bleu for test set: 100%|██████████| 1/1 [00:05<00:00,  5.06s/it]Eval bleu for test set: 100%|██████████| 1/1 [00:05<00:00,  5.13s/it]
11/13/2022 01:17:01 - INFO - __main__ -   ***** Eval results *****
11/13/2022 01:17:01 - INFO - __main__ -     bleu = 68.01
11/13/2022 01:17:01 - INFO - __main__ -     codebleu = 75.0222
11/13/2022 01:17:01 - INFO - __main__ -     em = 3.125
11/13/2022 01:17:01 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typeboolean_exchange + whether_refactoringafter_refactoring :
11/13/2022 01:17:01 - INFO - __main__ -   [best-bleu] bleu-4: 68.01, em: 3.1250, codebleu: 75.0222

11/13/2022 01:17:01 - INFO - __main__ -   Finish and take 58m
11/13/2022 01:17:01 - INFO - __main__ -     ***** Testing *****
11/13/2022 01:17:01 - INFO - __main__ -     Batch size = 64
11/13/2022 01:17:01 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 01:17:01 - INFO - __main__ -   test11111111111
11/13/2022 01:17:01 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 01:17:01 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/convert_switch_to_if/before_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/convert_switch_to_if/before_refactoring/small/test.buggy-fixed.fixed
11/13/2022 01:17:01 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 01:17:01 - INFO - utils -   Read 44 examples, avg src len: 40, avg trg len: 37, max src len: 57, max trg len: 54
11/13/2022 01:17:01 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/test_src_all.pt
11/13/2022 01:17:01 - INFO - utils -   加载前test666666666666666
ngram match: 0.6798621587449278, weighted ngram match: 0.6861736044321216, syntax_match: 0.766, dataflow_match: 0.8688524590163934
  0%|          | 0/44 [00:00<?, ?it/s] 50%|█████     | 22/44 [00:00<00:00, 133.09it/s]100%|██████████| 44/44 [00:00<00:00, 158.00it/s]100%|██████████| 44/44 [00:00<00:00, 153.52it/s]
11/13/2022 01:17:02 - INFO - utils -   加载后test77777777777777
11/13/2022 01:17:02 - INFO - __main__ -   加载成功test2222222222
11/13/2022 01:17:02 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 01:17:02 - INFO - __main__ -     Num examples = 44
11/13/2022 01:17:02 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/1 [00:00<?, ?it/s]Eval bleu for test set: 100%|██████████| 1/1 [00:07<00:00,  7.09s/it]Eval bleu for test set: 100%|██████████| 1/1 [00:07<00:00,  7.16s/it]
11/13/2022 01:17:11 - INFO - __main__ -   ***** Eval results *****
11/13/2022 01:17:11 - INFO - __main__ -     bleu = 83.92
11/13/2022 01:17:11 - INFO - __main__ -     codebleu = 85.3893
11/13/2022 01:17:11 - INFO - __main__ -     em = 13.6364
11/13/2022 01:17:11 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typeconvert_switch_to_if + whether_refactoringbefore_refactoring :
11/13/2022 01:17:11 - INFO - __main__ -   [best-bleu] bleu-4: 83.92, em: 13.6364, codebleu: 85.3893

11/13/2022 01:17:11 - INFO - __main__ -   Finish and take 58m
11/13/2022 01:17:11 - INFO - __main__ -     ***** Testing *****
11/13/2022 01:17:11 - INFO - __main__ -     Batch size = 64
11/13/2022 01:17:11 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 01:17:11 - INFO - __main__ -   test11111111111
11/13/2022 01:17:11 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 01:17:11 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/convert_switch_to_if/after_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/convert_switch_to_if/after_refactoring/small/test.buggy-fixed.fixed
11/13/2022 01:17:11 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 01:17:11 - INFO - utils -   Read 44 examples, avg src len: 44, avg trg len: 39, max src len: 76, max trg len: 74
11/13/2022 01:17:11 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/test_src_all.pt
11/13/2022 01:17:11 - INFO - utils -   加载前test666666666666666
ngram match: 0.8390730748510603, weighted ngram match: 0.8494123359845871, syntax_match: 0.8268082282680823, dataflow_match: 0.9002770083102493
  0%|          | 0/44 [00:00<?, ?it/s] 50%|█████     | 22/44 [00:00<00:00, 136.85it/s]100%|██████████| 44/44 [00:00<00:00, 160.81it/s]100%|██████████| 44/44 [00:00<00:00, 156.52it/s]
11/13/2022 01:17:12 - INFO - utils -   加载后test77777777777777
11/13/2022 01:17:12 - INFO - __main__ -   加载成功test2222222222
11/13/2022 01:17:12 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 01:17:12 - INFO - __main__ -     Num examples = 44
11/13/2022 01:17:12 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/1 [00:00<?, ?it/s]Eval bleu for test set: 100%|██████████| 1/1 [00:07<00:00,  7.17s/it]Eval bleu for test set: 100%|██████████| 1/1 [00:07<00:00,  7.25s/it]
11/13/2022 01:17:21 - INFO - __main__ -   ***** Eval results *****
11/13/2022 01:17:21 - INFO - __main__ -     bleu = 70.15
11/13/2022 01:17:21 - INFO - __main__ -     codebleu = 73.6138
11/13/2022 01:17:21 - INFO - __main__ -     em = 0.0
11/13/2022 01:17:21 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typeconvert_switch_to_if + whether_refactoringafter_refactoring :
11/13/2022 01:17:21 - INFO - __main__ -   [best-bleu] bleu-4: 70.15, em: 0.0000, codebleu: 73.6138

11/13/2022 01:17:21 - INFO - __main__ -   Finish and take 58m
11/13/2022 01:17:21 - INFO - __main__ -     ***** Testing *****
11/13/2022 01:17:21 - INFO - __main__ -     Batch size = 64
11/13/2022 01:17:21 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 01:17:21 - INFO - __main__ -   test11111111111
11/13/2022 01:17:21 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 01:17:21 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/insert_log_statement/before_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/insert_log_statement/before_refactoring/small/test.buggy-fixed.fixed
11/13/2022 01:17:21 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 01:17:21 - INFO - utils -   Read 5608 examples, avg src len: 32, avg trg len: 29, max src len: 93, max trg len: 129
11/13/2022 01:17:21 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/test_src_all.pt
11/13/2022 01:17:21 - INFO - utils -   加载前test666666666666666
ngram match: 0.7013151106393425, weighted ngram match: 0.7076279591109458, syntax_match: 0.7670157068062827, dataflow_match: 0.768595041322314
  0%|          | 0/5608 [00:00<?, ?it/s] 50%|█████     | 2804/5608 [00:01<00:01, 1728.06it/s] 75%|███████▌  | 4206/5608 [00:03<00:01, 1259.94it/s]100%|██████████| 5608/5608 [00:04<00:00, 1148.46it/s]100%|██████████| 5608/5608 [00:04<00:00, 1229.75it/s]
11/13/2022 01:17:27 - INFO - utils -   加载后test77777777777777
11/13/2022 01:17:28 - INFO - __main__ -   加载成功test2222222222
11/13/2022 01:17:28 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 01:17:28 - INFO - __main__ -     Num examples = 5608
11/13/2022 01:17:28 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/88 [00:00<?, ?it/s]Eval bleu for test set:   1%|          | 1/88 [00:09<13:23,  9.23s/it]Eval bleu for test set:   2%|▏         | 2/88 [00:17<12:44,  8.89s/it]Eval bleu for test set:   3%|▎         | 3/88 [00:26<12:27,  8.79s/it]Eval bleu for test set:   5%|▍         | 4/88 [00:35<12:20,  8.82s/it]Eval bleu for test set:   6%|▌         | 5/88 [00:44<12:07,  8.77s/it]Eval bleu for test set:   7%|▋         | 6/88 [00:52<11:54,  8.72s/it]Eval bleu for test set:   8%|▊         | 7/88 [01:01<11:55,  8.83s/it]Eval bleu for test set:   9%|▉         | 8/88 [01:10<11:46,  8.83s/it]Eval bleu for test set:  10%|█         | 9/88 [01:19<11:38,  8.84s/it]Eval bleu for test set:  11%|█▏        | 10/88 [01:28<11:38,  8.96s/it]Eval bleu for test set:  12%|█▎        | 11/88 [01:37<11:25,  8.90s/it]Eval bleu for test set:  14%|█▎        | 12/88 [01:46<11:17,  8.92s/it]Eval bleu for test set:  15%|█▍        | 13/88 [01:55<11:05,  8.87s/it]Eval bleu for test set:  16%|█▌        | 14/88 [02:03<10:53,  8.83s/it]Eval bleu for test set:  17%|█▋        | 15/88 [02:12<10:48,  8.88s/it]Eval bleu for test set:  18%|█▊        | 16/88 [02:21<10:37,  8.86s/it]Eval bleu for test set:  19%|█▉        | 17/88 [02:30<10:25,  8.81s/it]Eval bleu for test set:  20%|██        | 18/88 [02:39<10:20,  8.87s/it]Eval bleu for test set:  22%|██▏       | 19/88 [02:48<10:16,  8.93s/it]Eval bleu for test set:  23%|██▎       | 20/88 [02:57<10:08,  8.95s/it]Eval bleu for test set:  24%|██▍       | 21/88 [03:05<09:48,  8.78s/it]Eval bleu for test set:  25%|██▌       | 22/88 [03:14<09:38,  8.77s/it]Eval bleu for test set:  26%|██▌       | 23/88 [03:23<09:29,  8.76s/it]Eval bleu for test set:  27%|██▋       | 24/88 [03:31<09:17,  8.72s/it]Eval bleu for test set:  28%|██▊       | 25/88 [03:40<09:09,  8.72s/it]Eval bleu for test set:  30%|██▉       | 26/88 [03:49<08:57,  8.67s/it]Eval bleu for test set:  31%|███       | 27/88 [03:58<08:51,  8.72s/it]Eval bleu for test set:  32%|███▏      | 28/88 [04:07<08:49,  8.82s/it]Eval bleu for test set:  33%|███▎      | 29/88 [04:16<08:41,  8.84s/it]Eval bleu for test set:  34%|███▍      | 30/88 [04:24<08:29,  8.78s/it]Eval bleu for test set:  35%|███▌      | 31/88 [04:33<08:29,  8.94s/it]Eval bleu for test set:  36%|███▋      | 32/88 [04:44<08:40,  9.30s/it]Eval bleu for test set:  38%|███▊      | 33/88 [04:54<08:45,  9.55s/it]Eval bleu for test set:  39%|███▊      | 34/88 [05:04<08:43,  9.69s/it]Eval bleu for test set:  40%|███▉      | 35/88 [05:14<08:35,  9.73s/it]Eval bleu for test set:  41%|████      | 36/88 [05:23<08:28,  9.77s/it]Eval bleu for test set:  42%|████▏     | 37/88 [05:34<08:22,  9.86s/it]Eval bleu for test set:  43%|████▎     | 38/88 [05:44<08:25, 10.10s/it]Eval bleu for test set:  44%|████▍     | 39/88 [05:54<08:10, 10.01s/it]Eval bleu for test set:  45%|████▌     | 40/88 [06:04<07:57,  9.95s/it]Eval bleu for test set:  47%|████▋     | 41/88 [06:14<07:53, 10.07s/it]Eval bleu for test set:  48%|████▊     | 42/88 [06:23<07:25,  9.68s/it]Eval bleu for test set:  49%|████▉     | 43/88 [06:32<07:05,  9.46s/it]Eval bleu for test set:  50%|█████     | 44/88 [06:41<06:46,  9.23s/it]Eval bleu for test set:  51%|█████     | 45/88 [06:49<06:32,  9.12s/it]Eval bleu for test set:  52%|█████▏    | 46/88 [06:58<06:19,  9.04s/it]Eval bleu for test set:  53%|█████▎    | 47/88 [07:08<06:14,  9.13s/it]Eval bleu for test set:  55%|█████▍    | 48/88 [07:16<06:02,  9.06s/it]Eval bleu for test set:  56%|█████▌    | 49/88 [07:25<05:51,  9.02s/it]Eval bleu for test set:  57%|█████▋    | 50/88 [07:34<05:37,  8.87s/it]Eval bleu for test set:  58%|█████▊    | 51/88 [07:43<05:29,  8.91s/it]Eval bleu for test set:  59%|█████▉    | 52/88 [07:52<05:19,  8.88s/it]Eval bleu for test set:  60%|██████    | 53/88 [08:00<05:08,  8.81s/it]Eval bleu for test set:  61%|██████▏   | 54/88 [08:09<04:57,  8.75s/it]Eval bleu for test set:  62%|██████▎   | 55/88 [08:18<04:48,  8.73s/it]Eval bleu for test set:  64%|██████▎   | 56/88 [08:26<04:38,  8.69s/it]Eval bleu for test set:  65%|██████▍   | 57/88 [08:35<04:29,  8.70s/it]Eval bleu for test set:  66%|██████▌   | 58/88 [08:44<04:21,  8.71s/it]Eval bleu for test set:  67%|██████▋   | 59/88 [08:53<04:14,  8.77s/it]Eval bleu for test set:  68%|██████▊   | 60/88 [09:03<04:15,  9.12s/it]Eval bleu for test set:  69%|██████▉   | 61/88 [09:12<04:05,  9.08s/it]Eval bleu for test set:  70%|███████   | 62/88 [09:20<03:53,  8.97s/it]Eval bleu for test set:  72%|███████▏  | 63/88 [09:29<03:41,  8.85s/it]Eval bleu for test set:  73%|███████▎  | 64/88 [09:38<03:30,  8.78s/it]Eval bleu for test set:  74%|███████▍  | 65/88 [09:46<03:23,  8.84s/it]Eval bleu for test set:  75%|███████▌  | 66/88 [09:56<03:16,  8.95s/it]Eval bleu for test set:  76%|███████▌  | 67/88 [10:05<03:07,  8.93s/it]Eval bleu for test set:  77%|███████▋  | 68/88 [10:13<02:58,  8.91s/it]Eval bleu for test set:  78%|███████▊  | 69/88 [10:23<02:55,  9.25s/it]Eval bleu for test set:  80%|███████▉  | 70/88 [10:33<02:47,  9.29s/it]Eval bleu for test set:  81%|████████  | 71/88 [10:42<02:36,  9.19s/it]Eval bleu for test set:  82%|████████▏ | 72/88 [10:51<02:25,  9.11s/it]Eval bleu for test set:  83%|████████▎ | 73/88 [11:00<02:15,  9.03s/it]Eval bleu for test set:  84%|████████▍ | 74/88 [11:08<02:05,  8.98s/it]Eval bleu for test set:  85%|████████▌ | 75/88 [11:17<01:56,  8.97s/it]Eval bleu for test set:  86%|████████▋ | 76/88 [11:27<01:49,  9.14s/it]Eval bleu for test set:  88%|████████▊ | 77/88 [11:36<01:41,  9.18s/it]Eval bleu for test set:  89%|████████▊ | 78/88 [11:45<01:30,  9.08s/it]Eval bleu for test set:  90%|████████▉ | 79/88 [11:54<01:21,  9.03s/it]Eval bleu for test set:  91%|█████████ | 80/88 [12:03<01:11,  8.89s/it]Eval bleu for test set:  92%|█████████▏| 81/88 [12:12<01:03,  9.01s/it]Eval bleu for test set:  93%|█████████▎| 82/88 [12:21<00:54,  9.11s/it]Eval bleu for test set:  94%|█████████▍| 83/88 [12:30<00:45,  9.01s/it]Eval bleu for test set:  95%|█████████▌| 84/88 [12:39<00:35,  8.98s/it]Eval bleu for test set:  97%|█████████▋| 85/88 [12:48<00:26,  8.93s/it]Eval bleu for test set:  98%|█████████▊| 86/88 [12:56<00:17,  8.86s/it]Eval bleu for test set:  99%|█████████▉| 87/88 [13:05<00:08,  8.85s/it]Eval bleu for test set: 100%|██████████| 88/88 [13:11<00:00,  7.97s/it]Eval bleu for test set: 100%|██████████| 88/88 [13:11<00:00,  9.00s/it]
11/13/2022 01:34:28 - INFO - __main__ -   ***** Eval results *****
11/13/2022 01:34:28 - INFO - __main__ -     bleu = 78.26
11/13/2022 01:34:28 - INFO - __main__ -     codebleu = 79.3256
11/13/2022 01:34:28 - INFO - __main__ -     em = 21.3802
11/13/2022 01:34:28 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typeinsert_log_statement + whether_refactoringbefore_refactoring :
11/13/2022 01:34:28 - INFO - __main__ -   [best-bleu] bleu-4: 78.26, em: 21.3802, codebleu: 79.3256

11/13/2022 01:34:28 - INFO - __main__ -   Finish and take 1h15m
11/13/2022 01:34:28 - INFO - __main__ -     ***** Testing *****
11/13/2022 01:34:28 - INFO - __main__ -     Batch size = 64
11/13/2022 01:34:28 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 01:34:29 - INFO - __main__ -   test11111111111
11/13/2022 01:34:29 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 01:34:29 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/insert_log_statement/after_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/insert_log_statement/after_refactoring/small/test.buggy-fixed.fixed
11/13/2022 01:34:29 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 01:34:29 - INFO - utils -   Read 5608 examples, avg src len: 32, avg trg len: 29, max src len: 82, max trg len: 117
11/13/2022 01:34:29 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/test_src_all.pt
11/13/2022 01:34:29 - INFO - utils -   加载前test666666666666666
ngram match: 0.7825803372059982, weighted ngram match: 0.79174344811623, syntax_match: 0.8088016526012254, dataflow_match: 0.789897681647455
  0%|          | 0/5608 [00:00<?, ?it/s] 50%|█████     | 2804/5608 [00:01<00:01, 1575.01it/s] 75%|███████▌  | 4206/5608 [00:03<00:01, 1217.77it/s]100%|██████████| 5608/5608 [00:04<00:00, 1093.73it/s]100%|██████████| 5608/5608 [00:04<00:00, 1168.58it/s]
11/13/2022 01:34:35 - INFO - utils -   加载后test77777777777777
11/13/2022 01:34:35 - INFO - __main__ -   加载成功test2222222222
11/13/2022 01:34:35 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 01:34:35 - INFO - __main__ -     Num examples = 5608
11/13/2022 01:34:35 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/88 [00:00<?, ?it/s]Eval bleu for test set:   1%|          | 1/88 [00:09<13:31,  9.33s/it]Eval bleu for test set:   2%|▏         | 2/88 [00:18<12:52,  8.98s/it]Eval bleu for test set:   3%|▎         | 3/88 [00:27<12:44,  9.00s/it]Eval bleu for test set:   5%|▍         | 4/88 [00:36<12:52,  9.20s/it]Eval bleu for test set:   6%|▌         | 5/88 [00:45<12:35,  9.11s/it]Eval bleu for test set:   7%|▋         | 6/88 [00:54<12:19,  9.02s/it]Eval bleu for test set:   8%|▊         | 7/88 [01:03<12:05,  8.96s/it]Eval bleu for test set:   9%|▉         | 8/88 [01:12<11:56,  8.95s/it]Eval bleu for test set:  10%|█         | 9/88 [01:21<11:46,  8.94s/it]Eval bleu for test set:  11%|█▏        | 10/88 [01:30<11:40,  8.98s/it]Eval bleu for test set:  12%|█▎        | 11/88 [01:38<11:25,  8.90s/it]Eval bleu for test set:  14%|█▎        | 12/88 [01:47<11:10,  8.82s/it]Eval bleu for test set:  15%|█▍        | 13/88 [01:56<11:01,  8.82s/it]Eval bleu for test set:  16%|█▌        | 14/88 [02:05<10:55,  8.86s/it]Eval bleu for test set:  17%|█▋        | 15/88 [02:14<10:55,  8.97s/it]Eval bleu for test set:  18%|█▊        | 16/88 [02:23<10:45,  8.96s/it]Eval bleu for test set:  19%|█▉        | 17/88 [02:32<10:29,  8.87s/it]Eval bleu for test set:  20%|██        | 18/88 [02:41<10:22,  8.89s/it]Eval bleu for test set:  22%|██▏       | 19/88 [02:49<10:14,  8.90s/it]Eval bleu for test set:  23%|██▎       | 20/88 [02:59<10:08,  8.95s/it]Eval bleu for test set:  24%|██▍       | 21/88 [03:07<09:53,  8.86s/it]Eval bleu for test set:  25%|██▌       | 22/88 [03:16<09:44,  8.86s/it]Eval bleu for test set:  26%|██▌       | 23/88 [03:25<09:35,  8.86s/it]Eval bleu for test set:  27%|██▋       | 24/88 [03:34<09:23,  8.81s/it]Eval bleu for test set:  28%|██▊       | 25/88 [03:42<09:17,  8.84s/it]Eval bleu for test set:  30%|██▉       | 26/88 [03:51<09:10,  8.87s/it]Eval bleu for test set:  31%|███       | 27/88 [04:01<09:06,  8.95s/it]Eval bleu for test set:  32%|███▏      | 28/88 [04:10<09:06,  9.11s/it]Eval bleu for test set:  33%|███▎      | 29/88 [04:19<09:01,  9.18s/it]Eval bleu for test set:  34%|███▍      | 30/88 [04:28<08:44,  9.05s/it]Eval bleu for test set:  35%|███▌      | 31/88 [04:37<08:33,  9.00s/it]Eval bleu for test set:  36%|███▋      | 32/88 [04:46<08:27,  9.06s/it]Eval bleu for test set:  38%|███▊      | 33/88 [04:55<08:18,  9.06s/it]Eval bleu for test set:  39%|███▊      | 34/88 [05:04<08:09,  9.06s/it]Eval bleu for test set:  40%|███▉      | 35/88 [05:13<07:55,  8.97s/it]Eval bleu for test set:  41%|████      | 36/88 [05:22<07:44,  8.93s/it]Eval bleu for test set:  42%|████▏     | 37/88 [05:32<07:45,  9.13s/it]Eval bleu for test set:  43%|████▎     | 38/88 [05:41<07:38,  9.17s/it]Eval bleu for test set:  44%|████▍     | 39/88 [05:50<07:23,  9.06s/it]Eval bleu for test set:  45%|████▌     | 40/88 [05:58<07:10,  8.97s/it]Eval bleu for test set:  47%|████▋     | 41/88 [06:08<07:07,  9.09s/it]Eval bleu for test set:  48%|████▊     | 42/88 [06:17<06:59,  9.12s/it]Eval bleu for test set:  49%|████▉     | 43/88 [06:26<06:45,  9.00s/it]Eval bleu for test set:  50%|█████     | 44/88 [06:35<06:35,  8.99s/it]Eval bleu for test set:  51%|█████     | 45/88 [06:44<06:26,  9.00s/it]Eval bleu for test set:  52%|█████▏    | 46/88 [06:52<06:15,  8.94s/it]Eval bleu for test set:  53%|█████▎    | 47/88 [07:01<06:06,  8.93s/it]Eval bleu for test set:  55%|█████▍    | 48/88 [07:11<06:02,  9.07s/it]Eval bleu for test set:  56%|█████▌    | 49/88 [07:20<05:54,  9.08s/it]Eval bleu for test set:  57%|█████▋    | 50/88 [07:28<05:39,  8.93s/it]Eval bleu for test set:  58%|█████▊    | 51/88 [07:38<05:33,  9.01s/it]Eval bleu for test set:  59%|█████▉    | 52/88 [07:47<05:22,  8.97s/it]Eval bleu for test set:  60%|██████    | 53/88 [07:55<05:11,  8.91s/it]Eval bleu for test set:  61%|██████▏   | 54/88 [08:04<05:03,  8.93s/it]Eval bleu for test set:  62%|██████▎   | 55/88 [08:14<04:58,  9.06s/it]Eval bleu for test set:  64%|██████▎   | 56/88 [08:23<04:50,  9.08s/it]Eval bleu for test set:  65%|██████▍   | 57/88 [08:32<04:40,  9.06s/it]Eval bleu for test set:  66%|██████▌   | 58/88 [08:41<04:30,  9.03s/it]Eval bleu for test set:  67%|██████▋   | 59/88 [08:50<04:20,  8.97s/it]Eval bleu for test set:  68%|██████▊   | 60/88 [08:58<04:10,  8.95s/it]Eval bleu for test set:  69%|██████▉   | 61/88 [09:07<04:01,  8.96s/it]Eval bleu for test set:  70%|███████   | 62/88 [09:16<03:52,  8.96s/it]Eval bleu for test set:  72%|███████▏  | 63/88 [09:25<03:42,  8.90s/it]Eval bleu for test set:  73%|███████▎  | 64/88 [09:34<03:33,  8.88s/it]Eval bleu for test set:  74%|███████▍  | 65/88 [09:43<03:24,  8.89s/it]Eval bleu for test set:  75%|███████▌  | 66/88 [09:52<03:16,  8.94s/it]Eval bleu for test set:  76%|███████▌  | 67/88 [10:01<03:09,  9.02s/it]Eval bleu for test set:  77%|███████▋  | 68/88 [10:10<03:00,  9.01s/it]Eval bleu for test set:  78%|███████▊  | 69/88 [10:19<02:51,  9.03s/it]Eval bleu for test set:  80%|███████▉  | 70/88 [10:28<02:43,  9.09s/it]Eval bleu for test set:  81%|████████  | 71/88 [10:38<02:35,  9.14s/it]Eval bleu for test set:  82%|████████▏ | 72/88 [10:47<02:26,  9.13s/it]Eval bleu for test set:  83%|████████▎ | 73/88 [10:56<02:14,  8.99s/it]Eval bleu for test set:  84%|████████▍ | 74/88 [11:04<02:05,  8.94s/it]Eval bleu for test set:  85%|████████▌ | 75/88 [11:13<01:56,  8.92s/it]Eval bleu for test set:  86%|████████▋ | 76/88 [11:22<01:45,  8.82s/it]Eval bleu for test set:  88%|████████▊ | 77/88 [11:31<01:37,  8.87s/it]Eval bleu for test set:  89%|████████▊ | 78/88 [11:40<01:28,  8.89s/it]Eval bleu for test set:  90%|████████▉ | 79/88 [11:49<01:20,  8.98s/it]Eval bleu for test set:  91%|█████████ | 80/88 [11:59<01:13,  9.22s/it]Eval bleu for test set:  92%|█████████▏| 81/88 [12:08<01:03,  9.14s/it]Eval bleu for test set:  93%|█████████▎| 82/88 [12:17<00:55,  9.18s/it]Eval bleu for test set:  94%|█████████▍| 83/88 [12:26<00:45,  9.07s/it]Eval bleu for test set:  95%|█████████▌| 84/88 [12:35<00:36,  9.08s/it]Eval bleu for test set:  97%|█████████▋| 85/88 [12:44<00:27,  9.04s/it]Eval bleu for test set:  98%|█████████▊| 86/88 [12:53<00:18,  9.10s/it]Eval bleu for test set:  99%|█████████▉| 87/88 [13:02<00:09,  9.07s/it]Eval bleu for test set: 100%|██████████| 88/88 [13:08<00:00,  8.16s/it]Eval bleu for test set: 100%|██████████| 88/88 [13:08<00:00,  8.96s/it]
11/13/2022 01:51:49 - INFO - __main__ -   ***** Eval results *****
11/13/2022 01:51:49 - INFO - __main__ -     bleu = 59.88
11/13/2022 01:51:49 - INFO - __main__ -     codebleu = 68.6531
11/13/2022 01:51:49 - INFO - __main__ -     em = 0.0535
11/13/2022 01:51:49 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typeinsert_log_statement + whether_refactoringafter_refactoring :
11/13/2022 01:51:49 - INFO - __main__ -   [best-bleu] bleu-4: 59.88, em: 0.0535, codebleu: 68.6531

11/13/2022 01:51:49 - INFO - __main__ -   Finish and take 1h32m
11/13/2022 01:51:49 - INFO - __main__ -     ***** Testing *****
11/13/2022 01:51:49 - INFO - __main__ -     Batch size = 64
11/13/2022 01:51:49 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 01:51:50 - INFO - __main__ -   test11111111111
11/13/2022 01:51:50 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 01:51:50 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/insert_try_catch/before_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/insert_try_catch/before_refactoring/small/test.buggy-fixed.fixed
11/13/2022 01:51:50 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 01:51:50 - INFO - utils -   Read 3321 examples, avg src len: 34, avg trg len: 32, max src len: 93, max trg len: 93
11/13/2022 01:51:50 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/test_src_all.pt
11/13/2022 01:51:50 - INFO - utils -   加载前test666666666666666
ngram match: 0.5987572658225918, weighted ngram match: 0.607963360671916, syntax_match: 0.7266943224534982, dataflow_match: 0.8127077571113197
  0%|          | 0/3321 [00:00<?, ?it/s] 50%|█████     | 1662/3321 [00:01<00:01, 1495.70it/s] 75%|███████▌  | 2493/3321 [00:02<00:00, 1166.03it/s]100%|██████████| 3321/3321 [00:02<00:00, 1623.97it/s]
11/13/2022 01:51:53 - INFO - utils -   加载后test77777777777777
11/13/2022 01:51:54 - INFO - __main__ -   加载成功test2222222222
11/13/2022 01:51:54 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 01:51:54 - INFO - __main__ -     Num examples = 3321
11/13/2022 01:51:54 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/52 [00:00<?, ?it/s]Eval bleu for test set:   2%|▏         | 1/52 [00:10<08:44, 10.28s/it]Eval bleu for test set:   4%|▍         | 2/52 [00:19<07:54,  9.48s/it]Eval bleu for test set:   6%|▌         | 3/52 [00:27<07:28,  9.16s/it]Eval bleu for test set:   8%|▊         | 4/52 [00:37<07:17,  9.11s/it]Eval bleu for test set:  10%|▉         | 5/52 [00:46<07:09,  9.14s/it]Eval bleu for test set:  12%|█▏        | 6/52 [00:55<06:57,  9.08s/it]Eval bleu for test set:  13%|█▎        | 7/52 [01:03<06:42,  8.94s/it]Eval bleu for test set:  15%|█▌        | 8/52 [01:12<06:34,  8.97s/it]Eval bleu for test set:  17%|█▋        | 9/52 [01:21<06:27,  9.00s/it]Eval bleu for test set:  19%|█▉        | 10/52 [01:30<06:16,  8.97s/it]Eval bleu for test set:  21%|██        | 11/52 [01:39<06:07,  8.95s/it]Eval bleu for test set:  23%|██▎       | 12/52 [01:48<05:59,  9.00s/it]Eval bleu for test set:  25%|██▌       | 13/52 [01:57<05:48,  8.94s/it]Eval bleu for test set:  27%|██▋       | 14/52 [02:06<05:36,  8.86s/it]Eval bleu for test set:  29%|██▉       | 15/52 [02:15<05:29,  8.91s/it]Eval bleu for test set:  31%|███       | 16/52 [02:24<05:23,  8.99s/it]Eval bleu for test set:  33%|███▎      | 17/52 [02:33<05:15,  9.01s/it]Eval bleu for test set:  35%|███▍      | 18/52 [02:42<05:05,  8.98s/it]Eval bleu for test set:  37%|███▋      | 19/52 [02:51<04:56,  9.00s/it]Eval bleu for test set:  38%|███▊      | 20/52 [03:00<04:49,  9.04s/it]Eval bleu for test set:  40%|████      | 21/52 [03:09<04:39,  9.03s/it]Eval bleu for test set:  42%|████▏     | 22/52 [03:19<04:35,  9.20s/it]Eval bleu for test set:  44%|████▍     | 23/52 [03:28<04:26,  9.19s/it]Eval bleu for test set:  46%|████▌     | 24/52 [03:37<04:16,  9.15s/it]Eval bleu for test set:  48%|████▊     | 25/52 [03:48<04:18,  9.58s/it]Eval bleu for test set:  50%|█████     | 26/52 [03:58<04:12,  9.72s/it]Eval bleu for test set:  52%|█████▏    | 27/52 [04:07<03:57,  9.50s/it]Eval bleu for test set:  54%|█████▍    | 28/52 [04:16<03:46,  9.46s/it]Eval bleu for test set:  56%|█████▌    | 29/52 [04:26<03:42,  9.66s/it]Eval bleu for test set:  58%|█████▊    | 30/52 [04:37<03:37,  9.89s/it]Eval bleu for test set:  60%|█████▉    | 31/52 [04:47<03:29,  9.98s/it]Eval bleu for test set:  62%|██████▏   | 32/52 [04:57<03:19,  9.98s/it]Eval bleu for test set:  63%|██████▎   | 33/52 [05:06<03:04,  9.68s/it]Eval bleu for test set:  65%|██████▌   | 34/52 [05:14<02:49,  9.40s/it]Eval bleu for test set:  67%|██████▋   | 35/52 [05:23<02:36,  9.23s/it]Eval bleu for test set:  69%|██████▉   | 36/52 [05:32<02:27,  9.22s/it]Eval bleu for test set:  71%|███████   | 37/52 [05:41<02:17,  9.14s/it]Eval bleu for test set:  73%|███████▎  | 38/52 [05:50<02:07,  9.10s/it]Eval bleu for test set:  75%|███████▌  | 39/52 [05:59<01:57,  9.07s/it]Eval bleu for test set:  77%|███████▋  | 40/52 [06:08<01:48,  9.05s/it]Eval bleu for test set:  79%|███████▉  | 41/52 [06:17<01:39,  9.04s/it]Eval bleu for test set:  81%|████████  | 42/52 [06:27<01:30,  9.10s/it]Eval bleu for test set:  83%|████████▎ | 43/52 [06:36<01:22,  9.21s/it]Eval bleu for test set:  85%|████████▍ | 44/52 [06:46<01:15,  9.38s/it]Eval bleu for test set:  87%|████████▋ | 45/52 [06:55<01:05,  9.37s/it]Eval bleu for test set:  88%|████████▊ | 46/52 [07:04<00:55,  9.30s/it]Eval bleu for test set:  90%|█████████ | 47/52 [07:13<00:45,  9.19s/it]Eval bleu for test set:  92%|█████████▏| 48/52 [07:22<00:36,  9.11s/it]Eval bleu for test set:  94%|█████████▍| 49/52 [07:31<00:27,  9.04s/it]Eval bleu for test set:  96%|█████████▌| 50/52 [07:40<00:18,  9.05s/it]Eval bleu for test set:  98%|█████████▊| 51/52 [07:49<00:09,  9.02s/it]Eval bleu for test set: 100%|██████████| 52/52 [07:58<00:00,  9.05s/it]Eval bleu for test set: 100%|██████████| 52/52 [07:58<00:00,  9.21s/it]
11/13/2022 02:02:16 - INFO - __main__ -   ***** Eval results *****
11/13/2022 02:02:16 - INFO - __main__ -     bleu = 79.31
11/13/2022 02:02:16 - INFO - __main__ -     codebleu = 79.5422
11/13/2022 02:02:16 - INFO - __main__ -     em = 19.6929
11/13/2022 02:02:16 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typeinsert_try_catch + whether_refactoringbefore_refactoring :
11/13/2022 02:02:16 - INFO - __main__ -   [best-bleu] bleu-4: 79.31, em: 19.6929, codebleu: 79.5422

11/13/2022 02:02:16 - INFO - __main__ -   Finish and take 1h43m
11/13/2022 02:02:16 - INFO - __main__ -     ***** Testing *****
11/13/2022 02:02:16 - INFO - __main__ -     Batch size = 64
11/13/2022 02:02:16 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 02:02:16 - INFO - __main__ -   test11111111111
11/13/2022 02:02:16 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 02:02:16 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/insert_try_catch/after_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/insert_try_catch/after_refactoring/small/test.buggy-fixed.fixed
11/13/2022 02:02:16 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 02:02:16 - INFO - utils -   Read 3321 examples, avg src len: 41, avg trg len: 40, max src len: 85, max trg len: 85
11/13/2022 02:02:16 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/test_src_all.pt
11/13/2022 02:02:16 - INFO - utils -   加载前test666666666666666
ngram match: 0.7931226968755773, weighted ngram match: 0.795647765477037, syntax_match: 0.8072886917761426, dataflow_match: 0.7856272838002436
  0%|          | 0/3321 [00:00<?, ?it/s] 50%|█████     | 1662/3321 [00:01<00:01, 1374.80it/s] 75%|███████▌  | 2493/3321 [00:02<00:00, 1073.64it/s]100%|██████████| 3321/3321 [00:02<00:00, 1495.02it/s]
11/13/2022 02:02:20 - INFO - utils -   加载后test77777777777777
11/13/2022 02:02:20 - INFO - __main__ -   加载成功test2222222222
11/13/2022 02:02:20 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 02:02:20 - INFO - __main__ -     Num examples = 3321
11/13/2022 02:02:20 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/52 [00:00<?, ?it/s]Eval bleu for test set:   2%|▏         | 1/52 [00:09<08:18,  9.77s/it]Eval bleu for test set:   4%|▍         | 2/52 [00:19<07:56,  9.53s/it]Eval bleu for test set:   6%|▌         | 3/52 [00:28<07:40,  9.41s/it]Eval bleu for test set:   8%|▊         | 4/52 [00:38<07:39,  9.57s/it]Eval bleu for test set:  10%|▉         | 5/52 [00:48<07:40,  9.80s/it]Eval bleu for test set:  12%|█▏        | 6/52 [00:58<07:28,  9.76s/it]Eval bleu for test set:  13%|█▎        | 7/52 [01:08<07:28,  9.97s/it]Eval bleu for test set:  15%|█▌        | 8/52 [01:19<07:30, 10.25s/it]Eval bleu for test set:  17%|█▋        | 9/52 [01:30<07:26, 10.38s/it]Eval bleu for test set:  19%|█▉        | 10/52 [01:40<07:20, 10.48s/it]Eval bleu for test set:  21%|██        | 11/52 [01:51<07:15, 10.61s/it]Eval bleu for test set:  23%|██▎       | 12/52 [02:02<07:05, 10.64s/it]Eval bleu for test set:  25%|██▌       | 13/52 [02:13<06:55, 10.65s/it]Eval bleu for test set:  27%|██▋       | 14/52 [02:23<06:43, 10.62s/it]Eval bleu for test set:  29%|██▉       | 15/52 [02:34<06:34, 10.66s/it]Eval bleu for test set:  31%|███       | 16/52 [02:44<06:22, 10.63s/it]Eval bleu for test set:  33%|███▎      | 17/52 [02:54<06:03, 10.40s/it]Eval bleu for test set:  35%|███▍      | 18/52 [03:04<05:44, 10.14s/it]Eval bleu for test set:  37%|███▋      | 19/52 [03:13<05:27,  9.92s/it]Eval bleu for test set:  38%|███▊      | 20/52 [03:23<05:16,  9.89s/it]Eval bleu for test set:  40%|████      | 21/52 [03:32<05:00,  9.69s/it]Eval bleu for test set:  42%|████▏     | 22/52 [03:42<04:50,  9.69s/it]Eval bleu for test set:  44%|████▍     | 23/52 [03:51<04:39,  9.64s/it]Eval bleu for test set:  46%|████▌     | 24/52 [04:01<04:28,  9.58s/it]Eval bleu for test set:  48%|████▊     | 25/52 [04:11<04:19,  9.62s/it]Eval bleu for test set:  50%|█████     | 26/52 [04:20<04:08,  9.57s/it]Eval bleu for test set:  52%|█████▏    | 27/52 [04:29<03:56,  9.46s/it]Eval bleu for test set:  54%|█████▍    | 28/52 [04:39<03:49,  9.57s/it]Eval bleu for test set:  56%|█████▌    | 29/52 [04:49<03:40,  9.58s/it]Eval bleu for test set:  58%|█████▊    | 30/52 [04:58<03:31,  9.62s/it]Eval bleu for test set:  60%|█████▉    | 31/52 [05:08<03:20,  9.53s/it]Eval bleu for test set:  62%|██████▏   | 32/52 [05:17<03:10,  9.50s/it]Eval bleu for test set:  63%|██████▎   | 33/52 [05:26<02:59,  9.44s/it]Eval bleu for test set:  65%|██████▌   | 34/52 [05:36<02:50,  9.46s/it]Eval bleu for test set:  67%|██████▋   | 35/52 [05:45<02:40,  9.42s/it]Eval bleu for test set:  69%|██████▉   | 36/52 [05:55<02:30,  9.42s/it]Eval bleu for test set:  71%|███████   | 37/52 [06:04<02:21,  9.40s/it]Eval bleu for test set:  73%|███████▎  | 38/52 [06:13<02:11,  9.39s/it]Eval bleu for test set:  75%|███████▌  | 39/52 [06:23<02:01,  9.34s/it]Eval bleu for test set:  77%|███████▋  | 40/52 [06:32<01:52,  9.37s/it]Eval bleu for test set:  79%|███████▉  | 41/52 [06:41<01:42,  9.35s/it]Eval bleu for test set:  81%|████████  | 42/52 [06:51<01:34,  9.41s/it]Eval bleu for test set:  83%|████████▎ | 43/52 [07:00<01:24,  9.41s/it]Eval bleu for test set:  85%|████████▍ | 44/52 [07:10<01:15,  9.45s/it]Eval bleu for test set:  87%|████████▋ | 45/52 [07:19<01:06,  9.48s/it]Eval bleu for test set:  88%|████████▊ | 46/52 [07:29<00:56,  9.43s/it]Eval bleu for test set:  90%|█████████ | 47/52 [07:38<00:47,  9.42s/it]Eval bleu for test set:  92%|█████████▏| 48/52 [07:47<00:37,  9.36s/it]Eval bleu for test set:  94%|█████████▍| 49/52 [07:57<00:27,  9.33s/it]Eval bleu for test set:  96%|█████████▌| 50/52 [08:06<00:18,  9.47s/it]Eval bleu for test set:  98%|█████████▊| 51/52 [08:16<00:09,  9.45s/it]Eval bleu for test set: 100%|██████████| 52/52 [08:25<00:00,  9.24s/it]Eval bleu for test set: 100%|██████████| 52/52 [08:25<00:00,  9.72s/it]
11/13/2022 02:13:18 - INFO - __main__ -   ***** Eval results *****
11/13/2022 02:13:18 - INFO - __main__ -     bleu = 62.31
11/13/2022 02:13:18 - INFO - __main__ -     codebleu = 67.2625
11/13/2022 02:13:18 - INFO - __main__ -     em = 2.0777
11/13/2022 02:13:18 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typeinsert_try_catch + whether_refactoringafter_refactoring :
11/13/2022 02:13:18 - INFO - __main__ -   [best-bleu] bleu-4: 62.31, em: 2.0777, codebleu: 67.2625

11/13/2022 02:13:18 - INFO - __main__ -   Finish and take 1h54m
11/13/2022 02:13:18 - INFO - __main__ -     ***** Testing *****
11/13/2022 02:13:18 - INFO - __main__ -     Batch size = 64
11/13/2022 02:13:18 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 02:13:18 - INFO - __main__ -   test11111111111
11/13/2022 02:13:18 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 02:13:18 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/loop_exchange/before_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/loop_exchange/before_refactoring/small/test.buggy-fixed.fixed
11/13/2022 02:13:18 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 02:13:18 - INFO - utils -   Read 65 examples, avg src len: 40, avg trg len: 39, max src len: 52, max trg len: 52
11/13/2022 02:13:18 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/test_src_all.pt
11/13/2022 02:13:18 - INFO - utils -   加载前test666666666666666
ngram match: 0.6230888392770125, weighted ngram match: 0.6297593209074882, syntax_match: 0.7221121058908504, dataflow_match: 0.7155380707515023
  0%|          | 0/65 [00:00<?, ?it/s] 52%|█████▏    | 34/65 [00:00<00:00, 198.21it/s]100%|██████████| 65/65 [00:00<00:00, 273.85it/s]
11/13/2022 02:13:19 - INFO - utils -   加载后test77777777777777
11/13/2022 02:13:19 - INFO - __main__ -   加载成功test2222222222
11/13/2022 02:13:19 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 02:13:19 - INFO - __main__ -     Num examples = 65
11/13/2022 02:13:19 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/2 [00:00<?, ?it/s]Eval bleu for test set:  50%|█████     | 1/2 [00:08<00:08,  8.79s/it]Eval bleu for test set: 100%|██████████| 2/2 [00:10<00:00,  4.38s/it]Eval bleu for test set: 100%|██████████| 2/2 [00:10<00:00,  5.08s/it]
11/13/2022 02:13:31 - INFO - __main__ -   ***** Eval results *****
11/13/2022 02:13:31 - INFO - __main__ -     bleu = 82.5
11/13/2022 02:13:31 - INFO - __main__ -     codebleu = 82.8027
11/13/2022 02:13:31 - INFO - __main__ -     em = 12.3077
11/13/2022 02:13:31 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typeloop_exchange + whether_refactoringbefore_refactoring :
11/13/2022 02:13:31 - INFO - __main__ -   [best-bleu] bleu-4: 82.50, em: 12.3077, codebleu: 82.8027

11/13/2022 02:13:31 - INFO - __main__ -   Finish and take 1h54m
11/13/2022 02:13:31 - INFO - __main__ -     ***** Testing *****
11/13/2022 02:13:31 - INFO - __main__ -     Batch size = 64
11/13/2022 02:13:31 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 02:13:31 - INFO - __main__ -   test11111111111
11/13/2022 02:13:31 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 02:13:31 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/loop_exchange/after_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/loop_exchange/after_refactoring/small/test.buggy-fixed.fixed
11/13/2022 02:13:31 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 02:13:31 - INFO - utils -   Read 65 examples, avg src len: 35, avg trg len: 34, max src len: 45, max trg len: 46
11/13/2022 02:13:31 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/test_src_all.pt
11/13/2022 02:13:31 - INFO - utils -   加载前test666666666666666
ngram match: 0.8249017700377937, weighted ngram match: 0.8262788814118766, syntax_match: 0.8158192090395481, dataflow_match: 0.845108695652174
  0%|          | 0/65 [00:00<?, ?it/s] 52%|█████▏    | 34/65 [00:00<00:00, 199.82it/s]100%|██████████| 65/65 [00:00<00:00, 274.45it/s]
11/13/2022 02:13:32 - INFO - utils -   加载后test77777777777777
11/13/2022 02:13:32 - INFO - __main__ -   加载成功test2222222222
11/13/2022 02:13:32 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 02:13:32 - INFO - __main__ -     Num examples = 65
11/13/2022 02:13:32 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/2 [00:00<?, ?it/s]Eval bleu for test set:  50%|█████     | 1/2 [00:07<00:07,  7.76s/it]Eval bleu for test set: 100%|██████████| 2/2 [00:08<00:00,  3.66s/it]Eval bleu for test set: 100%|██████████| 2/2 [00:08<00:00,  4.32s/it]
11/13/2022 02:13:43 - INFO - __main__ -   ***** Eval results *****
11/13/2022 02:13:43 - INFO - __main__ -     bleu = 64.38
11/13/2022 02:13:43 - INFO - __main__ -     codebleu = 74.8249
11/13/2022 02:13:43 - INFO - __main__ -     em = 0.0
11/13/2022 02:13:43 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typeloop_exchange + whether_refactoringafter_refactoring :
11/13/2022 02:13:43 - INFO - __main__ -   [best-bleu] bleu-4: 64.38, em: 0.0000, codebleu: 74.8249

11/13/2022 02:13:43 - INFO - __main__ -   Finish and take 1h54m
11/13/2022 02:13:43 - INFO - __main__ -     ***** Testing *****
11/13/2022 02:13:43 - INFO - __main__ -     Batch size = 64
11/13/2022 02:13:43 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 02:13:43 - INFO - __main__ -   test11111111111
11/13/2022 02:13:43 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 02:13:43 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/reorder_condition/before_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/reorder_condition/before_refactoring/small/test.buggy-fixed.fixed
11/13/2022 02:13:43 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 02:13:43 - INFO - utils -   Read 1125 examples, avg src len: 37, avg trg len: 36, max src len: 93, max trg len: 129
11/13/2022 02:13:43 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/test_src_all.pt
11/13/2022 02:13:43 - INFO - utils -   加载前test666666666666666
ngram match: 0.6436468423100808, weighted ngram match: 0.6748144451530369, syntax_match: 0.8121636167922497, dataflow_match: 0.862371888726208
  0%|          | 0/1125 [00:00<?, ?it/s] 50%|█████     | 564/1125 [00:00<00:00, 1125.90it/s] 75%|███████▌  | 846/1125 [00:00<00:00, 958.23it/s] 100%|██████████| 1125/1125 [00:00<00:00, 1312.14it/s]
11/13/2022 02:13:45 - INFO - utils -   加载后test77777777777777
11/13/2022 02:13:45 - INFO - __main__ -   加载成功test2222222222
11/13/2022 02:13:45 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 02:13:45 - INFO - __main__ -     Num examples = 1125
11/13/2022 02:13:45 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/18 [00:00<?, ?it/s]Eval bleu for test set:   6%|▌         | 1/18 [00:08<02:29,  8.80s/it]Eval bleu for test set:  11%|█         | 2/18 [00:17<02:18,  8.64s/it]Eval bleu for test set:  17%|█▋        | 3/18 [00:25<02:08,  8.56s/it]Eval bleu for test set:  22%|██▏       | 4/18 [00:34<02:01,  8.68s/it]Eval bleu for test set:  28%|██▊       | 5/18 [00:43<01:51,  8.60s/it]Eval bleu for test set:  33%|███▎      | 6/18 [00:51<01:43,  8.64s/it]Eval bleu for test set:  39%|███▉      | 7/18 [01:00<01:35,  8.68s/it]Eval bleu for test set:  44%|████▍     | 8/18 [01:10<01:29,  8.98s/it]Eval bleu for test set:  50%|█████     | 9/18 [01:20<01:24,  9.37s/it]Eval bleu for test set:  56%|█████▌    | 10/18 [01:30<01:17,  9.66s/it]Eval bleu for test set:  61%|██████    | 11/18 [01:40<01:08,  9.72s/it]Eval bleu for test set:  67%|██████▋   | 12/18 [01:50<00:58,  9.74s/it]Eval bleu for test set:  72%|███████▏  | 13/18 [01:59<00:47,  9.48s/it]Eval bleu for test set:  78%|███████▊  | 14/18 [02:08<00:37,  9.28s/it]Eval bleu for test set:  83%|████████▎ | 15/18 [02:17<00:28,  9.34s/it]Eval bleu for test set:  89%|████████▉ | 16/18 [02:26<00:18,  9.21s/it]Eval bleu for test set:  94%|█████████▍| 17/18 [02:35<00:09,  9.04s/it]Eval bleu for test set: 100%|██████████| 18/18 [02:40<00:00,  7.96s/it]Eval bleu for test set: 100%|██████████| 18/18 [02:40<00:00,  8.93s/it]
11/13/2022 02:17:16 - INFO - __main__ -   ***** Eval results *****
11/13/2022 02:17:16 - INFO - __main__ -     bleu = 77.3
11/13/2022 02:17:16 - INFO - __main__ -     codebleu = 77.8862
11/13/2022 02:17:16 - INFO - __main__ -     em = 16.8
11/13/2022 02:17:16 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typereorder_condition + whether_refactoringbefore_refactoring :
11/13/2022 02:17:16 - INFO - __main__ -   [best-bleu] bleu-4: 77.30, em: 16.8000, codebleu: 77.8862

11/13/2022 02:17:16 - INFO - __main__ -   Finish and take 1h58m
11/13/2022 02:17:16 - INFO - __main__ -     ***** Testing *****
11/13/2022 02:17:16 - INFO - __main__ -     Batch size = 64
11/13/2022 02:17:16 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 02:17:16 - INFO - __main__ -   test11111111111
11/13/2022 02:17:16 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/small/pytorch_model.bin
11/13/2022 02:17:16 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/reorder_condition/after_refactoring/small/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/reorder_condition/after_refactoring/small/test.buggy-fixed.fixed
11/13/2022 02:17:16 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 02:17:16 - INFO - utils -   Read 1125 examples, avg src len: 32, avg trg len: 32, max src len: 77, max trg len: 112
11/13/2022 02:17:16 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/test_src_all.pt
11/13/2022 02:17:16 - INFO - utils -   加载前test666666666666666
ngram match: 0.7729739375180948, weighted ngram match: 0.7760243869946453, syntax_match: 0.7862058030759473, dataflow_match: 0.7802432980400992
  0%|          | 0/1125 [00:00<?, ?it/s] 50%|█████     | 564/1125 [00:00<00:00, 926.79it/s] 75%|███████▌  | 846/1125 [00:00<00:00, 901.87it/s]100%|██████████| 1125/1125 [00:00<00:00, 1204.80it/s]
11/13/2022 02:17:17 - INFO - utils -   加载后test77777777777777
11/13/2022 02:17:17 - INFO - __main__ -   加载成功test2222222222
11/13/2022 02:17:17 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 02:17:17 - INFO - __main__ -     Num examples = 1125
11/13/2022 02:17:17 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/18 [00:00<?, ?it/s]Eval bleu for test set:   6%|▌         | 1/18 [00:08<02:28,  8.74s/it]Eval bleu for test set:  11%|█         | 2/18 [00:17<02:19,  8.74s/it]Eval bleu for test set:  17%|█▋        | 3/18 [00:25<02:09,  8.62s/it]Eval bleu for test set:  22%|██▏       | 4/18 [00:34<02:02,  8.76s/it]Eval bleu for test set:  28%|██▊       | 5/18 [00:43<01:52,  8.67s/it]Eval bleu for test set:  33%|███▎      | 6/18 [00:52<01:44,  8.72s/it]Eval bleu for test set:  39%|███▉      | 7/18 [01:01<01:36,  8.73s/it]Eval bleu for test set:  44%|████▍     | 8/18 [01:09<01:27,  8.72s/it]Eval bleu for test set:  50%|█████     | 9/18 [01:18<01:19,  8.80s/it]Eval bleu for test set:  56%|█████▌    | 10/18 [01:27<01:10,  8.86s/it]Eval bleu for test set:  61%|██████    | 11/18 [01:36<01:01,  8.77s/it]Eval bleu for test set:  67%|██████▋   | 12/18 [01:44<00:52,  8.71s/it]Eval bleu for test set:  72%|███████▏  | 13/18 [01:53<00:43,  8.73s/it]Eval bleu for test set:  78%|███████▊  | 14/18 [02:02<00:34,  8.70s/it]Eval bleu for test set:  83%|████████▎ | 15/18 [02:11<00:26,  8.74s/it]Eval bleu for test set:  89%|████████▉ | 16/18 [02:19<00:17,  8.69s/it]Eval bleu for test set:  94%|█████████▍| 17/18 [02:28<00:08,  8.78s/it]Eval bleu for test set: 100%|██████████| 18/18 [02:34<00:00,  7.77s/it]Eval bleu for test set: 100%|██████████| 18/18 [02:34<00:00,  8.56s/it]
11/13/2022 02:20:39 - INFO - __main__ -   ***** Eval results *****
11/13/2022 02:20:39 - INFO - __main__ -     bleu = 67.38
11/13/2022 02:20:39 - INFO - __main__ -     codebleu = 72.3149
11/13/2022 02:20:39 - INFO - __main__ -     em = 3.6444
11/13/2022 02:20:39 - INFO - __main__ -   model: codet5-small dataset: small refactoring_typereorder_condition + whether_refactoringafter_refactoring :
11/13/2022 02:20:39 - INFO - __main__ -   [best-bleu] bleu-4: 67.38, em: 3.6444, codebleu: 72.3149

11/13/2022 02:20:39 - INFO - __main__ -   Finish and take 2h1m
11/13/2022 02:20:39 - INFO - __main__ -     ***** Testing *****
11/13/2022 02:20:39 - INFO - __main__ -     Batch size = 64
11/13/2022 02:20:39 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 02:20:39 - INFO - __main__ -   test11111111111
11/13/2022 02:20:39 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 02:20:39 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/local_variable_renaming/before_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/local_variable_renaming/before_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 02:20:39 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 02:20:39 - INFO - utils -   Read 1099 examples, avg src len: 76, avg trg len: 75, max src len: 123, max trg len: 118
11/13/2022 02:20:39 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/test_src_all.pt
11/13/2022 02:20:39 - INFO - utils -   加载前test666666666666666
ngram match: 0.6737476875237, weighted ngram match: 0.6791057009640574, syntax_match: 0.7667036625971143, dataflow_match: 0.7730392708450545
  0%|          | 0/1099 [00:00<?, ?it/s] 50%|█████     | 550/1099 [00:00<00:00, 860.87it/s] 75%|███████▌  | 825/1099 [00:01<00:00, 725.47it/s]100%|██████████| 1099/1099 [00:01<00:00, 997.13it/s]
11/13/2022 02:20:41 - INFO - utils -   加载后test77777777777777
11/13/2022 02:20:41 - INFO - __main__ -   加载成功test2222222222
11/13/2022 02:20:41 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 02:20:41 - INFO - __main__ -     Num examples = 1099
11/13/2022 02:20:41 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/18 [00:00<?, ?it/s]Eval bleu for test set:   6%|▌         | 1/18 [00:10<03:04, 10.85s/it]Eval bleu for test set:  11%|█         | 2/18 [00:22<03:01, 11.33s/it]Eval bleu for test set:  17%|█▋        | 3/18 [00:33<02:48, 11.22s/it]Eval bleu for test set:  22%|██▏       | 4/18 [00:44<02:33, 10.99s/it]Eval bleu for test set:  28%|██▊       | 5/18 [00:55<02:22, 10.97s/it]Eval bleu for test set:  33%|███▎      | 6/18 [01:05<02:10, 10.89s/it]Eval bleu for test set:  39%|███▉      | 7/18 [01:16<02:00, 10.91s/it]Eval bleu for test set:  44%|████▍     | 8/18 [01:27<01:48, 10.87s/it]Eval bleu for test set:  50%|█████     | 9/18 [01:38<01:37, 10.86s/it]Eval bleu for test set:  56%|█████▌    | 10/18 [01:49<01:26, 10.76s/it]Eval bleu for test set:  61%|██████    | 11/18 [01:59<01:15, 10.73s/it]Eval bleu for test set:  67%|██████▋   | 12/18 [02:10<01:04, 10.73s/it]Eval bleu for test set:  72%|███████▏  | 13/18 [02:21<00:54, 10.88s/it]Eval bleu for test set:  78%|███████▊  | 14/18 [02:32<00:43, 10.91s/it]Eval bleu for test set:  83%|████████▎ | 15/18 [02:44<00:33, 11.21s/it]Eval bleu for test set:  89%|████████▉ | 16/18 [02:55<00:22, 11.04s/it]Eval bleu for test set:  94%|█████████▍| 17/18 [03:05<00:10, 10.98s/it]Eval bleu for test set: 100%|██████████| 18/18 [03:08<00:00,  8.53s/it]Eval bleu for test set: 100%|██████████| 18/18 [03:08<00:00, 10.49s/it]
11/13/2022 02:24:50 - INFO - __main__ -   ***** Eval results *****
11/13/2022 02:24:50 - INFO - __main__ -     bleu = 76.59
11/13/2022 02:24:50 - INFO - __main__ -     codebleu = 75.8536
11/13/2022 02:24:50 - INFO - __main__ -     em = 7.2793
11/13/2022 02:24:50 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typelocal_variable_renaming + whether_refactoringbefore_refactoring :
11/13/2022 02:24:50 - INFO - __main__ -   [best-bleu] bleu-4: 76.59, em: 7.2793, codebleu: 75.8536

11/13/2022 02:24:50 - INFO - __main__ -   Finish and take 2h6m
11/13/2022 02:24:50 - INFO - __main__ -     ***** Testing *****
11/13/2022 02:24:50 - INFO - __main__ -     Batch size = 64
11/13/2022 02:24:50 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 02:24:51 - INFO - __main__ -   test11111111111
11/13/2022 02:24:51 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 02:24:51 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/local_variable_renaming/after_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/local_variable_renaming/after_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 02:24:51 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 02:24:51 - INFO - utils -   Read 1099 examples, avg src len: 76, avg trg len: 75, max src len: 123, max trg len: 118
11/13/2022 02:24:51 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/local_variable_renaming_20221113_022450/test_src_all.pt
11/13/2022 02:24:51 - INFO - utils -   加载前test666666666666666
ngram match: 0.7659233707505564, weighted ngram match: 0.7778312787690476, syntax_match: 0.8046123052823949, dataflow_match: 0.6857751851020866
  0%|          | 0/1099 [00:00<?, ?it/s] 50%|█████     | 550/1099 [00:00<00:00, 867.60it/s] 75%|███████▌  | 825/1099 [00:01<00:00, 719.38it/s]100%|██████████| 1099/1099 [00:01<00:00, 991.54it/s]
11/13/2022 02:24:53 - INFO - utils -   加载后test77777777777777
11/13/2022 02:24:53 - INFO - __main__ -   加载成功test2222222222
11/13/2022 02:24:53 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 02:24:53 - INFO - __main__ -     Num examples = 1099
11/13/2022 02:24:53 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/18 [00:00<?, ?it/s]Eval bleu for test set:   6%|▌         | 1/18 [00:11<03:07, 11.02s/it]Eval bleu for test set:  11%|█         | 2/18 [00:21<02:52, 10.78s/it]Eval bleu for test set:  17%|█▋        | 3/18 [00:32<02:39, 10.63s/it]Eval bleu for test set:  22%|██▏       | 4/18 [00:42<02:28, 10.59s/it]Eval bleu for test set:  28%|██▊       | 5/18 [00:53<02:19, 10.73s/it]Eval bleu for test set:  33%|███▎      | 6/18 [01:04<02:09, 10.82s/it]Eval bleu for test set:  39%|███▉      | 7/18 [01:15<01:59, 10.84s/it]Eval bleu for test set:  44%|████▍     | 8/18 [01:26<01:48, 10.89s/it]Eval bleu for test set:  50%|█████     | 9/18 [01:37<01:37, 10.86s/it]Eval bleu for test set:  56%|█████▌    | 10/18 [01:47<01:26, 10.82s/it]Eval bleu for test set:  61%|██████    | 11/18 [01:58<01:15, 10.76s/it]Eval bleu for test set:  67%|██████▋   | 12/18 [02:09<01:04, 10.73s/it]Eval bleu for test set:  72%|███████▏  | 13/18 [02:20<00:53, 10.80s/it]Eval bleu for test set:  78%|███████▊  | 14/18 [02:30<00:42, 10.69s/it]Eval bleu for test set:  83%|████████▎ | 15/18 [02:41<00:32, 10.71s/it]Eval bleu for test set:  89%|████████▉ | 16/18 [02:51<00:21, 10.66s/it]Eval bleu for test set:  94%|█████████▍| 17/18 [03:02<00:10, 10.69s/it]Eval bleu for test set: 100%|██████████| 18/18 [03:05<00:00,  8.33s/it]Eval bleu for test set: 100%|██████████| 18/18 [03:05<00:00, 10.31s/it]
11/13/2022 02:29:03 - INFO - __main__ -   ***** Eval results *****
11/13/2022 02:29:03 - INFO - __main__ -     bleu = 76.1
11/13/2022 02:29:03 - INFO - __main__ -     codebleu = 75.3882
11/13/2022 02:29:03 - INFO - __main__ -     em = 5.8235
11/13/2022 02:29:03 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typelocal_variable_renaming + whether_refactoringafter_refactoring :
11/13/2022 02:29:03 - INFO - __main__ -   [best-bleu] bleu-4: 76.10, em: 5.8235, codebleu: 75.3882

11/13/2022 02:29:03 - INFO - __main__ -   Finish and take 2h10m
11/13/2022 02:29:03 - INFO - __main__ -     ***** Testing *****
11/13/2022 02:29:03 - INFO - __main__ -     Batch size = 64
11/13/2022 02:29:03 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 02:29:03 - INFO - __main__ -   test11111111111
11/13/2022 02:29:03 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 02:29:03 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/method_renaming/before_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/method_renaming/before_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 02:29:03 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 02:29:03 - INFO - utils -   Read 6217 examples, avg src len: 74, avg trg len: 72, max src len: 292, max trg len: 233
11/13/2022 02:29:03 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/local_variable_renaming_20221113_022450/method_renaming_20221113_022903/test_src_all.pt
11/13/2022 02:29:03 - INFO - utils -   加载前test666666666666666
ngram match: 0.7610377509954809, weighted ngram match: 0.7735055881028379, syntax_match: 0.8013994290886305, dataflow_match: 0.6795840502730606
  0%|          | 0/6217 [00:00<?, ?it/s] 50%|█████     | 3110/6217 [00:03<00:03, 1030.72it/s] 75%|███████▌  | 4665/6217 [00:05<00:01, 783.14it/s] 100%|██████████| 6217/6217 [00:05<00:00, 1095.94it/s]
11/13/2022 02:29:14 - INFO - utils -   加载后test77777777777777
11/13/2022 02:29:15 - INFO - __main__ -   加载成功test2222222222
11/13/2022 02:29:15 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 02:29:15 - INFO - __main__ -     Num examples = 6217
11/13/2022 02:29:15 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/98 [00:00<?, ?it/s]Eval bleu for test set:   1%|          | 1/98 [00:11<19:08, 11.84s/it]Eval bleu for test set:   2%|▏         | 2/98 [00:22<17:49, 11.14s/it]Eval bleu for test set:   3%|▎         | 3/98 [00:34<18:18, 11.56s/it]Eval bleu for test set:   4%|▍         | 4/98 [00:45<17:37, 11.25s/it]Eval bleu for test set:   5%|▌         | 5/98 [00:56<17:23, 11.22s/it]Eval bleu for test set:   6%|▌         | 6/98 [01:07<17:00, 11.09s/it]Eval bleu for test set:   7%|▋         | 7/98 [01:18<16:46, 11.06s/it]Eval bleu for test set:   8%|▊         | 8/98 [01:29<16:28, 10.99s/it]Eval bleu for test set:   9%|▉         | 9/98 [01:40<16:16, 10.98s/it]Eval bleu for test set:  10%|█         | 10/98 [01:50<16:01, 10.93s/it]Eval bleu for test set:  11%|█         | 11/98 [02:02<16:06, 11.11s/it]Eval bleu for test set:  12%|█▏        | 12/98 [02:13<15:54, 11.10s/it]Eval bleu for test set:  13%|█▎        | 13/98 [02:24<15:38, 11.04s/it]Eval bleu for test set:  14%|█▍        | 14/98 [02:35<15:22, 10.98s/it]Eval bleu for test set:  15%|█▌        | 15/98 [02:46<15:08, 10.95s/it]Eval bleu for test set:  16%|█▋        | 16/98 [02:57<14:55, 10.92s/it]Eval bleu for test set:  17%|█▋        | 17/98 [03:07<14:43, 10.91s/it]Eval bleu for test set:  18%|█▊        | 18/98 [03:19<14:40, 11.00s/it]Eval bleu for test set:  19%|█▉        | 19/98 [03:29<14:24, 10.94s/it]Eval bleu for test set:  20%|██        | 20/98 [03:41<14:19, 11.02s/it]Eval bleu for test set:  21%|██▏       | 21/98 [03:51<14:04, 10.97s/it]Eval bleu for test set:  22%|██▏       | 22/98 [04:03<13:55, 10.99s/it]Eval bleu for test set:  23%|██▎       | 23/98 [04:13<13:40, 10.94s/it]Eval bleu for test set:  24%|██▍       | 24/98 [04:24<13:32, 10.98s/it]Eval bleu for test set:  26%|██▌       | 25/98 [04:35<13:19, 10.96s/it]Eval bleu for test set:  27%|██▋       | 26/98 [04:46<13:05, 10.90s/it]Eval bleu for test set:  28%|██▊       | 27/98 [04:57<12:58, 10.96s/it]Eval bleu for test set:  29%|██▊       | 28/98 [05:08<12:43, 10.91s/it]Eval bleu for test set:  30%|██▉       | 29/98 [05:19<12:32, 10.90s/it]Eval bleu for test set:  31%|███       | 30/98 [05:30<12:22, 10.92s/it]Eval bleu for test set:  32%|███▏      | 31/98 [05:41<12:10, 10.91s/it]Eval bleu for test set:  33%|███▎      | 32/98 [05:51<11:57, 10.87s/it]Eval bleu for test set:  34%|███▎      | 33/98 [06:02<11:44, 10.84s/it]Eval bleu for test set:  35%|███▍      | 34/98 [06:13<11:32, 10.82s/it]Eval bleu for test set:  36%|███▌      | 35/98 [06:24<11:27, 10.91s/it]Eval bleu for test set:  37%|███▋      | 36/98 [06:35<11:14, 10.88s/it]Eval bleu for test set:  38%|███▊      | 37/98 [06:46<11:14, 11.05s/it]Eval bleu for test set:  39%|███▉      | 38/98 [06:57<11:01, 11.03s/it]Eval bleu for test set:  40%|███▉      | 39/98 [07:08<10:46, 10.96s/it]Eval bleu for test set:  41%|████      | 40/98 [07:20<10:54, 11.29s/it]Eval bleu for test set:  42%|████▏     | 41/98 [07:32<10:54, 11.49s/it]Eval bleu for test set:  43%|████▎     | 42/98 [07:43<10:38, 11.41s/it]Eval bleu for test set:  44%|████▍     | 43/98 [07:54<10:20, 11.27s/it]Eval bleu for test set:  45%|████▍     | 44/98 [08:05<10:05, 11.22s/it]Eval bleu for test set:  46%|████▌     | 45/98 [08:16<09:49, 11.12s/it]Eval bleu for test set:  47%|████▋     | 46/98 [08:27<09:33, 11.03s/it]Eval bleu for test set:  48%|████▊     | 47/98 [08:38<09:17, 10.93s/it]Eval bleu for test set:  49%|████▉     | 48/98 [08:49<09:05, 10.91s/it]Eval bleu for test set:  50%|█████     | 49/98 [09:00<08:53, 10.89s/it]Eval bleu for test set:  51%|█████     | 50/98 [09:10<08:41, 10.86s/it]Eval bleu for test set:  52%|█████▏    | 51/98 [09:21<08:28, 10.83s/it]Eval bleu for test set:  53%|█████▎    | 52/98 [09:32<08:19, 10.85s/it]Eval bleu for test set:  54%|█████▍    | 53/98 [09:43<08:05, 10.79s/it]Eval bleu for test set:  55%|█████▌    | 54/98 [09:53<07:53, 10.77s/it]Eval bleu for test set:  56%|█████▌    | 55/98 [10:04<07:44, 10.80s/it]Eval bleu for test set:  57%|█████▋    | 56/98 [10:15<07:33, 10.79s/it]Eval bleu for test set:  58%|█████▊    | 57/98 [10:26<07:23, 10.81s/it]Eval bleu for test set:  59%|█████▉    | 58/98 [10:37<07:13, 10.84s/it]Eval bleu for test set:  60%|██████    | 59/98 [10:48<07:01, 10.82s/it]Eval bleu for test set:  61%|██████    | 60/98 [10:58<06:51, 10.82s/it]Eval bleu for test set:  62%|██████▏   | 61/98 [11:09<06:40, 10.82s/it]Eval bleu for test set:  63%|██████▎   | 62/98 [11:20<06:28, 10.80s/it]Eval bleu for test set:  64%|██████▍   | 63/98 [11:31<06:17, 10.78s/it]Eval bleu for test set:  65%|██████▌   | 64/98 [11:41<06:06, 10.78s/it]Eval bleu for test set:  66%|██████▋   | 65/98 [11:52<05:56, 10.79s/it]Eval bleu for test set:  67%|██████▋   | 66/98 [12:03<05:45, 10.80s/it]Eval bleu for test set:  68%|██████▊   | 67/98 [12:14<05:35, 10.83s/it]Eval bleu for test set:  69%|██████▉   | 68/98 [12:25<05:23, 10.79s/it]Eval bleu for test set:  70%|███████   | 69/98 [12:36<05:13, 10.81s/it]Eval bleu for test set:  71%|███████▏  | 70/98 [12:46<05:01, 10.78s/it]Eval bleu for test set:  72%|███████▏  | 71/98 [12:57<04:52, 10.82s/it]Eval bleu for test set:  73%|███████▎  | 72/98 [13:08<04:41, 10.82s/it]Eval bleu for test set:  74%|███████▍  | 73/98 [13:19<04:30, 10.81s/it]Eval bleu for test set:  76%|███████▌  | 74/98 [13:30<04:19, 10.82s/it]Eval bleu for test set:  77%|███████▋  | 75/98 [13:40<04:07, 10.78s/it]Eval bleu for test set:  78%|███████▊  | 76/98 [13:52<04:00, 10.93s/it]Eval bleu for test set:  79%|███████▊  | 77/98 [14:03<03:50, 10.99s/it]Eval bleu for test set:  80%|███████▉  | 78/98 [14:14<03:39, 10.95s/it]Eval bleu for test set:  81%|████████  | 79/98 [14:25<03:27, 10.94s/it]Eval bleu for test set:  82%|████████▏ | 80/98 [14:35<03:16, 10.91s/it]Eval bleu for test set:  83%|████████▎ | 81/98 [14:46<03:04, 10.85s/it]Eval bleu for test set:  84%|████████▎ | 82/98 [14:57<02:54, 10.90s/it]Eval bleu for test set:  85%|████████▍ | 83/98 [15:08<02:43, 10.92s/it]Eval bleu for test set:  86%|████████▌ | 84/98 [15:19<02:33, 10.95s/it]Eval bleu for test set:  87%|████████▋ | 85/98 [15:30<02:21, 10.90s/it]Eval bleu for test set:  88%|████████▊ | 86/98 [15:41<02:11, 10.95s/it]Eval bleu for test set:  89%|████████▉ | 87/98 [15:51<01:59, 10.83s/it]Eval bleu for test set:  90%|████████▉ | 88/98 [16:03<01:49, 10.93s/it]Eval bleu for test set:  91%|█████████ | 89/98 [16:13<01:37, 10.88s/it]Eval bleu for test set:  92%|█████████▏| 90/98 [16:24<01:26, 10.84s/it]Eval bleu for test set:  93%|█████████▎| 91/98 [16:35<01:15, 10.83s/it]Eval bleu for test set:  94%|█████████▍| 92/98 [16:46<01:04, 10.82s/it]Eval bleu for test set:  95%|█████████▍| 93/98 [16:57<00:54, 10.98s/it]Eval bleu for test set:  96%|█████████▌| 94/98 [17:08<00:43, 10.91s/it]Eval bleu for test set:  97%|█████████▋| 95/98 [17:19<00:32, 10.87s/it]Eval bleu for test set:  98%|█████████▊| 96/98 [17:30<00:22, 11.03s/it]Eval bleu for test set:  99%|█████████▉| 97/98 [17:41<00:11, 11.02s/it]Eval bleu for test set: 100%|██████████| 98/98 [17:44<00:00,  8.50s/it]Eval bleu for test set: 100%|██████████| 98/98 [17:44<00:00, 10.86s/it]
11/13/2022 02:52:47 - INFO - __main__ -   ***** Eval results *****
11/13/2022 02:52:47 - INFO - __main__ -     bleu = 70.72
11/13/2022 02:52:47 - INFO - __main__ -     codebleu = 71.5041
11/13/2022 02:52:47 - INFO - __main__ -     em = 5.4689
11/13/2022 02:52:47 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typemethod_renaming + whether_refactoringbefore_refactoring :
11/13/2022 02:52:47 - INFO - __main__ -   [best-bleu] bleu-4: 70.72, em: 5.4689, codebleu: 71.5041

11/13/2022 02:52:47 - INFO - __main__ -   Finish and take 2h33m
11/13/2022 02:52:47 - INFO - __main__ -     ***** Testing *****
11/13/2022 02:52:47 - INFO - __main__ -     Batch size = 64
11/13/2022 02:52:47 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 02:52:47 - INFO - __main__ -   test11111111111
11/13/2022 02:52:47 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 02:52:47 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/method_renaming/after_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/method_renaming/after_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 02:52:47 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 02:52:47 - INFO - utils -   Read 6217 examples, avg src len: 74, avg trg len: 72, max src len: 292, max trg len: 233
11/13/2022 02:52:47 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/local_variable_renaming_20221113_022450/method_renaming_20221113_022903/method_renaming_20221113_025247/test_src_all.pt
11/13/2022 02:52:47 - INFO - utils -   加载前test666666666666666
ngram match: 0.7071719464736441, weighted ngram match: 0.7269204985309938, syntax_match: 0.7908234071326912, dataflow_match: 0.635248943021902
  0%|          | 0/6217 [00:00<?, ?it/s] 50%|█████     | 3110/6217 [00:02<00:02, 1088.69it/s] 75%|███████▌  | 4665/6217 [00:05<00:01, 799.68it/s] 100%|██████████| 6217/6217 [00:05<00:00, 1125.05it/s]
11/13/2022 02:52:58 - INFO - utils -   加载后test77777777777777
11/13/2022 02:52:58 - INFO - __main__ -   加载成功test2222222222
11/13/2022 02:52:58 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 02:52:58 - INFO - __main__ -     Num examples = 6217
11/13/2022 02:52:58 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/98 [00:00<?, ?it/s]Eval bleu for test set:   1%|          | 1/98 [00:10<17:46, 11.00s/it]Eval bleu for test set:   2%|▏         | 2/98 [00:21<17:30, 10.94s/it]Eval bleu for test set:   3%|▎         | 3/98 [00:32<17:20, 10.95s/it]Eval bleu for test set:   4%|▍         | 4/98 [00:43<17:08, 10.95s/it]Eval bleu for test set:   5%|▌         | 5/98 [00:54<16:54, 10.91s/it]Eval bleu for test set:   6%|▌         | 6/98 [01:05<16:47, 10.95s/it]Eval bleu for test set:   7%|▋         | 7/98 [01:16<16:42, 11.02s/it]Eval bleu for test set:   8%|▊         | 8/98 [01:27<16:27, 10.97s/it]Eval bleu for test set:   9%|▉         | 9/98 [01:38<16:12, 10.92s/it]Eval bleu for test set:  10%|█         | 10/98 [01:49<15:54, 10.84s/it]Eval bleu for test set:  11%|█         | 11/98 [02:00<15:44, 10.86s/it]Eval bleu for test set:  12%|█▏        | 12/98 [02:10<15:32, 10.84s/it]Eval bleu for test set:  13%|█▎        | 13/98 [02:21<15:20, 10.83s/it]Eval bleu for test set:  14%|█▍        | 14/98 [02:32<15:10, 10.84s/it]Eval bleu for test set:  15%|█▌        | 15/98 [02:43<14:59, 10.84s/it]Eval bleu for test set:  16%|█▋        | 16/98 [02:54<14:50, 10.86s/it]Eval bleu for test set:  17%|█▋        | 17/98 [03:05<14:41, 10.89s/it]Eval bleu for test set:  18%|█▊        | 18/98 [03:16<14:33, 10.92s/it]Eval bleu for test set:  19%|█▉        | 19/98 [03:27<14:20, 10.89s/it]Eval bleu for test set:  20%|██        | 20/98 [03:38<14:11, 10.92s/it]Eval bleu for test set:  21%|██▏       | 21/98 [03:49<14:03, 10.95s/it]Eval bleu for test set:  22%|██▏       | 22/98 [03:59<13:47, 10.89s/it]Eval bleu for test set:  23%|██▎       | 23/98 [04:10<13:35, 10.88s/it]Eval bleu for test set:  24%|██▍       | 24/98 [04:22<13:36, 11.03s/it]Eval bleu for test set:  26%|██▌       | 25/98 [04:33<13:44, 11.29s/it]Eval bleu for test set:  27%|██▋       | 26/98 [04:44<13:23, 11.16s/it]Eval bleu for test set:  28%|██▊       | 27/98 [04:55<13:07, 11.09s/it]Eval bleu for test set:  29%|██▊       | 28/98 [05:06<12:47, 10.97s/it]Eval bleu for test set:  30%|██▉       | 29/98 [05:17<12:34, 10.93s/it]Eval bleu for test set:  31%|███       | 30/98 [05:28<12:22, 10.92s/it]Eval bleu for test set:  32%|███▏      | 31/98 [05:39<12:13, 10.95s/it]Eval bleu for test set:  33%|███▎      | 32/98 [05:50<12:18, 11.19s/it]Eval bleu for test set:  34%|███▎      | 33/98 [06:01<11:56, 11.03s/it]Eval bleu for test set:  35%|███▍      | 34/98 [06:12<11:43, 10.99s/it]Eval bleu for test set:  36%|███▌      | 35/98 [06:23<11:28, 10.94s/it]Eval bleu for test set:  37%|███▋      | 36/98 [06:34<11:19, 10.96s/it]Eval bleu for test set:  38%|███▊      | 37/98 [06:45<11:05, 10.91s/it]Eval bleu for test set:  39%|███▉      | 38/98 [06:55<10:50, 10.84s/it]Eval bleu for test set:  40%|███▉      | 39/98 [07:06<10:39, 10.84s/it]Eval bleu for test set:  41%|████      | 40/98 [07:18<10:38, 11.01s/it]Eval bleu for test set:  42%|████▏     | 41/98 [07:28<10:26, 10.99s/it]Eval bleu for test set:  43%|████▎     | 42/98 [07:39<10:10, 10.91s/it]Eval bleu for test set:  44%|████▍     | 43/98 [07:50<10:03, 10.97s/it]Eval bleu for test set:  45%|████▍     | 44/98 [08:02<09:57, 11.07s/it]Eval bleu for test set:  46%|████▌     | 45/98 [08:13<09:48, 11.10s/it]Eval bleu for test set:  47%|████▋     | 46/98 [08:24<09:34, 11.05s/it]Eval bleu for test set:  48%|████▊     | 47/98 [08:34<09:19, 10.97s/it]Eval bleu for test set:  49%|████▉     | 48/98 [08:45<09:07, 10.94s/it]Eval bleu for test set:  50%|█████     | 49/98 [08:56<08:54, 10.90s/it]Eval bleu for test set:  51%|█████     | 50/98 [09:07<08:41, 10.87s/it]Eval bleu for test set:  52%|█████▏    | 51/98 [09:18<08:33, 10.93s/it]Eval bleu for test set:  53%|█████▎    | 52/98 [09:29<08:26, 11.01s/it]Eval bleu for test set:  54%|█████▍    | 53/98 [09:40<08:11, 10.92s/it]Eval bleu for test set:  55%|█████▌    | 54/98 [09:51<07:58, 10.87s/it]Eval bleu for test set:  56%|█████▌    | 55/98 [10:02<07:46, 10.85s/it]Eval bleu for test set:  57%|█████▋    | 56/98 [10:12<07:35, 10.85s/it]Eval bleu for test set:  58%|█████▊    | 57/98 [10:23<07:23, 10.82s/it]Eval bleu for test set:  59%|█████▉    | 58/98 [10:34<07:12, 10.80s/it]Eval bleu for test set:  60%|██████    | 59/98 [10:45<07:03, 10.85s/it]Eval bleu for test set:  61%|██████    | 60/98 [10:56<06:52, 10.87s/it]Eval bleu for test set:  62%|██████▏   | 61/98 [11:07<06:42, 10.88s/it]Eval bleu for test set:  63%|██████▎   | 62/98 [11:18<06:31, 10.87s/it]Eval bleu for test set:  64%|██████▍   | 63/98 [11:28<06:19, 10.83s/it]Eval bleu for test set:  65%|██████▌   | 64/98 [11:39<06:07, 10.81s/it]Eval bleu for test set:  66%|██████▋   | 65/98 [11:50<05:56, 10.80s/it]Eval bleu for test set:  67%|██████▋   | 66/98 [12:01<05:47, 10.85s/it]Eval bleu for test set:  68%|██████▊   | 67/98 [12:12<05:35, 10.82s/it]Eval bleu for test set:  69%|██████▉   | 68/98 [12:22<05:25, 10.84s/it]Eval bleu for test set:  70%|███████   | 69/98 [12:33<05:16, 10.91s/it]Eval bleu for test set:  71%|███████▏  | 70/98 [12:44<05:05, 10.91s/it]Eval bleu for test set:  72%|███████▏  | 71/98 [12:55<04:54, 10.90s/it]Eval bleu for test set:  73%|███████▎  | 72/98 [13:06<04:43, 10.91s/it]Eval bleu for test set:  74%|███████▍  | 73/98 [13:17<04:33, 10.93s/it]Eval bleu for test set:  76%|███████▌  | 74/98 [13:28<04:21, 10.90s/it]Eval bleu for test set:  77%|███████▋  | 75/98 [13:39<04:09, 10.83s/it]Eval bleu for test set:  78%|███████▊  | 76/98 [13:49<03:57, 10.81s/it]Eval bleu for test set:  79%|███████▊  | 77/98 [14:00<03:48, 10.86s/it]Eval bleu for test set:  80%|███████▉  | 78/98 [14:11<03:36, 10.84s/it]Eval bleu for test set:  81%|████████  | 79/98 [14:22<03:25, 10.84s/it]Eval bleu for test set:  82%|████████▏ | 80/98 [14:33<03:15, 10.86s/it]Eval bleu for test set:  83%|████████▎ | 81/98 [14:43<03:02, 10.76s/it]Eval bleu for test set:  84%|████████▎ | 82/98 [14:54<02:52, 10.81s/it]Eval bleu for test set:  85%|████████▍ | 83/98 [15:05<02:43, 10.88s/it]Eval bleu for test set:  86%|████████▌ | 84/98 [15:16<02:32, 10.89s/it]Eval bleu for test set:  87%|████████▋ | 85/98 [15:27<02:20, 10.83s/it]Eval bleu for test set:  88%|████████▊ | 86/98 [15:38<02:09, 10.82s/it]Eval bleu for test set:  89%|████████▉ | 87/98 [15:49<01:59, 10.82s/it]Eval bleu for test set:  90%|████████▉ | 88/98 [15:59<01:48, 10.81s/it]Eval bleu for test set:  91%|█████████ | 89/98 [16:10<01:37, 10.81s/it]Eval bleu for test set:  92%|█████████▏| 90/98 [16:21<01:26, 10.79s/it]Eval bleu for test set:  93%|█████████▎| 91/98 [16:32<01:15, 10.79s/it]Eval bleu for test set:  94%|█████████▍| 92/98 [16:43<01:04, 10.83s/it]Eval bleu for test set:  95%|█████████▍| 93/98 [16:54<00:54, 10.86s/it]Eval bleu for test set:  96%|█████████▌| 94/98 [17:04<00:43, 10.85s/it]Eval bleu for test set:  97%|█████████▋| 95/98 [17:15<00:32, 10.86s/it]Eval bleu for test set:  98%|█████████▊| 96/98 [17:26<00:21, 10.92s/it]Eval bleu for test set:  99%|█████████▉| 97/98 [17:37<00:10, 10.87s/it]Eval bleu for test set: 100%|██████████| 98/98 [17:40<00:00,  8.38s/it]Eval bleu for test set: 100%|██████████| 98/98 [17:40<00:00, 10.82s/it]
11/13/2022 03:16:24 - INFO - __main__ -   ***** Eval results *****
11/13/2022 03:16:24 - INFO - __main__ -     bleu = 70.49
11/13/2022 03:16:24 - INFO - __main__ -     codebleu = 71.289
11/13/2022 03:16:24 - INFO - __main__ -     em = 4.552
11/13/2022 03:16:24 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typemethod_renaming + whether_refactoringafter_refactoring :
11/13/2022 03:16:24 - INFO - __main__ -   [best-bleu] bleu-4: 70.49, em: 4.5520, codebleu: 71.2890

11/13/2022 03:16:24 - INFO - __main__ -   Finish and take 2h57m
11/13/2022 03:16:24 - INFO - __main__ -     ***** Testing *****
11/13/2022 03:16:24 - INFO - __main__ -     Batch size = 64
11/13/2022 03:16:24 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 03:16:24 - INFO - __main__ -   test11111111111
11/13/2022 03:16:24 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 03:16:24 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/parameter_renaming/before_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/parameter_renaming/before_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 03:16:24 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 03:16:24 - INFO - utils -   Read 4302 examples, avg src len: 74, avg trg len: 73, max src len: 194, max trg len: 190
11/13/2022 03:16:24 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/local_variable_renaming_20221113_022450/method_renaming_20221113_022903/method_renaming_20221113_025247/parameter_renaming_20221113_031624/test_src_all.pt
11/13/2022 03:16:24 - INFO - utils -   加载前test666666666666666
ngram match: 0.7049452542090492, weighted ngram match: 0.7251371472712622, syntax_match: 0.7897661673472883, dataflow_match: 0.6317121973130794
  0%|          | 0/4302 [00:00<?, ?it/s] 50%|█████     | 2152/4302 [00:02<00:02, 1027.88it/s] 75%|███████▌  | 3228/4302 [00:03<00:01, 783.00it/s] 100%|██████████| 4302/4302 [00:03<00:00, 1095.32it/s]
11/13/2022 03:16:32 - INFO - utils -   加载后test77777777777777
11/13/2022 03:16:32 - INFO - __main__ -   加载成功test2222222222
11/13/2022 03:16:32 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 03:16:32 - INFO - __main__ -     Num examples = 4302
11/13/2022 03:16:32 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/68 [00:00<?, ?it/s]Eval bleu for test set:   1%|▏         | 1/68 [00:11<12:20, 11.04s/it]Eval bleu for test set:   3%|▎         | 2/68 [00:21<11:57, 10.87s/it]Eval bleu for test set:   4%|▍         | 3/68 [00:32<11:49, 10.92s/it]Eval bleu for test set:   6%|▌         | 4/68 [00:43<11:41, 10.96s/it]Eval bleu for test set:   7%|▋         | 5/68 [00:54<11:33, 11.00s/it]Eval bleu for test set:   9%|▉         | 6/68 [01:05<11:17, 10.93s/it]Eval bleu for test set:  10%|█         | 7/68 [01:16<11:08, 10.96s/it]Eval bleu for test set:  12%|█▏        | 8/68 [01:27<10:57, 10.96s/it]Eval bleu for test set:  13%|█▎        | 9/68 [01:38<10:47, 10.97s/it]Eval bleu for test set:  15%|█▍        | 10/68 [01:49<10:34, 10.94s/it]Eval bleu for test set:  16%|█▌        | 11/68 [02:00<10:22, 10.92s/it]Eval bleu for test set:  18%|█▊        | 12/68 [02:11<10:14, 10.97s/it]Eval bleu for test set:  19%|█▉        | 13/68 [02:22<10:02, 10.95s/it]Eval bleu for test set:  21%|██        | 14/68 [02:33<09:50, 10.94s/it]Eval bleu for test set:  22%|██▏       | 15/68 [02:44<09:47, 11.08s/it]Eval bleu for test set:  24%|██▎       | 16/68 [02:56<09:48, 11.32s/it]Eval bleu for test set:  25%|██▌       | 17/68 [03:07<09:31, 11.20s/it]Eval bleu for test set:  26%|██▋       | 18/68 [03:18<09:16, 11.14s/it]Eval bleu for test set:  28%|██▊       | 19/68 [03:29<08:58, 11.00s/it]Eval bleu for test set:  29%|██▉       | 20/68 [03:40<08:47, 11.00s/it]Eval bleu for test set:  31%|███       | 21/68 [03:51<08:36, 10.99s/it]Eval bleu for test set:  32%|███▏      | 22/68 [04:02<08:35, 11.21s/it]Eval bleu for test set:  34%|███▍      | 23/68 [04:13<08:21, 11.14s/it]Eval bleu for test set:  35%|███▌      | 24/68 [04:24<08:08, 11.11s/it]Eval bleu for test set:  37%|███▋      | 25/68 [04:36<07:58, 11.12s/it]Eval bleu for test set:  38%|███▊      | 26/68 [04:46<07:42, 11.02s/it]Eval bleu for test set:  40%|███▉      | 27/68 [04:57<07:27, 10.92s/it]Eval bleu for test set:  41%|████      | 28/68 [05:08<07:16, 10.90s/it]Eval bleu for test set:  43%|████▎     | 29/68 [05:19<07:03, 10.87s/it]Eval bleu for test set:  44%|████▍     | 30/68 [05:30<06:55, 10.93s/it]Eval bleu for test set:  46%|████▌     | 31/68 [05:41<06:44, 10.94s/it]Eval bleu for test set:  47%|████▋     | 32/68 [05:52<06:33, 10.93s/it]Eval bleu for test set:  49%|████▊     | 33/68 [06:02<06:21, 10.89s/it]Eval bleu for test set:  50%|█████     | 34/68 [06:13<06:11, 10.94s/it]Eval bleu for test set:  51%|█████▏    | 35/68 [06:24<06:00, 10.91s/it]Eval bleu for test set:  53%|█████▎    | 36/68 [06:35<05:49, 10.91s/it]Eval bleu for test set:  54%|█████▍    | 37/68 [06:46<05:39, 10.95s/it]Eval bleu for test set:  56%|█████▌    | 38/68 [06:57<05:27, 10.92s/it]Eval bleu for test set:  57%|█████▋    | 39/68 [07:08<05:15, 10.89s/it]Eval bleu for test set:  59%|█████▉    | 40/68 [07:19<05:04, 10.88s/it]Eval bleu for test set:  60%|██████    | 41/68 [07:30<04:53, 10.88s/it]Eval bleu for test set:  62%|██████▏   | 42/68 [07:41<04:42, 10.88s/it]Eval bleu for test set:  63%|██████▎   | 43/68 [07:52<04:33, 10.95s/it]Eval bleu for test set:  65%|██████▍   | 44/68 [08:02<04:21, 10.89s/it]Eval bleu for test set:  66%|██████▌   | 45/68 [08:13<04:10, 10.89s/it]Eval bleu for test set:  68%|██████▊   | 46/68 [08:24<04:00, 10.93s/it]Eval bleu for test set:  69%|██████▉   | 47/68 [08:35<03:48, 10.89s/it]Eval bleu for test set:  71%|███████   | 48/68 [08:46<03:37, 10.86s/it]Eval bleu for test set:  72%|███████▏  | 49/68 [08:57<03:27, 10.94s/it]Eval bleu for test set:  74%|███████▎  | 50/68 [09:08<03:16, 10.91s/it]Eval bleu for test set:  75%|███████▌  | 51/68 [09:19<03:05, 10.90s/it]Eval bleu for test set:  76%|███████▋  | 52/68 [09:30<02:54, 10.92s/it]Eval bleu for test set:  78%|███████▊  | 53/68 [09:41<02:46, 11.10s/it]Eval bleu for test set:  79%|███████▉  | 54/68 [09:52<02:35, 11.11s/it]Eval bleu for test set:  81%|████████  | 55/68 [10:03<02:24, 11.09s/it]Eval bleu for test set:  82%|████████▏ | 56/68 [10:14<02:11, 10.93s/it]Eval bleu for test set:  84%|████████▍ | 57/68 [10:25<01:59, 10.85s/it]Eval bleu for test set:  85%|████████▌ | 58/68 [10:35<01:48, 10.84s/it]Eval bleu for test set:  87%|████████▋ | 59/68 [10:46<01:37, 10.84s/it]Eval bleu for test set:  88%|████████▊ | 60/68 [10:57<01:26, 10.78s/it]Eval bleu for test set:  90%|████████▉ | 61/68 [11:08<01:15, 10.78s/it]Eval bleu for test set:  91%|█████████ | 62/68 [11:18<01:04, 10.74s/it]Eval bleu for test set:  93%|█████████▎| 63/68 [11:29<00:53, 10.75s/it]Eval bleu for test set:  94%|█████████▍| 64/68 [11:40<00:43, 10.76s/it]Eval bleu for test set:  96%|█████████▌| 65/68 [11:51<00:32, 10.78s/it]Eval bleu for test set:  97%|█████████▋| 66/68 [12:01<00:21, 10.72s/it]Eval bleu for test set:  99%|█████████▊| 67/68 [12:12<00:10, 10.72s/it]Eval bleu for test set: 100%|██████████| 68/68 [12:15<00:00,  8.46s/it]Eval bleu for test set: 100%|██████████| 68/68 [12:15<00:00, 10.82s/it]
11/13/2022 03:32:49 - INFO - __main__ -   ***** Eval results *****
11/13/2022 03:32:49 - INFO - __main__ -     bleu = 69.96
11/13/2022 03:32:49 - INFO - __main__ -     codebleu = 70.9954
11/13/2022 03:32:49 - INFO - __main__ -     em = 5.1371
11/13/2022 03:32:49 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typeparameter_renaming + whether_refactoringbefore_refactoring :
11/13/2022 03:32:49 - INFO - __main__ -   [best-bleu] bleu-4: 69.96, em: 5.1371, codebleu: 70.9954

11/13/2022 03:32:49 - INFO - __main__ -   Finish and take 3h13m
11/13/2022 03:32:49 - INFO - __main__ -     ***** Testing *****
11/13/2022 03:32:49 - INFO - __main__ -     Batch size = 64
11/13/2022 03:32:49 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 03:32:49 - INFO - __main__ -   test11111111111
11/13/2022 03:32:49 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 03:32:49 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/parameter_renaming/after_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/parameter_renaming/after_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 03:32:49 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 03:32:49 - INFO - utils -   Read 4302 examples, avg src len: 75, avg trg len: 73, max src len: 205, max trg len: 201
11/13/2022 03:32:49 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/local_variable_renaming_20221113_022450/method_renaming_20221113_022903/method_renaming_20221113_025247/parameter_renaming_20221113_031624/parameter_renaming_20221113_033249/test_src_all.pt
11/13/2022 03:32:49 - INFO - utils -   加载前test666666666666666
ngram match: 0.6996423238449733, weighted ngram match: 0.7207001878976623, syntax_match: 0.7858203024811528, dataflow_match: 0.6336550900587123
  0%|          | 0/4302 [00:00<?, ?it/s] 50%|█████     | 2152/4302 [00:01<00:01, 1078.02it/s] 75%|███████▌  | 3228/4302 [00:03<00:01, 790.19it/s] 100%|██████████| 4302/4302 [00:03<00:00, 1112.09it/s]
11/13/2022 03:32:57 - INFO - utils -   加载后test77777777777777
11/13/2022 03:32:57 - INFO - __main__ -   加载成功test2222222222
11/13/2022 03:32:57 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 03:32:57 - INFO - __main__ -     Num examples = 4302
11/13/2022 03:32:57 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/68 [00:00<?, ?it/s]Eval bleu for test set:   1%|▏         | 1/68 [00:11<12:29, 11.19s/it]Eval bleu for test set:   3%|▎         | 2/68 [00:22<12:09, 11.06s/it]Eval bleu for test set:   4%|▍         | 3/68 [00:33<11:56, 11.03s/it]Eval bleu for test set:   6%|▌         | 4/68 [00:44<11:45, 11.03s/it]Eval bleu for test set:   7%|▋         | 5/68 [00:55<11:36, 11.05s/it]Eval bleu for test set:   9%|▉         | 6/68 [01:06<11:26, 11.07s/it]Eval bleu for test set:  10%|█         | 7/68 [01:17<11:11, 11.01s/it]Eval bleu for test set:  12%|█▏        | 8/68 [01:28<10:59, 10.98s/it]Eval bleu for test set:  13%|█▎        | 9/68 [01:39<10:45, 10.94s/it]Eval bleu for test set:  15%|█▍        | 10/68 [01:49<10:33, 10.93s/it]Eval bleu for test set:  16%|█▌        | 11/68 [02:00<10:20, 10.89s/it]Eval bleu for test set:  18%|█▊        | 12/68 [02:11<10:08, 10.87s/it]Eval bleu for test set:  19%|█▉        | 13/68 [02:22<09:55, 10.82s/it]Eval bleu for test set:  21%|██        | 14/68 [02:33<09:44, 10.82s/it]Eval bleu for test set:  22%|██▏       | 15/68 [02:44<09:34, 10.85s/it]Eval bleu for test set:  24%|██▎       | 16/68 [02:54<09:26, 10.89s/it]Eval bleu for test set:  25%|██▌       | 17/68 [03:05<09:15, 10.89s/it]Eval bleu for test set:  26%|██▋       | 18/68 [03:16<09:02, 10.84s/it]Eval bleu for test set:  28%|██▊       | 19/68 [03:27<08:51, 10.84s/it]Eval bleu for test set:  29%|██▉       | 20/68 [03:38<08:40, 10.85s/it]Eval bleu for test set:  31%|███       | 21/68 [03:49<08:29, 10.84s/it]Eval bleu for test set:  32%|███▏      | 22/68 [03:59<08:18, 10.84s/it]Eval bleu for test set:  34%|███▍      | 23/68 [04:10<08:06, 10.81s/it]Eval bleu for test set:  35%|███▌      | 24/68 [04:21<07:59, 10.89s/it]Eval bleu for test set:  37%|███▋      | 25/68 [04:33<07:59, 11.14s/it]Eval bleu for test set:  38%|███▊      | 26/68 [04:44<07:45, 11.08s/it]Eval bleu for test set:  40%|███▉      | 27/68 [04:55<07:33, 11.06s/it]Eval bleu for test set:  41%|████      | 28/68 [05:06<07:22, 11.07s/it]Eval bleu for test set:  43%|████▎     | 29/68 [05:18<07:18, 11.25s/it]Eval bleu for test set:  44%|████▍     | 30/68 [05:29<07:04, 11.18s/it]Eval bleu for test set:  46%|████▌     | 31/68 [05:40<06:48, 11.05s/it]Eval bleu for test set:  47%|████▋     | 32/68 [05:50<06:37, 11.03s/it]Eval bleu for test set:  49%|████▊     | 33/68 [06:02<06:28, 11.10s/it]Eval bleu for test set:  50%|█████     | 34/68 [06:13<06:14, 11.01s/it]Eval bleu for test set:  51%|█████▏    | 35/68 [06:23<06:01, 10.94s/it]Eval bleu for test set:  53%|█████▎    | 36/68 [06:34<05:50, 10.96s/it]Eval bleu for test set:  54%|█████▍    | 37/68 [06:45<05:40, 10.98s/it]Eval bleu for test set:  56%|█████▌    | 38/68 [06:56<05:27, 10.91s/it]Eval bleu for test set:  57%|█████▋    | 39/68 [07:07<05:16, 10.92s/it]Eval bleu for test set:  59%|█████▉    | 40/68 [07:20<05:21, 11.47s/it]Eval bleu for test set:  60%|██████    | 41/68 [07:32<05:18, 11.80s/it]Eval bleu for test set:  62%|██████▏   | 42/68 [07:45<05:13, 12.06s/it]Eval bleu for test set:  63%|██████▎   | 43/68 [07:58<05:05, 12.23s/it]Eval bleu for test set:  65%|██████▍   | 44/68 [08:10<04:54, 12.29s/it]Eval bleu for test set:  66%|██████▌   | 45/68 [08:23<04:44, 12.38s/it]Eval bleu for test set:  68%|██████▊   | 46/68 [08:35<04:34, 12.49s/it]Eval bleu for test set:  69%|██████▉   | 47/68 [08:48<04:21, 12.44s/it]Eval bleu for test set:  71%|███████   | 48/68 [09:00<04:10, 12.52s/it]Eval bleu for test set:  72%|███████▏  | 49/68 [09:13<03:58, 12.55s/it]Eval bleu for test set:  74%|███████▎  | 50/68 [09:26<03:46, 12.56s/it]Eval bleu for test set:  75%|███████▌  | 51/68 [09:38<03:33, 12.57s/it]Eval bleu for test set:  76%|███████▋  | 52/68 [09:51<03:20, 12.55s/it]Eval bleu for test set:  78%|███████▊  | 53/68 [10:03<03:08, 12.59s/it]Eval bleu for test set:  79%|███████▉  | 54/68 [10:15<02:53, 12.39s/it]Eval bleu for test set:  81%|████████  | 55/68 [10:26<02:35, 11.94s/it]Eval bleu for test set:  82%|████████▏ | 56/68 [10:37<02:19, 11.65s/it]Eval bleu for test set:  84%|████████▍ | 57/68 [10:48<02:05, 11.39s/it]Eval bleu for test set:  85%|████████▌ | 58/68 [10:59<01:52, 11.26s/it]Eval bleu for test set:  87%|████████▋ | 59/68 [11:10<01:41, 11.24s/it]Eval bleu for test set:  88%|████████▊ | 60/68 [11:21<01:28, 11.09s/it]Eval bleu for test set:  90%|████████▉ | 61/68 [11:32<01:17, 11.06s/it]Eval bleu for test set:  91%|█████████ | 62/68 [11:43<01:05, 10.97s/it]Eval bleu for test set:  93%|█████████▎| 63/68 [11:54<00:54, 11.00s/it]Eval bleu for test set:  94%|█████████▍| 64/68 [12:05<00:43, 10.98s/it]Eval bleu for test set:  96%|█████████▌| 65/68 [12:15<00:32, 10.93s/it]Eval bleu for test set:  97%|█████████▋| 66/68 [12:26<00:21, 10.85s/it]Eval bleu for test set:  99%|█████████▊| 67/68 [12:37<00:10, 10.94s/it]Eval bleu for test set: 100%|██████████| 68/68 [12:40<00:00,  8.61s/it]Eval bleu for test set: 100%|██████████| 68/68 [12:41<00:00, 11.19s/it]
11/13/2022 03:49:41 - INFO - __main__ -   ***** Eval results *****
11/13/2022 03:49:41 - INFO - __main__ -     bleu = 67.71
11/13/2022 03:49:41 - INFO - __main__ -     codebleu = 69.0906
11/13/2022 03:49:41 - INFO - __main__ -     em = 3.7424
11/13/2022 03:49:41 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typeparameter_renaming + whether_refactoringafter_refactoring :
11/13/2022 03:49:41 - INFO - __main__ -   [best-bleu] bleu-4: 67.71, em: 3.7424, codebleu: 69.0906

11/13/2022 03:49:41 - INFO - __main__ -   Finish and take 3h30m
11/13/2022 03:49:41 - INFO - __main__ -     ***** Testing *****
11/13/2022 03:49:41 - INFO - __main__ -     Batch size = 64
11/13/2022 03:49:41 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 03:49:41 - INFO - __main__ -   test11111111111
11/13/2022 03:49:41 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 03:49:41 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/boolean_exchange/before_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/boolean_exchange/before_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 03:49:41 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 03:49:41 - INFO - utils -   Read 146 examples, avg src len: 76, avg trg len: 74, max src len: 123, max trg len: 118
11/13/2022 03:49:41 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/local_variable_renaming_20221113_022450/method_renaming_20221113_022903/method_renaming_20221113_025247/parameter_renaming_20221113_031624/parameter_renaming_20221113_033249/boolean_exchange_20221113_034941/test_src_all.pt
11/13/2022 03:49:41 - INFO - utils -   加载前test666666666666666
ngram match: 0.6771129353570637, weighted ngram match: 0.702332443352728, syntax_match: 0.7727272727272727, dataflow_match: 0.6114514794531343
  0%|          | 0/146 [00:00<?, ?it/s] 51%|█████     | 74/146 [00:00<00:00, 280.84it/s] 76%|███████▌  | 111/146 [00:00<00:00, 291.52it/s]100%|██████████| 146/146 [00:00<00:00, 380.02it/s]
11/13/2022 03:49:42 - INFO - utils -   加载后test77777777777777
11/13/2022 03:49:42 - INFO - __main__ -   加载成功test2222222222
11/13/2022 03:49:42 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 03:49:42 - INFO - __main__ -     Num examples = 146
11/13/2022 03:49:42 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/3 [00:00<?, ?it/s]Eval bleu for test set:  33%|███▎      | 1/3 [00:11<00:22, 11.23s/it]Eval bleu for test set:  67%|██████▋   | 2/3 [00:21<00:10, 10.96s/it]Eval bleu for test set: 100%|██████████| 3/3 [00:25<00:00,  7.62s/it]Eval bleu for test set: 100%|██████████| 3/3 [00:25<00:00,  8.58s/it]
11/13/2022 03:50:16 - INFO - __main__ -   ***** Eval results *****
11/13/2022 03:50:16 - INFO - __main__ -     bleu = 70.79
11/13/2022 03:50:16 - INFO - __main__ -     codebleu = 71.5498
11/13/2022 03:50:16 - INFO - __main__ -     em = 6.1644
11/13/2022 03:50:16 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typeboolean_exchange + whether_refactoringbefore_refactoring :
11/13/2022 03:50:16 - INFO - __main__ -   [best-bleu] bleu-4: 70.79, em: 6.1644, codebleu: 71.5498

11/13/2022 03:50:16 - INFO - __main__ -   Finish and take 3h31m
11/13/2022 03:50:16 - INFO - __main__ -     ***** Testing *****
11/13/2022 03:50:16 - INFO - __main__ -     Batch size = 64
11/13/2022 03:50:16 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 03:50:16 - INFO - __main__ -   test11111111111
11/13/2022 03:50:16 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 03:50:16 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/boolean_exchange/after_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/boolean_exchange/after_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 03:50:16 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 03:50:16 - INFO - utils -   Read 146 examples, avg src len: 67, avg trg len: 66, max src len: 111, max trg len: 108
11/13/2022 03:50:16 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/local_variable_renaming_20221113_022450/method_renaming_20221113_022903/method_renaming_20221113_025247/parameter_renaming_20221113_031624/parameter_renaming_20221113_033249/boolean_exchange_20221113_034941/boolean_exchange_20221113_035016/test_src_all.pt
11/13/2022 03:50:16 - INFO - utils -   加载前test666666666666666
ngram match: 0.7078488206401912, weighted ngram match: 0.7295148319996927, syntax_match: 0.7649583766909469, dataflow_match: 0.6596688350088705
  0%|          | 0/146 [00:00<?, ?it/s] 51%|█████     | 74/146 [00:00<00:00, 283.35it/s] 76%|███████▌  | 111/146 [00:00<00:00, 296.52it/s]100%|██████████| 146/146 [00:00<00:00, 385.82it/s]
11/13/2022 03:50:16 - INFO - utils -   加载后test77777777777777
11/13/2022 03:50:16 - INFO - __main__ -   加载成功test2222222222
11/13/2022 03:50:16 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 03:50:16 - INFO - __main__ -     Num examples = 146
11/13/2022 03:50:16 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/3 [00:00<?, ?it/s]Eval bleu for test set:  33%|███▎      | 1/3 [00:11<00:22, 11.12s/it]Eval bleu for test set:  67%|██████▋   | 2/3 [00:21<00:10, 10.97s/it]Eval bleu for test set: 100%|██████████| 3/3 [00:25<00:00,  7.64s/it]Eval bleu for test set: 100%|██████████| 3/3 [00:25<00:00,  8.58s/it]
11/13/2022 03:50:51 - INFO - __main__ -   ***** Eval results *****
11/13/2022 03:50:51 - INFO - __main__ -     bleu = 61.86
11/13/2022 03:50:51 - INFO - __main__ -     codebleu = 65.9314
11/13/2022 03:50:51 - INFO - __main__ -     em = 0.6849
11/13/2022 03:50:51 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typeboolean_exchange + whether_refactoringafter_refactoring :
11/13/2022 03:50:51 - INFO - __main__ -   [best-bleu] bleu-4: 61.86, em: 0.6849, codebleu: 65.9314

11/13/2022 03:50:51 - INFO - __main__ -   Finish and take 3h32m
11/13/2022 03:50:51 - INFO - __main__ -     ***** Testing *****
11/13/2022 03:50:51 - INFO - __main__ -     Batch size = 64
11/13/2022 03:50:51 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 03:50:51 - INFO - __main__ -   test11111111111
11/13/2022 03:50:51 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 03:50:51 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/convert_switch_to_if/before_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/convert_switch_to_if/before_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 03:50:51 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 03:50:51 - INFO - utils -   Read 166 examples, avg src len: 77, avg trg len: 76, max src len: 292, max trg len: 233
11/13/2022 03:50:51 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/local_variable_renaming_20221113_022450/method_renaming_20221113_022903/method_renaming_20221113_025247/parameter_renaming_20221113_031624/parameter_renaming_20221113_033249/boolean_exchange_20221113_034941/boolean_exchange_20221113_035016/convert_switch_to_if_20221113_035051/test_src_all.pt
11/13/2022 03:50:51 - INFO - utils -   加载前test666666666666666
ngram match: 0.618607165050097, weighted ngram match: 0.6379713742910628, syntax_match: 0.7437253937007874, dataflow_match: 0.6369539551357734
  0%|          | 0/166 [00:00<?, ?it/s] 51%|█████     | 84/166 [00:00<00:00, 314.05it/s] 76%|███████▌  | 126/166 [00:00<00:00, 333.75it/s]100%|██████████| 166/166 [00:00<00:00, 433.66it/s]
11/13/2022 03:50:52 - INFO - utils -   加载后test77777777777777
11/13/2022 03:50:52 - INFO - __main__ -   加载成功test2222222222
11/13/2022 03:50:52 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 03:50:52 - INFO - __main__ -     Num examples = 166
11/13/2022 03:50:52 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/3 [00:00<?, ?it/s]Eval bleu for test set:  33%|███▎      | 1/3 [00:11<00:22, 11.21s/it]Eval bleu for test set:  67%|██████▋   | 2/3 [00:21<00:10, 10.96s/it]Eval bleu for test set: 100%|██████████| 3/3 [00:28<00:00,  9.07s/it]Eval bleu for test set: 100%|██████████| 3/3 [00:28<00:00,  9.63s/it]
11/13/2022 03:51:30 - INFO - __main__ -   ***** Eval results *****
11/13/2022 03:51:30 - INFO - __main__ -     bleu = 70.16
11/13/2022 03:51:30 - INFO - __main__ -     codebleu = 72.0938
11/13/2022 03:51:30 - INFO - __main__ -     em = 4.8193
11/13/2022 03:51:30 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typeconvert_switch_to_if + whether_refactoringbefore_refactoring :
11/13/2022 03:51:30 - INFO - __main__ -   [best-bleu] bleu-4: 70.16, em: 4.8193, codebleu: 72.0938

11/13/2022 03:51:30 - INFO - __main__ -   Finish and take 3h32m
11/13/2022 03:51:30 - INFO - __main__ -     ***** Testing *****
11/13/2022 03:51:30 - INFO - __main__ -     Batch size = 64
11/13/2022 03:51:30 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 03:51:30 - INFO - __main__ -   test11111111111
11/13/2022 03:51:30 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 03:51:30 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/convert_switch_to_if/after_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/convert_switch_to_if/after_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 03:51:30 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 03:51:30 - INFO - utils -   Read 166 examples, avg src len: 79, avg trg len: 77, max src len: 299, max trg len: 253
11/13/2022 03:51:30 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/local_variable_renaming_20221113_022450/method_renaming_20221113_022903/method_renaming_20221113_025247/parameter_renaming_20221113_031624/parameter_renaming_20221113_033249/boolean_exchange_20221113_034941/boolean_exchange_20221113_035016/convert_switch_to_if_20221113_035051/convert_switch_to_if_20221113_035130/test_src_all.pt
11/13/2022 03:51:30 - INFO - utils -   加载前test666666666666666
ngram match: 0.7015839200867473, weighted ngram match: 0.7266725536999624, syntax_match: 0.810717196414018, dataflow_match: 0.6447793326157158
  0%|          | 0/166 [00:00<?, ?it/s] 51%|█████     | 84/166 [00:00<00:00, 312.12it/s] 76%|███████▌  | 126/166 [00:00<00:00, 331.30it/s]100%|██████████| 166/166 [00:00<00:00, 430.80it/s]
11/13/2022 03:51:31 - INFO - utils -   加载后test77777777777777
11/13/2022 03:51:31 - INFO - __main__ -   加载成功test2222222222
11/13/2022 03:51:31 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 03:51:31 - INFO - __main__ -     Num examples = 166
11/13/2022 03:51:31 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/3 [00:00<?, ?it/s]Eval bleu for test set:  33%|███▎      | 1/3 [00:11<00:22, 11.18s/it]Eval bleu for test set:  67%|██████▋   | 2/3 [00:21<00:10, 10.94s/it]Eval bleu for test set: 100%|██████████| 3/3 [00:28<00:00,  9.04s/it]Eval bleu for test set: 100%|██████████| 3/3 [00:28<00:00,  9.60s/it]
11/13/2022 03:52:10 - INFO - __main__ -   ***** Eval results *****
11/13/2022 03:52:10 - INFO - __main__ -     bleu = 60.5
11/13/2022 03:52:10 - INFO - __main__ -     codebleu = 66.2607
11/13/2022 03:52:10 - INFO - __main__ -     em = 1.8072
11/13/2022 03:52:10 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typeconvert_switch_to_if + whether_refactoringafter_refactoring :
11/13/2022 03:52:10 - INFO - __main__ -   [best-bleu] bleu-4: 60.50, em: 1.8072, codebleu: 66.2607

11/13/2022 03:52:10 - INFO - __main__ -   Finish and take 3h33m
11/13/2022 03:52:10 - INFO - __main__ -     ***** Testing *****
11/13/2022 03:52:10 - INFO - __main__ -     Batch size = 64
11/13/2022 03:52:10 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 03:52:10 - INFO - __main__ -   test11111111111
11/13/2022 03:52:10 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 03:52:10 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/insert_log_statement/before_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/insert_log_statement/before_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 03:52:10 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 03:52:10 - INFO - utils -   Read 6384 examples, avg src len: 74, avg trg len: 72, max src len: 292, max trg len: 233
11/13/2022 03:52:10 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/local_variable_renaming_20221113_022450/method_renaming_20221113_022903/method_renaming_20221113_025247/parameter_renaming_20221113_031624/parameter_renaming_20221113_033249/boolean_exchange_20221113_034941/boolean_exchange_20221113_035016/convert_switch_to_if_20221113_035051/convert_switch_to_if_20221113_035130/insert_log_statement_20221113_035210/test_src_all.pt
11/13/2022 03:52:10 - INFO - utils -   加载前test666666666666666
ngram match: 0.6049520444470663, weighted ngram match: 0.6321361577623851, syntax_match: 0.7902910724750928, dataflow_match: 0.623046875
  0%|          | 0/6384 [00:00<?, ?it/s] 50%|█████     | 3192/6384 [00:02<00:02, 1075.83it/s] 75%|███████▌  | 4788/6384 [00:05<00:01, 802.92it/s] 100%|██████████| 6384/6384 [00:08<00:00, 691.47it/s]100%|██████████| 6384/6384 [00:08<00:00, 750.37it/s]
11/13/2022 03:52:21 - INFO - utils -   加载后test77777777777777
11/13/2022 03:52:21 - INFO - __main__ -   加载成功test2222222222
11/13/2022 03:52:21 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 03:52:21 - INFO - __main__ -     Num examples = 6384
11/13/2022 03:52:21 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/100 [00:00<?, ?it/s]Eval bleu for test set:   1%|          | 1/100 [00:10<18:06, 10.97s/it]Eval bleu for test set:   2%|▏         | 2/100 [00:21<17:42, 10.84s/it]Eval bleu for test set:   3%|▎         | 3/100 [00:32<17:49, 11.03s/it]Eval bleu for test set:   4%|▍         | 4/100 [00:44<17:59, 11.24s/it]Eval bleu for test set:   5%|▌         | 5/100 [00:55<17:27, 11.02s/it]Eval bleu for test set:   6%|▌         | 6/100 [01:06<17:09, 10.96s/it]Eval bleu for test set:   7%|▋         | 7/100 [01:16<16:54, 10.91s/it]Eval bleu for test set:   8%|▊         | 8/100 [01:27<16:41, 10.88s/it]Eval bleu for test set:   9%|▉         | 9/100 [01:38<16:25, 10.82s/it]Eval bleu for test set:  10%|█         | 10/100 [01:49<16:12, 10.80s/it]Eval bleu for test set:  11%|█         | 11/100 [02:00<16:06, 10.86s/it]Eval bleu for test set:  12%|█▏        | 12/100 [02:11<15:57, 10.88s/it]Eval bleu for test set:  13%|█▎        | 13/100 [02:22<16:01, 11.05s/it]Eval bleu for test set:  14%|█▍        | 14/100 [02:33<15:41, 10.95s/it]Eval bleu for test set:  15%|█▌        | 15/100 [02:43<15:27, 10.91s/it]Eval bleu for test set:  16%|█▌        | 16/100 [02:54<15:11, 10.86s/it]Eval bleu for test set:  17%|█▋        | 17/100 [03:05<15:01, 10.86s/it]Eval bleu for test set:  18%|█▊        | 18/100 [03:16<14:50, 10.86s/it]Eval bleu for test set:  19%|█▉        | 19/100 [03:27<14:43, 10.91s/it]Eval bleu for test set:  20%|██        | 20/100 [03:38<14:30, 10.88s/it]Eval bleu for test set:  21%|██        | 21/100 [03:49<14:16, 10.84s/it]Eval bleu for test set:  22%|██▏       | 22/100 [03:59<14:07, 10.87s/it]Eval bleu for test set:  23%|██▎       | 23/100 [04:10<14:00, 10.92s/it]Eval bleu for test set:  24%|██▍       | 24/100 [04:21<13:46, 10.88s/it]Eval bleu for test set:  25%|██▌       | 25/100 [04:32<13:43, 10.98s/it]Eval bleu for test set:  26%|██▌       | 26/100 [04:45<14:08, 11.46s/it]Eval bleu for test set:  27%|██▋       | 27/100 [04:58<14:19, 11.78s/it]Eval bleu for test set:  28%|██▊       | 28/100 [05:10<14:24, 12.01s/it]Eval bleu for test set:  29%|██▉       | 29/100 [05:22<14:17, 12.08s/it]Eval bleu for test set:  30%|███       | 30/100 [05:33<13:43, 11.76s/it]Eval bleu for test set:  31%|███       | 31/100 [05:45<13:23, 11.65s/it]Eval bleu for test set:  32%|███▏      | 32/100 [05:57<13:30, 11.91s/it]Eval bleu for test set:  33%|███▎      | 33/100 [06:10<13:33, 12.14s/it]Eval bleu for test set:  34%|███▍      | 34/100 [06:22<13:19, 12.11s/it]Eval bleu for test set:  35%|███▌      | 35/100 [06:34<13:00, 12.01s/it]Eval bleu for test set:  36%|███▌      | 36/100 [06:45<12:28, 11.70s/it]Eval bleu for test set:  37%|███▋      | 37/100 [06:56<11:59, 11.41s/it]Eval bleu for test set:  38%|███▊      | 38/100 [07:06<11:34, 11.21s/it]Eval bleu for test set:  39%|███▉      | 39/100 [07:17<11:16, 11.09s/it]Eval bleu for test set:  40%|████      | 40/100 [07:28<11:00, 11.01s/it]Eval bleu for test set:  41%|████      | 41/100 [07:39<10:42, 10.89s/it]Eval bleu for test set:  42%|████▏     | 42/100 [07:49<10:29, 10.86s/it]Eval bleu for test set:  43%|████▎     | 43/100 [08:00<10:16, 10.81s/it]Eval bleu for test set:  44%|████▍     | 44/100 [08:11<10:04, 10.79s/it]Eval bleu for test set:  45%|████▌     | 45/100 [08:22<09:55, 10.82s/it]Eval bleu for test set:  46%|████▌     | 46/100 [08:33<09:50, 10.93s/it]Eval bleu for test set:  47%|████▋     | 47/100 [08:44<09:37, 10.90s/it]Eval bleu for test set:  48%|████▊     | 48/100 [08:55<09:28, 10.93s/it]Eval bleu for test set:  49%|████▉     | 49/100 [09:05<09:14, 10.87s/it]Eval bleu for test set:  50%|█████     | 50/100 [09:16<09:05, 10.92s/it]Eval bleu for test set:  51%|█████     | 51/100 [09:27<08:54, 10.90s/it]Eval bleu for test set:  52%|█████▏    | 52/100 [09:38<08:42, 10.90s/it]Eval bleu for test set:  53%|█████▎    | 53/100 [09:49<08:36, 11.00s/it]Eval bleu for test set:  54%|█████▍    | 54/100 [10:00<08:26, 11.00s/it]Eval bleu for test set:  55%|█████▌    | 55/100 [10:11<08:12, 10.95s/it]Eval bleu for test set:  56%|█████▌    | 56/100 [10:22<08:00, 10.93s/it]Eval bleu for test set:  57%|█████▋    | 57/100 [10:33<07:50, 10.93s/it]Eval bleu for test set:  58%|█████▊    | 58/100 [10:44<07:41, 10.98s/it]Eval bleu for test set:  59%|█████▉    | 59/100 [10:55<07:31, 11.02s/it]Eval bleu for test set:  60%|██████    | 60/100 [11:06<07:20, 11.00s/it]Eval bleu for test set:  61%|██████    | 61/100 [11:17<07:06, 10.94s/it]Eval bleu for test set:  62%|██████▏   | 62/100 [11:28<06:53, 10.87s/it]Eval bleu for test set:  63%|██████▎   | 63/100 [11:39<06:42, 10.87s/it]Eval bleu for test set:  64%|██████▍   | 64/100 [11:49<06:30, 10.84s/it]Eval bleu for test set:  65%|██████▌   | 65/100 [12:00<06:20, 10.87s/it]Eval bleu for test set:  66%|██████▌   | 66/100 [12:11<06:08, 10.85s/it]Eval bleu for test set:  67%|██████▋   | 67/100 [12:22<05:58, 10.86s/it]Eval bleu for test set:  68%|██████▊   | 68/100 [12:33<05:50, 10.95s/it]Eval bleu for test set:  69%|██████▉   | 69/100 [12:44<05:38, 10.93s/it]Eval bleu for test set:  70%|███████   | 70/100 [12:55<05:26, 10.87s/it]Eval bleu for test set:  71%|███████   | 71/100 [13:06<05:18, 10.98s/it]Eval bleu for test set:  72%|███████▏  | 72/100 [13:17<05:06, 10.95s/it]Eval bleu for test set:  73%|███████▎  | 73/100 [13:28<04:54, 10.91s/it]Eval bleu for test set:  74%|███████▍  | 74/100 [13:39<04:43, 10.92s/it]Eval bleu for test set:  75%|███████▌  | 75/100 [13:49<04:32, 10.89s/it]Eval bleu for test set:  76%|███████▌  | 76/100 [14:00<04:21, 10.89s/it]Eval bleu for test set:  77%|███████▋  | 77/100 [14:11<04:09, 10.83s/it]Eval bleu for test set:  78%|███████▊  | 78/100 [14:22<03:58, 10.85s/it]Eval bleu for test set:  79%|███████▉  | 79/100 [14:33<03:48, 10.89s/it]Eval bleu for test set:  80%|████████  | 80/100 [14:45<03:45, 11.27s/it]Eval bleu for test set:  81%|████████  | 81/100 [14:56<03:31, 11.12s/it]Eval bleu for test set:  82%|████████▏ | 82/100 [15:07<03:18, 11.01s/it]Eval bleu for test set:  83%|████████▎ | 83/100 [15:17<03:05, 10.92s/it]Eval bleu for test set:  84%|████████▍ | 84/100 [15:28<02:53, 10.87s/it]Eval bleu for test set:  85%|████████▌ | 85/100 [15:39<02:43, 10.92s/it]Eval bleu for test set:  86%|████████▌ | 86/100 [15:50<02:32, 10.90s/it]Eval bleu for test set:  87%|████████▋ | 87/100 [16:01<02:22, 10.95s/it]Eval bleu for test set:  88%|████████▊ | 88/100 [16:12<02:11, 10.93s/it]Eval bleu for test set:  89%|████████▉ | 89/100 [16:23<02:01, 11.01s/it]Eval bleu for test set:  90%|█████████ | 90/100 [16:34<01:50, 11.00s/it]Eval bleu for test set:  91%|█████████ | 91/100 [16:45<01:38, 10.92s/it]Eval bleu for test set:  92%|█████████▏| 92/100 [16:56<01:27, 10.92s/it]Eval bleu for test set:  93%|█████████▎| 93/100 [17:07<01:16, 10.96s/it]Eval bleu for test set:  94%|█████████▍| 94/100 [17:18<01:05, 10.92s/it]Eval bleu for test set:  95%|█████████▌| 95/100 [17:28<00:54, 10.91s/it]Eval bleu for test set:  96%|█████████▌| 96/100 [17:39<00:43, 10.85s/it]Eval bleu for test set:  97%|█████████▋| 97/100 [17:50<00:32, 10.80s/it]Eval bleu for test set:  98%|█████████▊| 98/100 [18:01<00:21, 10.90s/it]Eval bleu for test set:  99%|█████████▉| 99/100 [18:13<00:11, 11.33s/it]Eval bleu for test set: 100%|██████████| 100/100 [18:22<00:00, 10.45s/it]Eval bleu for test set: 100%|██████████| 100/100 [18:22<00:00, 11.02s/it]
11/13/2022 04:16:42 - INFO - __main__ -   ***** Eval results *****
11/13/2022 04:16:42 - INFO - __main__ -     bleu = 70.46
11/13/2022 04:16:42 - INFO - __main__ -     codebleu = 71.2598
11/13/2022 04:16:42 - INFO - __main__ -     em = 5.4355
11/13/2022 04:16:42 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typeinsert_log_statement + whether_refactoringbefore_refactoring :
11/13/2022 04:16:42 - INFO - __main__ -   [best-bleu] bleu-4: 70.46, em: 5.4355, codebleu: 71.2598

11/13/2022 04:16:42 - INFO - __main__ -   Finish and take 3h57m
11/13/2022 04:16:42 - INFO - __main__ -     ***** Testing *****
11/13/2022 04:16:42 - INFO - __main__ -     Batch size = 64
11/13/2022 04:16:42 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 04:16:42 - INFO - __main__ -   test11111111111
11/13/2022 04:16:42 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 04:16:42 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/insert_log_statement/after_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/insert_log_statement/after_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 04:16:42 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 04:16:42 - INFO - utils -   Read 6384 examples, avg src len: 65, avg trg len: 64, max src len: 269, max trg len: 223
11/13/2022 04:16:42 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/local_variable_renaming_20221113_022450/method_renaming_20221113_022903/method_renaming_20221113_025247/parameter_renaming_20221113_031624/parameter_renaming_20221113_033249/boolean_exchange_20221113_034941/boolean_exchange_20221113_035016/convert_switch_to_if_20221113_035051/convert_switch_to_if_20221113_035130/insert_log_statement_20221113_035210/insert_log_statement_20221113_041642/test_src_all.pt
11/13/2022 04:16:42 - INFO - utils -   加载前test666666666666666
ngram match: 0.7046160449738377, weighted ngram match: 0.7248522086647942, syntax_match: 0.7891775077640862, dataflow_match: 0.6317471614310474
  0%|          | 0/6384 [00:00<?, ?it/s] 50%|█████     | 3192/6384 [00:03<00:03, 1049.78it/s] 75%|███████▌  | 4788/6384 [00:06<00:02, 751.83it/s] 100%|██████████| 6384/6384 [00:08<00:00, 652.31it/s]100%|██████████| 6384/6384 [00:08<00:00, 709.46it/s]
11/13/2022 04:16:54 - INFO - utils -   加载后test77777777777777
11/13/2022 04:16:54 - INFO - __main__ -   加载成功test2222222222
11/13/2022 04:16:54 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 04:16:54 - INFO - __main__ -     Num examples = 6384
11/13/2022 04:16:54 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/100 [00:00<?, ?it/s]Eval bleu for test set:   1%|          | 1/100 [00:10<18:08, 11.00s/it]Eval bleu for test set:   2%|▏         | 2/100 [00:21<17:45, 10.88s/it]Eval bleu for test set:   3%|▎         | 3/100 [00:32<17:31, 10.84s/it]Eval bleu for test set:   4%|▍         | 4/100 [00:43<17:20, 10.84s/it]Eval bleu for test set:   5%|▌         | 5/100 [00:54<17:07, 10.81s/it]Eval bleu for test set:   6%|▌         | 6/100 [01:05<16:56, 10.82s/it]Eval bleu for test set:   7%|▋         | 7/100 [01:15<16:48, 10.85s/it]Eval bleu for test set:   8%|▊         | 8/100 [01:26<16:37, 10.84s/it]Eval bleu for test set:   9%|▉         | 9/100 [01:37<16:20, 10.77s/it]Eval bleu for test set:  10%|█         | 10/100 [01:48<16:08, 10.76s/it]Eval bleu for test set:  11%|█         | 11/100 [01:58<15:57, 10.76s/it]Eval bleu for test set:  12%|█▏        | 12/100 [02:09<15:48, 10.78s/it]Eval bleu for test set:  13%|█▎        | 13/100 [02:20<15:34, 10.74s/it]Eval bleu for test set:  14%|█▍        | 14/100 [02:31<15:34, 10.87s/it]Eval bleu for test set:  15%|█▌        | 15/100 [02:42<15:17, 10.80s/it]Eval bleu for test set:  16%|█▌        | 16/100 [02:53<15:13, 10.87s/it]Eval bleu for test set:  17%|█▋        | 17/100 [03:04<15:02, 10.87s/it]Eval bleu for test set:  18%|█▊        | 18/100 [03:14<14:47, 10.82s/it]Eval bleu for test set:  19%|█▉        | 19/100 [03:25<14:37, 10.83s/it]Eval bleu for test set:  20%|██        | 20/100 [03:37<14:41, 11.02s/it]Eval bleu for test set:  21%|██        | 21/100 [03:47<14:25, 10.96s/it]Eval bleu for test set:  22%|██▏       | 22/100 [03:58<14:10, 10.90s/it]Eval bleu for test set:  23%|██▎       | 23/100 [04:09<13:57, 10.88s/it]Eval bleu for test set:  24%|██▍       | 24/100 [04:20<13:41, 10.81s/it]Eval bleu for test set:  25%|██▌       | 25/100 [04:30<13:28, 10.79s/it]Eval bleu for test set:  26%|██▌       | 26/100 [04:41<13:17, 10.78s/it]Eval bleu for test set:  27%|██▋       | 27/100 [04:52<13:12, 10.86s/it]Eval bleu for test set:  28%|██▊       | 28/100 [05:03<13:02, 10.86s/it]Eval bleu for test set:  29%|██▉       | 29/100 [05:14<12:50, 10.85s/it]Eval bleu for test set:  30%|███       | 30/100 [05:25<12:39, 10.84s/it]Eval bleu for test set:  31%|███       | 31/100 [05:36<12:31, 10.89s/it]Eval bleu for test set:  32%|███▏      | 32/100 [05:47<12:19, 10.88s/it]Eval bleu for test set:  33%|███▎      | 33/100 [05:57<12:08, 10.87s/it]Eval bleu for test set:  34%|███▍      | 34/100 [06:08<12:00, 10.92s/it]Eval bleu for test set:  35%|███▌      | 35/100 [06:19<11:45, 10.86s/it]Eval bleu for test set:  36%|███▌      | 36/100 [06:30<11:33, 10.83s/it]Eval bleu for test set:  37%|███▋      | 37/100 [06:41<11:23, 10.85s/it]Eval bleu for test set:  38%|███▊      | 38/100 [06:51<11:08, 10.79s/it]Eval bleu for test set:  39%|███▉      | 39/100 [07:02<10:57, 10.77s/it]Eval bleu for test set:  40%|████      | 40/100 [07:13<10:46, 10.78s/it]Eval bleu for test set:  41%|████      | 41/100 [07:24<10:32, 10.72s/it]Eval bleu for test set:  42%|████▏     | 42/100 [07:34<10:25, 10.78s/it]Eval bleu for test set:  43%|████▎     | 43/100 [07:45<10:17, 10.84s/it]Eval bleu for test set:  44%|████▍     | 44/100 [07:56<10:05, 10.82s/it]Eval bleu for test set:  45%|████▌     | 45/100 [08:07<09:51, 10.76s/it]Eval bleu for test set:  46%|████▌     | 46/100 [08:18<09:43, 10.81s/it]Eval bleu for test set:  47%|████▋     | 47/100 [08:29<09:34, 10.83s/it]Eval bleu for test set:  48%|████▊     | 48/100 [08:40<09:25, 10.88s/it]Eval bleu for test set:  49%|████▉     | 49/100 [08:50<09:10, 10.79s/it]Eval bleu for test set:  50%|█████     | 50/100 [09:01<08:58, 10.77s/it]Eval bleu for test set:  51%|█████     | 51/100 [09:12<08:49, 10.81s/it]Eval bleu for test set:  52%|█████▏    | 52/100 [09:23<08:40, 10.84s/it]Eval bleu for test set:  53%|█████▎    | 53/100 [09:34<08:32, 10.90s/it]Eval bleu for test set:  54%|█████▍    | 54/100 [09:45<08:19, 10.85s/it]Eval bleu for test set:  55%|█████▌    | 55/100 [09:55<08:05, 10.78s/it]Eval bleu for test set:  56%|█████▌    | 56/100 [10:06<07:53, 10.76s/it]Eval bleu for test set:  57%|█████▋    | 57/100 [10:17<07:44, 10.80s/it]Eval bleu for test set:  58%|█████▊    | 58/100 [10:28<07:37, 10.88s/it]Eval bleu for test set:  59%|█████▉    | 59/100 [10:39<07:30, 10.99s/it]Eval bleu for test set:  60%|██████    | 60/100 [10:50<07:18, 10.97s/it]Eval bleu for test set:  61%|██████    | 61/100 [11:01<07:05, 10.90s/it]Eval bleu for test set:  62%|██████▏   | 62/100 [11:11<06:51, 10.83s/it]Eval bleu for test set:  63%|██████▎   | 63/100 [11:22<06:42, 10.87s/it]Eval bleu for test set:  64%|██████▍   | 64/100 [11:34<06:35, 10.98s/it]Eval bleu for test set:  65%|██████▌   | 65/100 [11:44<06:22, 10.93s/it]Eval bleu for test set:  66%|██████▌   | 66/100 [11:55<06:10, 10.90s/it]Eval bleu for test set:  67%|██████▋   | 67/100 [12:06<06:01, 10.94s/it]Eval bleu for test set:  68%|██████▊   | 68/100 [12:17<05:48, 10.91s/it]Eval bleu for test set:  69%|██████▉   | 69/100 [12:28<05:36, 10.84s/it]Eval bleu for test set:  70%|███████   | 70/100 [12:39<05:25, 10.85s/it]Eval bleu for test set:  71%|███████   | 71/100 [12:49<05:14, 10.84s/it]Eval bleu for test set:  72%|███████▏  | 72/100 [13:00<05:04, 10.87s/it]Eval bleu for test set:  73%|███████▎  | 73/100 [13:11<04:53, 10.86s/it]Eval bleu for test set:  74%|███████▍  | 74/100 [13:22<04:41, 10.83s/it]Eval bleu for test set:  75%|███████▌  | 75/100 [13:33<04:28, 10.76s/it]Eval bleu for test set:  76%|███████▌  | 76/100 [13:43<04:18, 10.76s/it]Eval bleu for test set:  77%|███████▋  | 77/100 [13:55<04:11, 10.94s/it]Eval bleu for test set:  78%|███████▊  | 78/100 [14:06<04:00, 10.94s/it]Eval bleu for test set:  79%|███████▉  | 79/100 [14:18<03:58, 11.37s/it]Eval bleu for test set:  80%|████████  | 80/100 [14:29<03:43, 11.19s/it]Eval bleu for test set:  81%|████████  | 81/100 [14:39<03:29, 11.04s/it]Eval bleu for test set:  82%|████████▏ | 82/100 [14:50<03:15, 10.85s/it]Eval bleu for test set:  83%|████████▎ | 83/100 [15:01<03:04, 10.87s/it]Eval bleu for test set:  84%|████████▍ | 84/100 [15:12<02:53, 10.87s/it]Eval bleu for test set:  85%|████████▌ | 85/100 [15:23<02:43, 10.87s/it]Eval bleu for test set:  86%|████████▌ | 86/100 [15:34<02:32, 10.90s/it]Eval bleu for test set:  87%|████████▋ | 87/100 [15:44<02:20, 10.83s/it]Eval bleu for test set:  88%|████████▊ | 88/100 [15:55<02:09, 10.80s/it]Eval bleu for test set:  89%|████████▉ | 89/100 [16:06<01:58, 10.80s/it]Eval bleu for test set:  90%|█████████ | 90/100 [16:17<01:47, 10.80s/it]Eval bleu for test set:  91%|█████████ | 91/100 [16:27<01:36, 10.75s/it]Eval bleu for test set:  92%|█████████▏| 92/100 [16:38<01:26, 10.83s/it]Eval bleu for test set:  93%|█████████▎| 93/100 [16:49<01:15, 10.85s/it]Eval bleu for test set:  94%|█████████▍| 94/100 [17:00<01:05, 10.96s/it]Eval bleu for test set:  95%|█████████▌| 95/100 [17:12<00:55, 11.16s/it]Eval bleu for test set:  96%|█████████▌| 96/100 [17:24<00:46, 11.57s/it]Eval bleu for test set:  97%|█████████▋| 97/100 [17:37<00:35, 11.87s/it]Eval bleu for test set:  98%|█████████▊| 98/100 [17:50<00:24, 12.06s/it]Eval bleu for test set:  99%|█████████▉| 99/100 [18:02<00:12, 12.16s/it]Eval bleu for test set: 100%|██████████| 100/100 [18:12<00:00, 11.40s/it]Eval bleu for test set: 100%|██████████| 100/100 [18:12<00:00, 10.92s/it]
11/13/2022 04:41:03 - INFO - __main__ -   ***** Eval results *****
11/13/2022 04:41:03 - INFO - __main__ -     bleu = 58.89
11/13/2022 04:41:03 - INFO - __main__ -     codebleu = 64.4181
11/13/2022 04:41:03 - INFO - __main__ -     em = 0.0157
11/13/2022 04:41:03 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typeinsert_log_statement + whether_refactoringafter_refactoring :
11/13/2022 04:41:03 - INFO - __main__ -   [best-bleu] bleu-4: 58.89, em: 0.0157, codebleu: 64.4181

11/13/2022 04:41:03 - INFO - __main__ -   Finish and take 4h22m
11/13/2022 04:41:03 - INFO - __main__ -     ***** Testing *****
11/13/2022 04:41:03 - INFO - __main__ -     Batch size = 64
11/13/2022 04:41:03 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 04:41:04 - INFO - __main__ -   test11111111111
11/13/2022 04:41:04 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 04:41:04 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/insert_try_catch/before_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/insert_try_catch/before_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 04:41:04 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 04:41:04 - INFO - utils -   Read 5073 examples, avg src len: 74, avg trg len: 72, max src len: 194, max trg len: 190
11/13/2022 04:41:04 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/local_variable_renaming_20221113_022450/method_renaming_20221113_022903/method_renaming_20221113_025247/parameter_renaming_20221113_031624/parameter_renaming_20221113_033249/boolean_exchange_20221113_034941/boolean_exchange_20221113_035016/convert_switch_to_if_20221113_035051/convert_switch_to_if_20221113_035130/insert_log_statement_20221113_035210/insert_log_statement_20221113_041642/insert_try_catch_20221113_044103/test_src_all.pt
11/13/2022 04:41:04 - INFO - utils -   加载前test666666666666666
ngram match: 0.5889193252686763, weighted ngram match: 0.6176205564105445, syntax_match: 0.7513252061135465, dataflow_match: 0.6188591294384188
  0%|          | 0/5073 [00:00<?, ?it/s] 50%|█████     | 2538/5073 [00:02<00:02, 1029.22it/s] 75%|███████▌  | 3807/5073 [00:04<00:01, 753.69it/s] 100%|██████████| 5073/5073 [00:04<00:00, 1060.73it/s]
11/13/2022 04:41:13 - INFO - utils -   加载后test77777777777777
11/13/2022 04:41:13 - INFO - __main__ -   加载成功test2222222222
11/13/2022 04:41:13 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 04:41:13 - INFO - __main__ -     Num examples = 5073
11/13/2022 04:41:13 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/80 [00:00<?, ?it/s]Eval bleu for test set:   1%|▏         | 1/80 [00:10<14:23, 10.93s/it]Eval bleu for test set:   2%|▎         | 2/80 [00:21<14:03, 10.82s/it]Eval bleu for test set:   4%|▍         | 3/80 [00:32<13:49, 10.78s/it]Eval bleu for test set:   5%|▌         | 4/80 [00:43<13:41, 10.81s/it]Eval bleu for test set:   6%|▋         | 5/80 [00:54<13:51, 11.08s/it]Eval bleu for test set:   8%|▊         | 6/80 [01:05<13:32, 10.98s/it]Eval bleu for test set:   9%|▉         | 7/80 [01:16<13:18, 10.94s/it]Eval bleu for test set:  10%|█         | 8/80 [01:27<13:05, 10.91s/it]Eval bleu for test set:  11%|█▏        | 9/80 [01:38<12:51, 10.86s/it]Eval bleu for test set:  12%|█▎        | 10/80 [01:48<12:41, 10.88s/it]Eval bleu for test set:  14%|█▍        | 11/80 [01:59<12:30, 10.87s/it]Eval bleu for test set:  15%|█▌        | 12/80 [02:10<12:14, 10.81s/it]Eval bleu for test set:  16%|█▋        | 13/80 [02:21<12:02, 10.79s/it]Eval bleu for test set:  18%|█▊        | 14/80 [02:32<12:06, 11.01s/it]Eval bleu for test set:  19%|█▉        | 15/80 [02:45<12:24, 11.46s/it]Eval bleu for test set:  20%|██        | 16/80 [02:56<12:10, 11.42s/it]Eval bleu for test set:  21%|██▏       | 17/80 [03:07<11:46, 11.21s/it]Eval bleu for test set:  22%|██▎       | 18/80 [03:18<11:28, 11.10s/it]Eval bleu for test set:  24%|██▍       | 19/80 [03:28<11:10, 10.98s/it]Eval bleu for test set:  25%|██▌       | 20/80 [03:39<10:52, 10.87s/it]Eval bleu for test set:  26%|██▋       | 21/80 [03:50<10:37, 10.80s/it]Eval bleu for test set:  28%|██▊       | 22/80 [04:00<10:25, 10.79s/it]Eval bleu for test set:  29%|██▉       | 23/80 [04:11<10:17, 10.83s/it]Eval bleu for test set:  30%|███       | 24/80 [04:22<10:09, 10.88s/it]Eval bleu for test set:  31%|███▏      | 25/80 [04:33<09:59, 10.90s/it]Eval bleu for test set:  32%|███▎      | 26/80 [04:44<09:46, 10.86s/it]Eval bleu for test set:  34%|███▍      | 27/80 [04:56<09:49, 11.12s/it]Eval bleu for test set:  35%|███▌      | 28/80 [05:08<09:50, 11.35s/it]Eval bleu for test set:  36%|███▋      | 29/80 [05:19<09:34, 11.26s/it]Eval bleu for test set:  38%|███▊      | 30/80 [05:31<09:40, 11.61s/it]Eval bleu for test set:  39%|███▉      | 31/80 [05:43<09:40, 11.85s/it]Eval bleu for test set:  40%|████      | 32/80 [05:54<09:14, 11.55s/it]Eval bleu for test set:  41%|████▏     | 33/80 [06:06<08:57, 11.44s/it]Eval bleu for test set:  42%|████▎     | 34/80 [06:16<08:39, 11.29s/it]Eval bleu for test set:  44%|████▍     | 35/80 [06:27<08:20, 11.11s/it]Eval bleu for test set:  45%|████▌     | 36/80 [06:38<08:07, 11.08s/it]Eval bleu for test set:  46%|████▋     | 37/80 [06:49<07:54, 11.04s/it]Eval bleu for test set:  48%|████▊     | 38/80 [07:00<07:40, 10.96s/it]Eval bleu for test set:  49%|████▉     | 39/80 [07:11<07:26, 10.89s/it]Eval bleu for test set:  50%|█████     | 40/80 [07:21<07:14, 10.85s/it]Eval bleu for test set:  51%|█████▏    | 41/80 [07:32<07:02, 10.84s/it]Eval bleu for test set:  52%|█████▎    | 42/80 [07:43<06:52, 10.86s/it]Eval bleu for test set:  54%|█████▍    | 43/80 [07:54<06:41, 10.84s/it]Eval bleu for test set:  55%|█████▌    | 44/80 [08:05<06:29, 10.82s/it]Eval bleu for test set:  56%|█████▋    | 45/80 [08:16<06:19, 10.83s/it]Eval bleu for test set:  57%|█████▊    | 46/80 [08:28<06:21, 11.23s/it]Eval bleu for test set:  59%|█████▉    | 47/80 [08:40<06:20, 11.53s/it]Eval bleu for test set:  60%|██████    | 48/80 [08:51<06:01, 11.30s/it]Eval bleu for test set:  61%|██████▏   | 49/80 [09:02<05:46, 11.18s/it]Eval bleu for test set:  62%|██████▎   | 50/80 [09:12<05:31, 11.06s/it]Eval bleu for test set:  64%|██████▍   | 51/80 [09:23<05:18, 10.97s/it]Eval bleu for test set:  65%|██████▌   | 52/80 [09:34<05:07, 10.97s/it]Eval bleu for test set:  66%|██████▋   | 53/80 [09:45<04:55, 10.94s/it]Eval bleu for test set:  68%|██████▊   | 54/80 [09:56<04:43, 10.89s/it]Eval bleu for test set:  69%|██████▉   | 55/80 [10:07<04:31, 10.86s/it]Eval bleu for test set:  70%|███████   | 56/80 [10:17<04:21, 10.89s/it]Eval bleu for test set:  71%|███████▏  | 57/80 [10:28<04:09, 10.84s/it]Eval bleu for test set:  72%|███████▎  | 58/80 [10:39<03:57, 10.81s/it]Eval bleu for test set:  74%|███████▍  | 59/80 [10:50<03:46, 10.78s/it]Eval bleu for test set:  75%|███████▌  | 60/80 [11:00<03:35, 10.78s/it]Eval bleu for test set:  76%|███████▋  | 61/80 [11:11<03:25, 10.81s/it]Eval bleu for test set:  78%|███████▊  | 62/80 [11:22<03:14, 10.82s/it]Eval bleu for test set:  79%|███████▉  | 63/80 [11:33<03:04, 10.83s/it]Eval bleu for test set:  80%|████████  | 64/80 [11:44<02:54, 10.89s/it]Eval bleu for test set:  81%|████████▏ | 65/80 [11:55<02:42, 10.81s/it]Eval bleu for test set:  82%|████████▎ | 66/80 [12:05<02:30, 10.75s/it]Eval bleu for test set:  84%|████████▍ | 67/80 [12:16<02:19, 10.75s/it]Eval bleu for test set:  85%|████████▌ | 68/80 [12:27<02:08, 10.72s/it]Eval bleu for test set:  86%|████████▋ | 69/80 [12:38<01:58, 10.76s/it]Eval bleu for test set:  88%|████████▊ | 70/80 [12:49<01:48, 10.87s/it]Eval bleu for test set:  89%|████████▉ | 71/80 [13:00<01:37, 10.87s/it]Eval bleu for test set:  90%|█████████ | 72/80 [13:10<01:26, 10.84s/it]Eval bleu for test set:  91%|█████████▏| 73/80 [13:21<01:15, 10.81s/it]Eval bleu for test set:  92%|█████████▎| 74/80 [13:32<01:04, 10.81s/it]Eval bleu for test set:  94%|█████████▍| 75/80 [13:42<00:53, 10.75s/it]Eval bleu for test set:  95%|█████████▌| 76/80 [13:53<00:43, 10.81s/it]Eval bleu for test set:  96%|█████████▋| 77/80 [14:04<00:32, 10.77s/it]Eval bleu for test set:  98%|█████████▊| 78/80 [14:15<00:21, 10.80s/it]Eval bleu for test set:  99%|█████████▉| 79/80 [14:26<00:10, 10.85s/it]Eval bleu for test set: 100%|██████████| 80/80 [14:30<00:00,  8.68s/it]Eval bleu for test set: 100%|██████████| 80/80 [14:30<00:00, 10.88s/it]
11/13/2022 05:00:29 - INFO - __main__ -   ***** Eval results *****
11/13/2022 05:00:29 - INFO - __main__ -     bleu = 70.46
11/13/2022 05:00:29 - INFO - __main__ -     codebleu = 71.3484
11/13/2022 05:00:29 - INFO - __main__ -     em = 5.2829
11/13/2022 05:00:29 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typeinsert_try_catch + whether_refactoringbefore_refactoring :
11/13/2022 05:00:29 - INFO - __main__ -   [best-bleu] bleu-4: 70.46, em: 5.2829, codebleu: 71.3484

11/13/2022 05:00:29 - INFO - __main__ -   Finish and take 4h41m
11/13/2022 05:00:29 - INFO - __main__ -     ***** Testing *****
11/13/2022 05:00:29 - INFO - __main__ -     Batch size = 64
11/13/2022 05:00:29 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 05:00:29 - INFO - __main__ -   test11111111111
11/13/2022 05:00:29 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 05:00:29 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/insert_try_catch/after_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/insert_try_catch/after_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 05:00:29 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 05:00:29 - INFO - utils -   Read 5073 examples, avg src len: 72, avg trg len: 71, max src len: 194, max trg len: 185
11/13/2022 05:00:29 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/local_variable_renaming_20221113_022450/method_renaming_20221113_022903/method_renaming_20221113_025247/parameter_renaming_20221113_031624/parameter_renaming_20221113_033249/boolean_exchange_20221113_034941/boolean_exchange_20221113_035016/convert_switch_to_if_20221113_035051/convert_switch_to_if_20221113_035130/insert_log_statement_20221113_035210/insert_log_statement_20221113_041642/insert_try_catch_20221113_044103/insert_try_catch_20221113_050029/test_src_all.pt
11/13/2022 05:00:29 - INFO - utils -   加载前test666666666666666
ngram match: 0.7046155430974911, weighted ngram match: 0.7249335943207212, syntax_match: 0.7909333139988036, dataflow_match: 0.6334535243095942
  0%|          | 0/5073 [00:00<?, ?it/s] 50%|█████     | 2538/5073 [00:02<00:02, 999.15it/s] 75%|███████▌  | 3807/5073 [00:05<00:01, 717.29it/s]100%|██████████| 5073/5073 [00:05<00:00, 1012.64it/s]
11/13/2022 05:00:39 - INFO - utils -   加载后test77777777777777
11/13/2022 05:00:39 - INFO - __main__ -   加载成功test2222222222
11/13/2022 05:00:39 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 05:00:39 - INFO - __main__ -     Num examples = 5073
11/13/2022 05:00:39 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/80 [00:00<?, ?it/s]Eval bleu for test set:   1%|▏         | 1/80 [00:11<14:49, 11.26s/it]Eval bleu for test set:   2%|▎         | 2/80 [00:22<14:30, 11.16s/it]Eval bleu for test set:   4%|▍         | 3/80 [00:33<14:13, 11.09s/it]Eval bleu for test set:   5%|▌         | 4/80 [00:45<14:25, 11.39s/it]Eval bleu for test set:   6%|▋         | 5/80 [00:56<14:08, 11.31s/it]Eval bleu for test set:   8%|▊         | 6/80 [01:07<13:44, 11.14s/it]Eval bleu for test set:   9%|▉         | 7/80 [01:18<13:28, 11.08s/it]Eval bleu for test set:  10%|█         | 8/80 [01:29<13:20, 11.12s/it]Eval bleu for test set:  11%|█▏        | 9/80 [01:40<13:05, 11.06s/it]Eval bleu for test set:  12%|█▎        | 10/80 [01:51<12:48, 10.97s/it]Eval bleu for test set:  14%|█▍        | 11/80 [02:01<12:35, 10.95s/it]Eval bleu for test set:  15%|█▌        | 12/80 [02:12<12:24, 10.95s/it]Eval bleu for test set:  16%|█▋        | 13/80 [02:23<12:11, 10.92s/it]Eval bleu for test set:  18%|█▊        | 14/80 [02:34<11:57, 10.88s/it]Eval bleu for test set:  19%|█▉        | 15/80 [02:45<11:49, 10.92s/it]Eval bleu for test set:  20%|██        | 16/80 [02:56<11:39, 10.93s/it]Eval bleu for test set:  21%|██▏       | 17/80 [03:07<11:26, 10.90s/it]Eval bleu for test set:  22%|██▎       | 18/80 [03:18<11:15, 10.90s/it]Eval bleu for test set:  24%|██▍       | 19/80 [03:29<11:04, 10.90s/it]Eval bleu for test set:  25%|██▌       | 20/80 [03:39<10:52, 10.87s/it]Eval bleu for test set:  26%|██▋       | 21/80 [03:50<10:44, 10.93s/it]Eval bleu for test set:  28%|██▊       | 22/80 [04:01<10:32, 10.90s/it]Eval bleu for test set:  29%|██▉       | 23/80 [04:12<10:19, 10.87s/it]Eval bleu for test set:  30%|███       | 24/80 [04:23<10:07, 10.85s/it]Eval bleu for test set:  31%|███▏      | 25/80 [04:34<09:58, 10.87s/it]Eval bleu for test set:  32%|███▎      | 26/80 [04:45<09:48, 10.90s/it]Eval bleu for test set:  34%|███▍      | 27/80 [04:56<09:48, 11.11s/it]Eval bleu for test set:  35%|███▌      | 28/80 [05:07<09:33, 11.03s/it]Eval bleu for test set:  36%|███▋      | 29/80 [05:18<09:19, 10.98s/it]Eval bleu for test set:  38%|███▊      | 30/80 [05:29<09:06, 10.93s/it]Eval bleu for test set:  39%|███▉      | 31/80 [05:40<08:57, 10.97s/it]Eval bleu for test set:  40%|████      | 32/80 [05:52<08:57, 11.20s/it]Eval bleu for test set:  41%|████▏     | 33/80 [06:03<08:43, 11.13s/it]Eval bleu for test set:  42%|████▎     | 34/80 [06:14<08:33, 11.16s/it]Eval bleu for test set:  44%|████▍     | 35/80 [06:25<08:20, 11.13s/it]Eval bleu for test set:  45%|████▌     | 36/80 [06:36<08:06, 11.06s/it]Eval bleu for test set:  46%|████▋     | 37/80 [06:47<07:56, 11.07s/it]Eval bleu for test set:  48%|████▊     | 38/80 [06:58<07:43, 11.03s/it]Eval bleu for test set:  49%|████▉     | 39/80 [07:09<07:30, 11.00s/it]Eval bleu for test set:  50%|█████     | 40/80 [07:20<07:17, 10.95s/it]Eval bleu for test set:  51%|█████▏    | 41/80 [07:30<07:05, 10.90s/it]Eval bleu for test set:  52%|█████▎    | 42/80 [07:41<06:53, 10.87s/it]Eval bleu for test set:  54%|█████▍    | 43/80 [07:52<06:45, 10.95s/it]Eval bleu for test set:  55%|█████▌    | 44/80 [08:03<06:32, 10.90s/it]Eval bleu for test set:  56%|█████▋    | 45/80 [08:14<06:20, 10.86s/it]Eval bleu for test set:  57%|█████▊    | 46/80 [08:25<06:10, 10.89s/it]Eval bleu for test set:  59%|█████▉    | 47/80 [08:36<05:58, 10.86s/it]Eval bleu for test set:  60%|██████    | 48/80 [08:47<05:48, 10.89s/it]Eval bleu for test set:  61%|██████▏   | 49/80 [08:58<05:40, 10.97s/it]Eval bleu for test set:  62%|██████▎   | 50/80 [09:09<05:30, 11.03s/it]Eval bleu for test set:  64%|██████▍   | 51/80 [09:20<05:19, 11.00s/it]Eval bleu for test set:  65%|██████▌   | 52/80 [09:31<05:09, 11.04s/it]Eval bleu for test set:  66%|██████▋   | 53/80 [09:42<04:56, 10.99s/it]Eval bleu for test set:  68%|██████▊   | 54/80 [09:53<04:45, 10.96s/it]Eval bleu for test set:  69%|██████▉   | 55/80 [10:04<04:34, 10.97s/it]Eval bleu for test set:  70%|███████   | 56/80 [10:15<04:23, 10.96s/it]Eval bleu for test set:  71%|███████▏  | 57/80 [10:26<04:12, 10.98s/it]Eval bleu for test set:  72%|███████▎  | 58/80 [10:37<04:00, 10.92s/it]Eval bleu for test set:  74%|███████▍  | 59/80 [10:48<03:50, 10.96s/it]Eval bleu for test set:  75%|███████▌  | 60/80 [11:00<03:44, 11.23s/it]Eval bleu for test set:  76%|███████▋  | 61/80 [11:11<03:32, 11.16s/it]Eval bleu for test set:  78%|███████▊  | 62/80 [11:22<03:20, 11.16s/it]Eval bleu for test set:  79%|███████▉  | 63/80 [11:33<03:09, 11.16s/it]Eval bleu for test set:  80%|████████  | 64/80 [11:44<02:57, 11.10s/it]Eval bleu for test set:  81%|████████▏ | 65/80 [11:55<02:46, 11.12s/it]Eval bleu for test set:  82%|████████▎ | 66/80 [12:06<02:34, 11.03s/it]Eval bleu for test set:  84%|████████▍ | 67/80 [12:17<02:23, 11.04s/it]Eval bleu for test set:  85%|████████▌ | 68/80 [12:28<02:12, 11.00s/it]Eval bleu for test set:  86%|████████▋ | 69/80 [12:39<02:00, 10.95s/it]Eval bleu for test set:  88%|████████▊ | 70/80 [12:49<01:49, 10.93s/it]Eval bleu for test set:  89%|████████▉ | 71/80 [13:00<01:38, 10.93s/it]Eval bleu for test set:  90%|█████████ | 72/80 [13:11<01:27, 10.88s/it]Eval bleu for test set:  91%|█████████▏| 73/80 [13:22<01:15, 10.85s/it]Eval bleu for test set:  92%|█████████▎| 74/80 [13:33<01:05, 10.84s/it]Eval bleu for test set:  94%|█████████▍| 75/80 [13:44<00:54, 10.83s/it]Eval bleu for test set:  95%|█████████▌| 76/80 [13:55<00:43, 10.86s/it]Eval bleu for test set:  96%|█████████▋| 77/80 [14:05<00:32, 10.83s/it]Eval bleu for test set:  98%|█████████▊| 78/80 [14:16<00:21, 10.81s/it]Eval bleu for test set:  99%|█████████▉| 79/80 [14:27<00:10, 10.81s/it]Eval bleu for test set: 100%|██████████| 80/80 [14:30<00:00,  8.65s/it]Eval bleu for test set: 100%|██████████| 80/80 [14:31<00:00, 10.89s/it]
11/13/2022 05:19:58 - INFO - __main__ -   ***** Eval results *****
11/13/2022 05:19:58 - INFO - __main__ -     bleu = 57.23
11/13/2022 05:19:58 - INFO - __main__ -     codebleu = 62.0174
11/13/2022 05:19:58 - INFO - __main__ -     em = 0.3745
11/13/2022 05:19:58 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typeinsert_try_catch + whether_refactoringafter_refactoring :
11/13/2022 05:19:58 - INFO - __main__ -   [best-bleu] bleu-4: 57.23, em: 0.3745, codebleu: 62.0174

11/13/2022 05:19:58 - INFO - __main__ -   Finish and take 5h1m
11/13/2022 05:19:58 - INFO - __main__ -     ***** Testing *****
11/13/2022 05:19:58 - INFO - __main__ -     Batch size = 64
11/13/2022 05:19:58 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 05:19:59 - INFO - __main__ -   test11111111111
11/13/2022 05:19:59 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 05:19:59 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/loop_exchange/before_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/loop_exchange/before_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 05:19:59 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 05:19:59 - INFO - utils -   Read 708 examples, avg src len: 75, avg trg len: 75, max src len: 123, max trg len: 118
11/13/2022 05:19:59 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/local_variable_renaming_20221113_022450/method_renaming_20221113_022903/method_renaming_20221113_025247/parameter_renaming_20221113_031624/parameter_renaming_20221113_033249/boolean_exchange_20221113_034941/boolean_exchange_20221113_035016/convert_switch_to_if_20221113_035051/convert_switch_to_if_20221113_035130/insert_log_statement_20221113_035210/insert_log_statement_20221113_041642/insert_try_catch_20221113_044103/insert_try_catch_20221113_050029/loop_exchange_20221113_051958/test_src_all.pt
11/13/2022 05:19:59 - INFO - utils -   加载前test666666666666666
ngram match: 0.5722904864530599, weighted ngram match: 0.6018911962458104, syntax_match: 0.7277082646324998, dataflow_match: 0.5788078154490368
  0%|          | 0/708 [00:00<?, ?it/s] 50%|█████     | 354/708 [00:00<00:00, 776.89it/s] 75%|███████▌  | 531/708 [00:00<00:00, 707.48it/s]100%|██████████| 708/708 [00:01<00:00, 671.74it/s]100%|██████████| 708/708 [00:01<00:00, 691.77it/s]
11/13/2022 05:20:00 - INFO - utils -   加载后test77777777777777
11/13/2022 05:20:00 - INFO - __main__ -   加载成功test2222222222
11/13/2022 05:20:00 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 05:20:00 - INFO - __main__ -     Num examples = 708
11/13/2022 05:20:00 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/12 [00:00<?, ?it/s]Eval bleu for test set:   8%|▊         | 1/12 [00:10<01:58, 10.78s/it]Eval bleu for test set:  17%|█▋        | 2/12 [00:21<01:45, 10.53s/it]Eval bleu for test set:  25%|██▌       | 3/12 [00:31<01:35, 10.56s/it]Eval bleu for test set:  33%|███▎      | 4/12 [00:42<01:24, 10.57s/it]Eval bleu for test set:  42%|████▏     | 5/12 [00:52<01:13, 10.55s/it]Eval bleu for test set:  50%|█████     | 6/12 [01:03<01:03, 10.56s/it]Eval bleu for test set:  58%|█████▊    | 7/12 [01:14<00:53, 10.66s/it]Eval bleu for test set:  67%|██████▋   | 8/12 [01:24<00:42, 10.64s/it]Eval bleu for test set:  75%|███████▌  | 9/12 [01:35<00:31, 10.62s/it]Eval bleu for test set:  83%|████████▎ | 10/12 [01:46<00:21, 10.61s/it]Eval bleu for test set:  92%|█████████▏| 11/12 [01:56<00:10, 10.57s/it]Eval bleu for test set: 100%|██████████| 12/12 [01:58<00:00,  7.92s/it]Eval bleu for test set: 100%|██████████| 12/12 [01:58<00:00,  9.87s/it]
11/13/2022 05:22:38 - INFO - __main__ -   ***** Eval results *****
11/13/2022 05:22:38 - INFO - __main__ -     bleu = 80.54
11/13/2022 05:22:38 - INFO - __main__ -     codebleu = 78.7332
11/13/2022 05:22:38 - INFO - __main__ -     em = 8.4746
11/13/2022 05:22:38 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typeloop_exchange + whether_refactoringbefore_refactoring :
11/13/2022 05:22:38 - INFO - __main__ -   [best-bleu] bleu-4: 80.54, em: 8.4746, codebleu: 78.7332

11/13/2022 05:22:38 - INFO - __main__ -   Finish and take 5h3m
11/13/2022 05:22:38 - INFO - __main__ -     ***** Testing *****
11/13/2022 05:22:38 - INFO - __main__ -     Batch size = 64
11/13/2022 05:22:38 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 05:22:38 - INFO - __main__ -   test11111111111
11/13/2022 05:22:38 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 05:22:38 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/loop_exchange/after_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/loop_exchange/after_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 05:22:38 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 05:22:38 - INFO - utils -   Read 708 examples, avg src len: 62, avg trg len: 62, max src len: 109, max trg len: 106
11/13/2022 05:22:38 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/local_variable_renaming_20221113_022450/method_renaming_20221113_022903/method_renaming_20221113_025247/parameter_renaming_20221113_031624/parameter_renaming_20221113_033249/boolean_exchange_20221113_034941/boolean_exchange_20221113_035016/convert_switch_to_if_20221113_035051/convert_switch_to_if_20221113_035130/insert_log_statement_20221113_035210/insert_log_statement_20221113_041642/insert_try_catch_20221113_044103/insert_try_catch_20221113_050029/loop_exchange_20221113_051958/loop_exchange_20221113_052238/test_src_all.pt
11/13/2022 05:22:38 - INFO - utils -   加载前test666666666666666
ngram match: 0.8053763819234584, weighted ngram match: 0.812657013139419, syntax_match: 0.8114883811321802, dataflow_match: 0.7198064850544261
  0%|          | 0/708 [00:00<?, ?it/s] 50%|█████     | 354/708 [00:00<00:00, 813.70it/s] 75%|███████▌  | 531/708 [00:00<00:00, 685.55it/s]100%|██████████| 708/708 [00:01<00:00, 659.16it/s]100%|██████████| 708/708 [00:01<00:00, 683.04it/s]
11/13/2022 05:22:39 - INFO - utils -   加载后test77777777777777
11/13/2022 05:22:39 - INFO - __main__ -   加载成功test2222222222
11/13/2022 05:22:39 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 05:22:39 - INFO - __main__ -     Num examples = 708
11/13/2022 05:22:39 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/12 [00:00<?, ?it/s]Eval bleu for test set:   8%|▊         | 1/12 [00:10<01:58, 10.81s/it]Eval bleu for test set:  17%|█▋        | 2/12 [00:21<01:47, 10.70s/it]Eval bleu for test set:  25%|██▌       | 3/12 [00:32<01:36, 10.75s/it]Eval bleu for test set:  33%|███▎      | 4/12 [00:42<01:25, 10.66s/it]Eval bleu for test set:  42%|████▏     | 5/12 [00:54<01:16, 10.87s/it]Eval bleu for test set:  50%|█████     | 6/12 [01:04<01:04, 10.67s/it]Eval bleu for test set:  58%|█████▊    | 7/12 [01:14<00:53, 10.61s/it]Eval bleu for test set:  67%|██████▋   | 8/12 [01:25<00:42, 10.53s/it]Eval bleu for test set:  75%|███████▌  | 9/12 [01:35<00:31, 10.52s/it]Eval bleu for test set:  83%|████████▎ | 10/12 [01:46<00:20, 10.48s/it]Eval bleu for test set:  92%|█████████▏| 11/12 [01:56<00:10, 10.48s/it]Eval bleu for test set: 100%|██████████| 12/12 [01:58<00:00,  7.84s/it]Eval bleu for test set: 100%|██████████| 12/12 [01:58<00:00,  9.87s/it]
11/13/2022 05:25:16 - INFO - __main__ -   ***** Eval results *****
11/13/2022 05:25:16 - INFO - __main__ -     bleu = 66.83
11/13/2022 05:25:16 - INFO - __main__ -     codebleu = 71.2493
11/13/2022 05:25:16 - INFO - __main__ -     em = 0.2825
11/13/2022 05:25:16 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typeloop_exchange + whether_refactoringafter_refactoring :
11/13/2022 05:25:16 - INFO - __main__ -   [best-bleu] bleu-4: 66.83, em: 0.2825, codebleu: 71.2493

11/13/2022 05:25:16 - INFO - __main__ -   Finish and take 5h6m
11/13/2022 05:25:16 - INFO - __main__ -     ***** Testing *****
11/13/2022 05:25:16 - INFO - __main__ -     Batch size = 64
11/13/2022 05:25:16 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 05:25:16 - INFO - __main__ -   test11111111111
11/13/2022 05:25:16 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 05:25:16 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/reorder_condition/before_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/reorder_condition/before_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 05:25:16 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 05:25:16 - INFO - utils -   Read 3578 examples, avg src len: 75, avg trg len: 74, max src len: 235, max trg len: 168
11/13/2022 05:25:16 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/local_variable_renaming_20221113_022450/method_renaming_20221113_022903/method_renaming_20221113_025247/parameter_renaming_20221113_031624/parameter_renaming_20221113_033249/boolean_exchange_20221113_034941/boolean_exchange_20221113_035016/convert_switch_to_if_20221113_035051/convert_switch_to_if_20221113_035130/insert_log_statement_20221113_035210/insert_log_statement_20221113_041642/insert_try_catch_20221113_044103/insert_try_catch_20221113_050029/loop_exchange_20221113_051958/loop_exchange_20221113_052238/reorder_condition_20221113_052516/test_src_all.pt
11/13/2022 05:25:16 - INFO - utils -   加载前test666666666666666
ngram match: 0.6682929715837337, weighted ngram match: 0.6752183548536883, syntax_match: 0.7922357242714271, dataflow_match: 0.7142258161126086
  0%|          | 0/3578 [00:00<?, ?it/s] 50%|█████     | 1790/3578 [00:01<00:01, 1057.34it/s] 75%|███████▌  | 2685/3578 [00:03<00:01, 772.18it/s] 100%|██████████| 3578/3578 [00:03<00:00, 1087.20it/s]
11/13/2022 05:25:23 - INFO - utils -   加载后test77777777777777
11/13/2022 05:25:23 - INFO - __main__ -   加载成功test2222222222
11/13/2022 05:25:23 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 05:25:23 - INFO - __main__ -     Num examples = 3578
11/13/2022 05:25:23 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/56 [00:00<?, ?it/s]Eval bleu for test set:   2%|▏         | 1/56 [00:10<10:00, 10.92s/it]Eval bleu for test set:   4%|▎         | 2/56 [00:21<09:42, 10.78s/it]Eval bleu for test set:   5%|▌         | 3/56 [00:32<09:24, 10.64s/it]Eval bleu for test set:   7%|▋         | 4/56 [00:42<09:15, 10.68s/it]Eval bleu for test set:   9%|▉         | 5/56 [00:53<09:04, 10.67s/it]Eval bleu for test set:  11%|█         | 6/56 [01:04<08:56, 10.73s/it]Eval bleu for test set:  12%|█▎        | 7/56 [01:14<08:43, 10.68s/it]Eval bleu for test set:  14%|█▍        | 8/56 [01:25<08:33, 10.69s/it]Eval bleu for test set:  16%|█▌        | 9/56 [01:36<08:21, 10.67s/it]Eval bleu for test set:  18%|█▊        | 10/56 [01:47<08:12, 10.71s/it]Eval bleu for test set:  20%|█▉        | 11/56 [01:57<08:01, 10.70s/it]Eval bleu for test set:  21%|██▏       | 12/56 [02:08<07:50, 10.70s/it]Eval bleu for test set:  23%|██▎       | 13/56 [02:19<07:39, 10.69s/it]Eval bleu for test set:  25%|██▌       | 14/56 [02:29<07:28, 10.69s/it]Eval bleu for test set:  27%|██▋       | 15/56 [02:40<07:18, 10.69s/it]Eval bleu for test set:  29%|██▊       | 16/56 [02:51<07:08, 10.72s/it]Eval bleu for test set:  30%|███       | 17/56 [03:02<06:59, 10.75s/it]Eval bleu for test set:  32%|███▏      | 18/56 [03:12<06:47, 10.74s/it]Eval bleu for test set:  34%|███▍      | 19/56 [03:23<06:37, 10.73s/it]Eval bleu for test set:  36%|███▌      | 20/56 [03:34<06:27, 10.77s/it]Eval bleu for test set:  38%|███▊      | 21/56 [03:45<06:16, 10.76s/it]Eval bleu for test set:  39%|███▉      | 22/56 [03:55<06:05, 10.74s/it]Eval bleu for test set:  41%|████      | 23/56 [04:06<05:54, 10.73s/it]Eval bleu for test set:  43%|████▎     | 24/56 [04:17<05:42, 10.70s/it]Eval bleu for test set:  45%|████▍     | 25/56 [04:27<05:31, 10.69s/it]Eval bleu for test set:  46%|████▋     | 26/56 [04:38<05:23, 10.80s/it]Eval bleu for test set:  48%|████▊     | 27/56 [04:49<05:12, 10.77s/it]Eval bleu for test set:  50%|█████     | 28/56 [05:00<05:05, 10.89s/it]Eval bleu for test set:  52%|█████▏    | 29/56 [05:11<04:51, 10.79s/it]Eval bleu for test set:  54%|█████▎    | 30/56 [05:21<04:39, 10.76s/it]Eval bleu for test set:  55%|█████▌    | 31/56 [05:32<04:28, 10.72s/it]Eval bleu for test set:  57%|█████▋    | 32/56 [05:43<04:18, 10.78s/it]Eval bleu for test set:  59%|█████▉    | 33/56 [05:54<04:08, 10.82s/it]Eval bleu for test set:  61%|██████    | 34/56 [06:05<03:56, 10.76s/it]Eval bleu for test set:  62%|██████▎   | 35/56 [06:15<03:46, 10.79s/it]Eval bleu for test set:  64%|██████▍   | 36/56 [06:26<03:35, 10.77s/it]Eval bleu for test set:  66%|██████▌   | 37/56 [06:37<03:24, 10.75s/it]Eval bleu for test set:  68%|██████▊   | 38/56 [06:48<03:13, 10.77s/it]Eval bleu for test set:  70%|██████▉   | 39/56 [06:58<03:03, 10.77s/it]Eval bleu for test set:  71%|███████▏  | 40/56 [07:09<02:52, 10.76s/it]Eval bleu for test set:  73%|███████▎  | 41/56 [07:20<02:41, 10.75s/it]Eval bleu for test set:  75%|███████▌  | 42/56 [07:31<02:30, 10.74s/it]Eval bleu for test set:  77%|███████▋  | 43/56 [07:41<02:20, 10.79s/it]Eval bleu for test set:  79%|███████▊  | 44/56 [07:53<02:10, 10.88s/it]Eval bleu for test set:  80%|████████  | 45/56 [08:03<01:59, 10.86s/it]Eval bleu for test set:  82%|████████▏ | 46/56 [08:14<01:49, 10.92s/it]Eval bleu for test set:  84%|████████▍ | 47/56 [08:25<01:37, 10.87s/it]Eval bleu for test set:  86%|████████▌ | 48/56 [08:36<01:26, 10.81s/it]Eval bleu for test set:  88%|████████▊ | 49/56 [08:47<01:15, 10.78s/it]Eval bleu for test set:  89%|████████▉ | 50/56 [08:57<01:04, 10.77s/it]Eval bleu for test set:  91%|█████████ | 51/56 [09:08<00:53, 10.79s/it]Eval bleu for test set:  93%|█████████▎| 52/56 [09:19<00:43, 10.82s/it]Eval bleu for test set:  95%|█████████▍| 53/56 [09:30<00:32, 10.82s/it]Eval bleu for test set:  96%|█████████▋| 54/56 [09:41<00:21, 10.78s/it]Eval bleu for test set:  98%|█████████▊| 55/56 [09:51<00:10, 10.76s/it]Eval bleu for test set: 100%|██████████| 56/56 [10:01<00:00, 10.46s/it]Eval bleu for test set: 100%|██████████| 56/56 [10:01<00:00, 10.74s/it]
11/13/2022 05:38:43 - INFO - __main__ -   ***** Eval results *****
11/13/2022 05:38:43 - INFO - __main__ -     bleu = 73.64
11/13/2022 05:38:43 - INFO - __main__ -     codebleu = 73.6083
11/13/2022 05:38:43 - INFO - __main__ -     em = 5.953
11/13/2022 05:38:43 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typereorder_condition + whether_refactoringbefore_refactoring :
11/13/2022 05:38:43 - INFO - __main__ -   [best-bleu] bleu-4: 73.64, em: 5.9530, codebleu: 73.6083

11/13/2022 05:38:43 - INFO - __main__ -   Finish and take 5h19m
11/13/2022 05:38:43 - INFO - __main__ -     ***** Testing *****
11/13/2022 05:38:43 - INFO - __main__ -     Batch size = 64
11/13/2022 05:38:43 - INFO - __main__ -   Reload model from /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 05:38:43 - INFO - __main__ -   test11111111111
11/13/2022 05:38:43 - INFO - __main__ -   test by self model path: /home/y_shi202/related-project/CodeT5/sh/fine_tuned_models_final/codet5-small/medium/pytorch_model.bin
11/13/2022 05:38:43 - INFO - __main__ -   test by self test filename: /home/y_shi202/related-project/CodeT5/data/refactoring/reorder_condition/after_refactoring/medium/test.buggy-fixed.buggy,/home/y_shi202/related-project/CodeT5/data/refactoring/reorder_condition/after_refactoring/medium/test.buggy-fixed.fixed
11/13/2022 05:38:43 - INFO - __main__ -   test by self output: saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50
11/13/2022 05:38:43 - INFO - utils -   Read 3578 examples, avg src len: 62, avg trg len: 62, max src len: 235, max trg len: 168
11/13/2022 05:38:43 - INFO - utils -   Create cache data into saved_models/refine/small/codet5_small_all_lr5_bs64_src130_trg120_pat5_e50/cache_data/local_variable_renaming_20221113_001906/local_variable_renaming_20221113_002000/method_renaming_20221113_002048/method_renaming_20221113_003807/parameter_renaming_20221113_005528/parameter_renaming_20221113_010603/boolean_exchange_20221113_011647/boolean_exchange_20221113_011654/convert_switch_to_if_20221113_011701/convert_switch_to_if_20221113_011711/insert_log_statement_20221113_011721/insert_log_statement_20221113_013428/insert_try_catch_20221113_015149/insert_try_catch_20221113_020216/loop_exchange_20221113_021318/loop_exchange_20221113_021331/reorder_condition_20221113_021343/reorder_condition_20221113_021716/local_variable_renaming_20221113_022039/local_variable_renaming_20221113_022450/method_renaming_20221113_022903/method_renaming_20221113_025247/parameter_renaming_20221113_031624/parameter_renaming_20221113_033249/boolean_exchange_20221113_034941/boolean_exchange_20221113_035016/convert_switch_to_if_20221113_035051/convert_switch_to_if_20221113_035130/insert_log_statement_20221113_035210/insert_log_statement_20221113_041642/insert_try_catch_20221113_044103/insert_try_catch_20221113_050029/loop_exchange_20221113_051958/loop_exchange_20221113_052238/reorder_condition_20221113_052516/reorder_condition_20221113_053843/test_src_all.pt
11/13/2022 05:38:43 - INFO - utils -   加载前test666666666666666
ngram match: 0.736440470046714, weighted ngram match: 0.7518912245617474, syntax_match: 0.789860273585054, dataflow_match: 0.6661382695847822
  0%|          | 0/3578 [00:00<?, ?it/s] 50%|█████     | 1790/3578 [00:01<00:01, 1089.67it/s] 75%|███████▌  | 2685/3578 [00:03<00:01, 799.18it/s] 100%|██████████| 3578/3578 [00:03<00:00, 1124.52it/s]
11/13/2022 05:38:49 - INFO - utils -   加载后test77777777777777
11/13/2022 05:38:49 - INFO - __main__ -   加载成功test2222222222
11/13/2022 05:38:49 - INFO - __main__ -     ***** Running bleu evaluation on test data*****
11/13/2022 05:38:49 - INFO - __main__ -     Num examples = 3578
11/13/2022 05:38:49 - INFO - __main__ -     Batch size = 64
Eval bleu for test set:   0%|          | 0/56 [00:00<?, ?it/s]Eval bleu for test set:   2%|▏         | 1/56 [00:11<10:05, 11.00s/it]Eval bleu for test set:   4%|▎         | 2/56 [00:21<09:44, 10.83s/it]Eval bleu for test set:   5%|▌         | 3/56 [00:32<09:24, 10.64s/it]Eval bleu for test set:   7%|▋         | 4/56 [00:42<09:17, 10.73s/it]Eval bleu for test set:   9%|▉         | 5/56 [00:53<09:02, 10.64s/it]Eval bleu for test set:  11%|█         | 6/56 [01:04<08:51, 10.63s/it]Eval bleu for test set:  12%|█▎        | 7/56 [01:14<08:39, 10.59s/it]Eval bleu for test set:  14%|█▍        | 8/56 [01:25<08:31, 10.66s/it]Eval bleu for test set:  16%|█▌        | 9/56 [01:35<08:19, 10.63s/it]Eval bleu for test set:  18%|█▊        | 10/56 [01:46<08:11, 10.69s/it]Eval bleu for test set:  20%|█▉        | 11/56 [01:57<07:59, 10.65s/it]Eval bleu for test set:  21%|██▏       | 12/56 [02:07<07:47, 10.62s/it]Eval bleu for test set:  23%|██▎       | 13/56 [02:18<07:37, 10.64s/it]Eval bleu for test set:  25%|██▌       | 14/56 [02:29<07:26, 10.63s/it]Eval bleu for test set:  27%|██▋       | 15/56 [02:40<07:19, 10.71s/it]Eval bleu for test set:  29%|██▊       | 16/56 [02:50<07:09, 10.73s/it]Eval bleu for test set:  30%|███       | 17/56 [03:01<06:57, 10.70s/it]Eval bleu for test set:  32%|███▏      | 18/56 [03:12<06:48, 10.76s/it]Eval bleu for test set:  34%|███▍      | 19/56 [03:23<06:39, 10.79s/it]Eval bleu for test set:  36%|███▌      | 20/56 [03:34<06:30, 10.86s/it]Eval bleu for test set:  38%|███▊      | 21/56 [03:44<06:17, 10.79s/it]Eval bleu for test set:  39%|███▉      | 22/56 [03:55<06:05, 10.75s/it]Eval bleu for test set:  41%|████      | 23/56 [04:06<05:56, 10.81s/it]Eval bleu for test set:  43%|████▎     | 24/56 [04:17<05:45, 10.79s/it]Eval bleu for test set:  45%|████▍     | 25/56 [04:27<05:33, 10.74s/it]Eval bleu for test set:  46%|████▋     | 26/56 [04:38<05:21, 10.73s/it]Eval bleu for test set:  48%|████▊     | 27/56 [04:49<05:10, 10.72s/it]Eval bleu for test set:  50%|█████     | 28/56 [05:00<05:01, 10.77s/it]Eval bleu for test set:  52%|█████▏    | 29/56 [05:10<04:50, 10.77s/it]Eval bleu for test set:  54%|█████▎    | 30/56 [05:21<04:39, 10.74s/it]Eval bleu for test set:  55%|█████▌    | 31/56 [05:32<04:27, 10.71s/it]Eval bleu for test set:  57%|█████▋    | 32/56 [05:43<04:19, 10.81s/it]Eval bleu for test set:  59%|█████▉    | 33/56 [05:54<04:08, 10.79s/it]Eval bleu for test set:  61%|██████    | 34/56 [06:04<03:56, 10.74s/it]Eval bleu for test set:  62%|██████▎   | 35/56 [06:15<03:46, 10.78s/it]Eval bleu for test set:  64%|██████▍   | 36/56 [06:26<03:35, 10.80s/it]Eval bleu for test set:  66%|██████▌   | 37/56 [06:37<03:25, 10.84s/it]Eval bleu for test set:  68%|██████▊   | 38/56 [06:47<03:14, 10.79s/it]Eval bleu for test set:  70%|██████▉   | 39/56 [06:58<03:02, 10.74s/it]Eval bleu for test set:  71%|███████▏  | 40/56 [07:09<02:52, 10.81s/it]Eval bleu for test set:  73%|███████▎  | 41/56 [07:20<02:42, 10.84s/it]Eval bleu for test set:  75%|███████▌  | 42/56 [07:31<02:30, 10.76s/it]Eval bleu for test set:  77%|███████▋  | 43/56 [07:41<02:19, 10.76s/it]Eval bleu for test set:  79%|███████▊  | 44/56 [07:52<02:09, 10.78s/it]Eval bleu for test set:  80%|████████  | 45/56 [08:03<01:58, 10.75s/it]Eval bleu for test set:  82%|████████▏ | 46/56 [08:13<01:46, 10.67s/it]Eval bleu for test set:  84%|████████▍ | 47/56 [08:24<01:35, 10.64s/it]Eval bleu for test set:  86%|████████▌ | 48/56 [08:35<01:25, 10.74s/it]Eval bleu for test set:  88%|████████▊ | 49/56 [08:45<01:14, 10.67s/it]Eval bleu for test set:  89%|████████▉ | 50/56 [08:56<01:04, 10.68s/it]Eval bleu for test set:  91%|█████████ | 51/56 [09:07<00:54, 10.89s/it]Eval bleu for test set:  93%|█████████▎| 52/56 [09:20<00:45, 11.29s/it]Eval bleu for test set:  95%|█████████▍| 53/56 [09:32<00:35, 11.70s/it]Eval bleu for test set:  96%|█████████▋| 54/56 [09:45<00:23, 11.91s/it]Eval bleu for test set:  98%|█████████▊| 55/56 [09:57<00:12, 12.06s/it]Eval bleu for test set: 100%|██████████| 56/56 [10:08<00:00, 11.58s/it]Eval bleu for test set: 100%|██████████| 56/56 [10:08<00:00, 10.86s/it]
11/13/2022 05:52:17 - INFO - __main__ -   ***** Eval results *****
11/13/2022 05:52:17 - INFO - __main__ -     bleu = 66.66
11/13/2022 05:52:17 - INFO - __main__ -     codebleu = 69.6248
11/13/2022 05:52:17 - INFO - __main__ -     em = 0.6428
11/13/2022 05:52:17 - INFO - __main__ -   model: codet5-small dataset: medium refactoring_typereorder_condition + whether_refactoringafter_refactoring :
11/13/2022 05:52:17 - INFO - __main__ -   [best-bleu] bleu-4: 66.66, em: 0.6428, codebleu: 69.6248

11/13/2022 05:52:17 - INFO - __main__ -   Finish and take 5h33m
ngram match: 0.6665514033760048, weighted ngram match: 0.6775677140414731, syntax_match: 0.7787936102102511, dataflow_match: 0.6620803311359804
============================Start Running==========================
bash exp_with_args.sh refine small codet5_small 0 -1 64 5 130 120 5 50 1000 saved_models tensorboard results/refine_codet5_small.txt

######## end ################
